{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/stores/cartStore.ts"],"sourcesContent":["import { create } from 'zustand'\r\nimport { persist } from 'zustand/middleware'\r\nimport { Product } from '@/hooks/products/useProductApi'\r\n\r\nexport interface CartItem {\r\n  product: Product\r\n  quantity: number\r\n  id: string\r\n}\r\n\r\ninterface CartState {\r\n  cart: CartItem[]\r\n  lastAddedItemId: string | null\r\n  scanError: string | null\r\n  isScanning: boolean\r\n  \r\n  // Actions\r\n  addProductToCart: (product: Product) => string\r\n  updateCartItemQuantity: (id: string, quantity: number) => void\r\n  updateCartItemPrice: (id: string, price: number) => void\r\n  deleteCartItem: (id: string) => void\r\n  clearCart: () => void\r\n  setScanError: (error: string | null) => void\r\n  setIsScanning: (scanning: boolean) => void\r\n  setLastAddedItemId: (id: string | null) => void\r\n}\r\n\r\nconst genId = () =>\r\n  typeof crypto !== \"undefined\" && typeof (crypto as any).randomUUID === \"function\"\r\n    ? (crypto as any).randomUUID()\r\n    : Date.now().toString()\r\n\r\nconst productEqual = (a: Product, b: Product) => {\r\n  if (a?.id && b?.id) return a.id === b.id\r\n  return Boolean(a?.barcode && b?.barcode && a.barcode === b.barcode)\r\n}\r\n\r\n// Generate a unique tab ID for per-tab cart isolation\r\nconst getTabId = (): string => {\r\n  // Use sessionStorage to maintain tab ID across page reloads\r\n  if (typeof window === 'undefined') return 'default-tab'\r\n  \r\n  let tabId = sessionStorage.getItem('pos-tab-id')\r\n  if (!tabId) {\r\n    tabId = `tab-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\r\n    sessionStorage.setItem('pos-tab-id', tabId)\r\n  }\r\n  return tabId\r\n}\r\n\r\nexport const useCartStore = create<CartState>()(\r\n  persist(\r\n    (set, get) => ({\r\n      cart: [],\r\n      lastAddedItemId: null,\r\n      scanError: null,\r\n      isScanning: false,\r\n\r\n      addProductToCart: (product: Product) => {\r\n        const { cart } = get()\r\n        const existing = cart.find((item) => productEqual(item.product, product))\r\n        \r\n        if (existing) {\r\n          const updatedCart = cart.map((item) =>\r\n            productEqual(item.product, product) \r\n              ? { ...item, quantity: item.quantity + 1 } \r\n              : item\r\n          )\r\n          set({ \r\n            cart: updatedCart, \r\n            lastAddedItemId: existing.id \r\n          })\r\n          return existing.id\r\n        } else {\r\n          const cartItem: CartItem = { \r\n            product, \r\n            quantity: 1, \r\n            id: genId() \r\n          }\r\n          set({ \r\n            cart: [cartItem, ...cart], \r\n            lastAddedItemId: cartItem.id \r\n          })\r\n          return cartItem.id\r\n        }\r\n      },\r\n\r\n      updateCartItemQuantity: (id: string, quantity: number) => {\r\n        set((state) => ({\r\n          cart: state.cart.map((item) =>\r\n            item.id === id \r\n              ? { ...item, quantity: Math.max(0, Number(quantity) || 0) } \r\n              : item\r\n          )\r\n        }))\r\n      },\r\n\r\n      updateCartItemPrice: (id: string, price: number) => {\r\n        set((state) => ({\r\n          cart: state.cart.map((item) =>\r\n            item.id === id\r\n              ? { \r\n                  ...item, \r\n                  product: { \r\n                    ...item.product, \r\n                    price: Number(isFinite(Number(price)) ? price : 0) \r\n                  } \r\n                }\r\n              : item\r\n          )\r\n        }))\r\n      },\r\n\r\n      deleteCartItem: (id: string) => {\r\n        set((state) => ({\r\n          cart: state.cart.filter((item) => item.id !== id),\r\n          lastAddedItemId: state.lastAddedItemId === id ? null : state.lastAddedItemId\r\n        }))\r\n      },\r\n\r\n      clearCart: () => {\r\n        set({ \r\n          cart: [], \r\n          lastAddedItemId: null \r\n        })\r\n      },\r\n\r\n      setScanError: (error: string | null) => {\r\n        set({ scanError: error })\r\n      },\r\n\r\n      setIsScanning: (scanning: boolean) => {\r\n        set({ isScanning: scanning })\r\n      },\r\n\r\n      setLastAddedItemId: (id: string | null) => {\r\n        set({ lastAddedItemId: id })\r\n      }\r\n    }),\r\n    {\r\n      name: `pos-cart-storage-${getTabId()}`, // unique name per tab for localStorage key\r\n      partialize: (state) => ({ \r\n        cart: state.cart, \r\n        lastAddedItemId: state.lastAddedItemId \r\n      }), // only persist cart and lastAddedItemId\r\n    }\r\n  )\r\n)\r\n\r\n// Computed values\r\nexport const useCartTotal = () => {\r\n  const cart = useCartStore((state) => state.cart)\r\n  return cart.reduce((total, item) => total + Number(item.product.price || 0) * item.quantity, 0)\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/contexts/cart-context.tsx"],"sourcesContent":["import React, {\r\n  createContext,\r\n  useContext,\r\n  useMemo,\r\n  ReactNode,\r\n  useCallback,\r\n  useRef,\r\n  useEffect,\r\n} from \"react\";\r\nimport { productApi, Product } from \"@/hooks/products/useProductApi\";\r\nimport { useProductModal } from \"@/contexts/productRegister-context\";\r\nimport { useCartStore, useCartTotal, CartItem } from \"@/stores/cartStore\";\r\n\r\ninterface CartContextType {\r\n  cart: CartItem[];\r\n  cartTotal: number;\r\n  scanError: string | null;\r\n  isScanning: boolean;\r\n  lastAddedItemId: string | null;\r\n  scanAndAddToCart: (barcode: string, preValidatedProduct?: Product | null) => Promise<void>;\r\n  addProductToCart: (product: Product) => string;\r\n  updateCartItemQuantity: (id: string, quantity: number) => void;\r\n  updateCartItemPrice: (id: string, price: number) => void;\r\n  deleteCartItem: (id: string) => void;\r\n  clearCart: () => void;\r\n}\r\n\r\nconst CartContext = createContext<CartContextType | undefined>(undefined);\r\n\r\nconst productEqual = (a: Product, b: Product) => {\r\n  if (a?.id && b?.id) return a.id === b.id;\r\n  return Boolean(a?.barcode && b?.barcode && a.barcode === b.barcode);\r\n};\r\n\r\nexport const CartProvider = ({ children }: { children: ReactNode }) => {\r\n  // Use Zustand store\r\n  const {\r\n    cart,\r\n    lastAddedItemId,\r\n    scanError,\r\n    isScanning,\r\n    addProductToCart: storeAddProductToCart,\r\n    updateCartItemQuantity: storeUpdateCartItemQuantity,\r\n    updateCartItemPrice: storeUpdateCartItemPrice,\r\n    deleteCartItem: storeDeleteCartItem,\r\n    clearCart: storeClearCart,\r\n    setScanError,\r\n    setIsScanning,\r\n    setLastAddedItemId,\r\n  } = useCartStore();\r\n\r\n  const cartTotal = useCartTotal();\r\n\r\n  const [pendingScans, setPendingScans] = React.useState<Set<string>>(new Set());\r\n  const lastScanTimeRef = useRef<Map<string, number>>(new Map());\r\n\r\n  const { setBarcode: setContextBarcode, openModal, setOpen: setProductModalOpen } =\r\n    useProductModal();\r\n\r\n  const clearCart = useCallback(() => {\r\n    storeClearCart();\r\n    lastScanTimeRef.current = new Map();\r\n  }, [storeClearCart]);\r\n\r\n  const deleteCartItem = useCallback((id: string) => {\r\n    let nextSelectedId: string | null = null;\r\n    if (cart.length > 0) {\r\n      const idx = cart.findIndex((item) => item.id === id);\r\n      if (cart.length > 1) {\r\n        nextSelectedId = idx > 0 ? cart[idx - 1].id : cart[1]?.id ?? null;\r\n      }\r\n    }\r\n\r\n    storeDeleteCartItem(id);\r\n\r\n    try {\r\n      window.dispatchEvent(\r\n        new CustomEvent(\"cart:item-deleted\", {\r\n          detail: { deletedId: id, nextSelectedId },\r\n        })\r\n      );\r\n    } catch { /* ignore */ }\r\n  }, [cart, storeDeleteCartItem]);\r\n\r\n  const updateCartItemQuantity = useCallback((id: string, quantity: number) => {\r\n    storeUpdateCartItemQuantity(id, quantity);\r\n  }, [storeUpdateCartItemQuantity]);\r\n\r\n  const updateCartItemPrice = useCallback((id: string, price: number) => {\r\n    storeUpdateCartItemPrice(id, price);\r\n  }, [storeUpdateCartItemPrice]);\r\n\r\n  const addOrIncrement = useCallback((product: Product): string => {\r\n    // ✅ Simple and clean - let the store handle everything\r\n    return storeAddProductToCart(product);\r\n  }, [storeAddProductToCart]);\r\n\r\n  const addProductToCart = useCallback((product: Product): string => {\r\n    return addOrIncrement(product);\r\n  }, [addOrIncrement]);\r\n\r\n  const scanAndAddToCart = useCallback(\r\n    async (barcode: string, preValidatedProduct?: Product | null): Promise<void> => {\r\n      if (!barcode) return;\r\n\r\n      const cleanedBarcode = String(barcode).replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \"\").trim();\r\n      if (!cleanedBarcode) {\r\n        setScanError(\"Invalid barcode\");\r\n        return;\r\n      }\r\n      if (pendingScans.has(cleanedBarcode)) return;\r\n\r\n      try {\r\n        setIsScanning(true);\r\n        setScanError(null);\r\n        setPendingScans((prev) => new Set([...prev, cleanedBarcode]));\r\n\r\n        let product: Product | null = preValidatedProduct ?? null;\r\n        if (!product) {\r\n          try {\r\n            product = await productApi.getByBarcode(cleanedBarcode);\r\n          } catch {\r\n            product = null;\r\n          }\r\n        }\r\n\r\n        if (product) {\r\n          addOrIncrement(product);\r\n          setScanError(null);\r\n        } else {\r\n          // ✅ FIXED: Don't add placeholder or open modal directly\r\n          // Instead, dispatch an event to trigger the confirmation dialog\r\n          try {\r\n            window.dispatchEvent(new CustomEvent(\"unregistered-barcode\", {\r\n              detail: { barcode: cleanedBarcode }\r\n            }));\r\n          } catch { }\r\n          setScanError(`Product not found: ${cleanedBarcode}`);\r\n        }\r\n      } catch (error) {\r\n        setScanError(error instanceof Error ? error.message : \"Error scanning barcode\");\r\n        console.warn(\"[scanAndAddToCart] Error:\", error);\r\n      } finally {\r\n        setPendingScans((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(cleanedBarcode);\r\n          return next;\r\n        });\r\n        setIsScanning(false);\r\n      }\r\n    },\r\n    [pendingScans, addOrIncrement, setScanError, setIsScanning]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const onProductAdded = (e: Event) => {\r\n      const detail = (e as CustomEvent)?.detail;\r\n      if (!detail) return;\r\n\r\n      const addedProduct: Product | undefined = detail.product;\r\n      const barcode: string | undefined = detail.barcode;\r\n\r\n      if (addedProduct) {\r\n        addOrIncrement(addedProduct);\r\n      } else if (barcode) {\r\n        (async () => {\r\n          try {\r\n            const product = await productApi.getByBarcode(barcode);\r\n            if (product) addOrIncrement(product);\r\n          } catch { }\r\n        })();\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"product:added\", onProductAdded as EventListener);\r\n    return () => window.removeEventListener(\"product:added\", onProductAdded as EventListener);\r\n  }, [addOrIncrement]);\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      cart,\r\n      cartTotal,\r\n      scanError,\r\n      isScanning,\r\n      lastAddedItemId,\r\n      scanAndAddToCart,\r\n      addProductToCart,\r\n      updateCartItemQuantity,\r\n      updateCartItemPrice,\r\n      deleteCartItem,\r\n      clearCart,\r\n    }),\r\n    [\r\n      cart,\r\n      cartTotal,\r\n      scanError,\r\n      isScanning,\r\n      lastAddedItemId,\r\n      scanAndAddToCart,\r\n      addProductToCart,\r\n      updateCartItemQuantity,\r\n      updateCartItemPrice,\r\n      deleteCartItem,\r\n      clearCart,\r\n    ]\r\n  );\r\n\r\n  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;\r\n};\r\n\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) throw new Error(\"useCart must be used within a CartProvider\");\r\n  return context;\r\n};\r\n\r\n// Keyboard shortcuts for cart actions (unchanged)\r\nexport function useCartKeyboard(selectedRowId: string | null) {\r\n  useEffect(() => {\r\n    const dispatch = (name: string, detail?: any) =>\r\n      window.dispatchEvent(new CustomEvent(name, { detail }));\r\n\r\n    const handler = (e: KeyboardEvent) => {\r\n      const active = document.activeElement as HTMLElement | null;\r\n      const isSearchInput = active?.getAttribute?.(\"data-product-search\") === \"true\";\r\n      const isSearchOpen = active?.getAttribute?.(\"data-search-open\") === \"true\";\r\n\r\n      const key = e.key;\r\n\r\n      if (isSearchInput && isSearchOpen) return;\r\n\r\n      if (key === \"ArrowDown\") {\r\n        e.preventDefault();\r\n        dispatch(\"cart:select-next\", { id: selectedRowId });\r\n      } else if (key === \"ArrowUp\") {\r\n        e.preventDefault();\r\n        dispatch(\"cart:select-prev\", { id: selectedRowId });\r\n      } else if (key === \"+\" || key === \"=\") {\r\n        e.preventDefault();\r\n        dispatch(\"cart:increment-qty\", { id: selectedRowId });\r\n      } else if (key === \"-\") {\r\n        e.preventDefault();\r\n        dispatch(\"cart:decrement-qty\", { id: selectedRowId });\r\n      } else if (e.ctrlKey && e.shiftKey && key.toLowerCase() === \"p\") {\r\n        e.preventDefault();\r\n        const ps = document.querySelector<HTMLInputElement>('[data-product-search=\"true\"]');\r\n        ps?.blur();\r\n        const id =\r\n          selectedRowId ||\r\n          document.querySelector<HTMLElement>('[data-cart-selected=\"true\"]')?.getAttribute(\"data-cart-id\") ||\r\n          null;\r\n        if (id) dispatch(\"cart:edit-price\", { id });\r\n      } else if (key === \"Enter\" && e.ctrlKey) {\r\n        e.preventDefault();\r\n        dispatch(\"cart:focus-cash\", { id: selectedRowId });\r\n      } else if (e.ctrlKey && key.toLowerCase() === \"q\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const id =\r\n          selectedRowId ||\r\n          document.querySelector<HTMLElement>('[data-cart-selected=\"true\"]')?.getAttribute(\"data-cart-id\") ||\r\n          null;\r\n        if (id) {\r\n          // Focus the quantity input for the selected item\r\n          const qtyInput = document.querySelector<HTMLInputElement>(`[data-cart-qty-input=\"${id}\"]`);\r\n          if (qtyInput) {\r\n            // Use requestAnimationFrame to ensure focus happens after any competing handlers\r\n            requestAnimationFrame(() => {\r\n              qtyInput.focus();\r\n              qtyInput.select();\r\n            });\r\n          }\r\n        }\r\n      } else if (e.ctrlKey && key.toLowerCase() === \"d\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const id =\r\n          selectedRowId ||\r\n          document.querySelector<HTMLElement>('[data-cart-selected=\"true\"]')?.getAttribute(\"data-cart-id\") ||\r\n          null;\r\n        if (id) dispatch(\"cart:delete-item\", { id });\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"keydown\", handler, { capture: true });\r\n    return () => window.removeEventListener(\"keydown\", handler, { capture: true });\r\n  }, [selectedRowId]);\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 480, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/POS/components/rightColumn/index.tsx"],"sourcesContent":["const { spawn } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\nconst { createCanvas, loadImage } = require('canvas');\n\n// === Utilities for text alignment ===\nfunction padLeft(s, len) {\n  const str = String(s ?? '');\n  return str.length >= len ? str.slice(0, len) : ' '.repeat(len - str.length) + str;\n}\nfunction padRight(s, len) {\n  const str = String(s ?? '');\n  return str.length >= len ? str.slice(0, len) : str + ' '.repeat(len - str.length);\n}\n\n// === Convert logo into ESC/POS raster ===\nasync function loadLogoAsRaster(filePath, targetWidth = 144) {\n  if (!fs.existsSync(filePath)) return Buffer.alloc(0);\n  const img = await loadImage(filePath);\n  const width = targetWidth - (targetWidth % 8);\n  const scale = width / img.width;\n  const height = Math.max(1, Math.floor(img.height * scale));\n  const canvas = createCanvas(width, height);\n  const ctx = canvas.getContext('2d');\n  ctx.drawImage(img, 0, 0, width, height);\n  const { data } = ctx.getImageData(0, 0, width, height);\n\n  const bytes = [];\n  bytes.push(0x1D, 0x76, 0x30, 0x00, (width >> 3) & 0xFF, (width >> 3) >> 8, height & 0xFF, (height >> 8) & 0xFF);\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x += 8) {\n      let byte = 0;\n      for (let b = 0; b < 8; b++) {\n        const i = ((y * width) + (x + b)) * 4;\n        const r = data[i], g = data[i + 1], bl = data[i + 2], a = data[i + 3];\n        const luma = 0.2126 * r + 0.7152 * g + 0.0722 * bl;\n        const isBlack = (a > 32) && (luma < 160);\n        if (isBlack) byte |= (0x80 >> b);\n      }\n      bytes.push(byte);\n    }\n  }\n  return Buffer.from(bytes);\n}\n\n// === Build the receipt text ===\nfunction buildEscposReceipt(data) {\n  const dateStr = new Date().toLocaleDateString('en-PH', { year: 'numeric', month: 'long', day: '2-digit' });\n  const LINE_WIDTH = 48;\n\n  let r = '';\n  r += '\\x1B\\x40'; // init\n  r += '\\x1B\\x74\\x00'; // encoding\n  r += '\\x1B\\x61\\x01'; // center\n\n  // Store header\n  if (data.store?.name) {\n    r += '\\x1B\\x21\\x30' + data.store.name + '\\x1B\\x21\\x00\\n'; // Double height bold\n  }\n  if (data.store?.address1) r += data.store.address1 + '\\n';\n  if (data.store?.address2) r += data.store.address2 + '\\n';\n  r += '\\n';\n\n  // Info section\n  r += '\\x1B\\x61\\x00'; // left align\n  r += padRight('Customer:', 12) + (data.customer?.name || '') + '\\n';\n  r += padRight('Date:', 12) + dateStr + '\\n';\n  r += ''.padEnd(LINE_WIDTH, '-') + '\\n';\n\n  // Items header\n  r += padRight('Description', 24) + padLeft('Qty', 6) + padLeft('Amount', 12) + '\\n';\n  r += ''.padEnd(LINE_WIDTH, '-') + '\\n';\n\n  // Items\n  const items = Array.isArray(data.items) ? data.items : [];\n  for (const it of items) {\n    const desc = String(it.desc || '').slice(0, 24);\n    const qty = padLeft(it.qty || 0, 6);\n    const amount = padLeft((it.amount || 0).toFixed(2), 12);\n    r += padRight(desc, 24) + qty + amount + '\\n';\n  }\n\n  r += ''.padEnd(LINE_WIDTH, '-') + '\\n';\n\n  // Totals\n  r += padLeft('Total:', 36) + '\\x1B\\x45\\x01' + padLeft((data.cartTotal || 0).toFixed(2), 12) + '\\x1B\\x45\\x00\\n';\n  r += '\\n';\n  r += padLeft('Amount:', 36) + padLeft((data.amount || 0).toFixed(2), 12) + '\\n';\n  r += padLeft('Change:', 36) + padLeft((data.change || 0).toFixed(2), 12) + '\\n';\n  r += ''.padEnd(LINE_WIDTH, '-') + '\\n\\n';\n\n  // Footer\n  r += '\\x1B\\x61\\x01';\n  r += '\\x1B\\x45\\x01CUSTOMER COPY — NOT AN OFFICIAL RECEIPT\\x1B\\x45\\x00\\n\\n';\n  r += 'THANK YOU — GATANG KA MANEN!\\n';\n  r += '\\x1B\\x61\\x00\\n\\n';\n\n  r += '\\x1B\\x64\\x07'; // feed\n  r += '\\x1D\\x56\\x00'; // cut\n  return r;\n}\n\n// === Raw spooler printing (Windows) ===\nasync function printViaRawSpooler(bytes, printerName) {\n  const tmp = path.join(process.cwd(), `receipt_${Date.now()}.bin`);\n  fs.writeFileSync(tmp, bytes);\n\n  const safePath = tmp.replace(/'/g, \"''\");\n  const printerExpr = printerName && String(printerName).trim().length\n    ? `'${String(printerName).replace(/'/g, \"''\")}'`\n    : '(Get-CimInstance Win32_Printer | Where-Object {$_.Default -eq $true}).Name';\n\n  const ps = `\n$ErrorActionPreference = 'Stop'\n$path = '${safePath}'\n$bytes = [System.IO.File]::ReadAllBytes($path)\nAdd-Type -Language CSharp -TypeDefinition @\"\nusing System;\nusing System.Runtime.InteropServices;\npublic class RawPrinterHelper {\n  [StructLayout(LayoutKind.Sequential)]\n  public class DOCINFOA {\n    [MarshalAs(UnmanagedType.LPStr)] public string pDocName;\n    [MarshalAs(UnmanagedType.LPStr)] public string pOutputFile;\n    [MarshalAs(UnmanagedType.LPStr)] public string pDatatype;\n  }\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool OpenPrinter(string pPrinterName, out IntPtr phPrinter, IntPtr pDefault);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool StartDocPrinter(IntPtr hPrinter, int level, DOCINFOA di);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool StartPagePrinter(IntPtr hPrinter);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool WritePrinter(IntPtr hPrinter, byte[] pBytes, int dwCount, out int dwWritten);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool EndPagePrinter(IntPtr hPrinter);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool EndDocPrinter(IntPtr hPrinter);\n  [DllImport(\"winspool.drv\", SetLastError=true)]\n  public static extern bool ClosePrinter(IntPtr hPrinter);\n}\npublic class RawPrint {\n  public static void SendBytes(string printerName, byte[] bytes) {\n    IntPtr h;\n    if (!RawPrinterHelper.OpenPrinter(printerName, out h, IntPtr.Zero)) throw new Exception(\"OpenPrinter failed\");\n    var di = new RawPrinterHelper.DOCINFOA() { pDocName = \"ESC/POS\", pDatatype = \"RAW\" };\n    if (!RawPrinterHelper.StartDocPrinter(h, 1, di)) throw new Exception(\"StartDocPrinter failed\");\n    if (!RawPrinterHelper.StartPagePrinter(h)) throw new Exception(\"StartPagePrinter failed\");\n    int written;\n    if (!RawPrinterHelper.WritePrinter(h, bytes, bytes.Length, out written)) throw new Exception(\"WritePrinter failed\");\n    RawPrinterHelper.EndPagePrinter(h);\n    RawPrinterHelper.EndDocPrinter(h);\n    RawPrinterHelper.ClosePrinter(h);\n  }\n}\n\"@\n$target = ${printerExpr}\nif (-not $target) { throw 'No target printer'; }\n[RawPrint]::SendBytes($target, $bytes)\n`;\n\n  await new Promise((resolve, reject) => {\n    const child = spawn('powershell', ['-NoProfile', '-ExecutionPolicy', 'Bypass', '-Command', ps]);\n    let stderr = '', stdout = '';\n    child.stdout.on('data', (d) => stdout += d.toString());\n    child.stderr.on('data', (d) => stderr += d.toString());\n    child.on('close', (code) => {\n      if (code === 0) resolve();\n      else reject(new Error(`WritePrinter failed (exit ${code}) ${stderr || stdout}`));\n    });\n  });\n\n  try { fs.unlinkSync(tmp); } catch { }\n}\n\n// === Public function ===\nasync function printReceipt(data, opts = {}) {\n  const logoPath = path.join(process.cwd(), 'assets/logo.png');\n  let logoWidth = 144; // fixed\n  const logoBuf = await loadLogoAsRaster(logoPath, logoWidth).catch(() => Buffer.alloc(0));\n\n  const text = Buffer.from(buildEscposReceipt(data), 'binary');\n  const bytes = Buffer.concat([\n    Buffer.from('\\x1B\\x40\\x1B\\x61\\x01', 'binary'), // init + center\n    logoBuf,\n    Buffer.from('\\x1B\\x61\\x00\\n', 'binary'),\n    text\n  ]);\n\n  console.log('[PRINT] bytes', bytes.length, 'printer', opts.printerName || '(default)');\n  await printViaRawSpooler(bytes, opts.printerName || null);\n  return { success: true };\n}\n\nmodule.exports = { printReceipt };\n"],"names":[],"mappings":"AA0CS;AA8De;AAxGxB,MAAM,EAAE,KAAK,EAAE;;;;;AACf,MAAM;;;;;AACN,MAAM;AACN,MAAM,EAAE,YAAY,EAAE,SAAS,EAAE;;;;;AAEjC,uCAAuC;AACvC,SAAS,QAAQ,CAAC,EAAE,GAAG;IACrB,MAAM,MAAM,OAAO,cAAA,eAAA,IAAK;IACxB,OAAO,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,CAAC,GAAG,OAAO,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,IAAI;AAChF;AACA,SAAS,SAAS,CAAC,EAAE,GAAG;IACtB,MAAM,MAAM,OAAO,cAAA,eAAA,IAAK;IACxB,OAAO,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,CAAC,GAAG,OAAO,MAAM,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM;AAClF;AAEA,2CAA2C;AAC3C,eAAe,iBAAiB,QAAQ;QAAE,cAAA,iEAAc;IACtD,IAAI,CAAC,GAAG,UAAU,CAAC,WAAW,OAAO,wKAAM,CAAC,KAAK,CAAC;IAClD,MAAM,MAAM,MAAM,UAAU;IAC5B,MAAM,QAAQ,cAAe,cAAc;IAC3C,MAAM,QAAQ,QAAQ,IAAI,KAAK;IAC/B,MAAM,SAAS,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,IAAI,MAAM,GAAG;IACnD,MAAM,SAAS,aAAa,OAAO;IACnC,MAAM,MAAM,OAAO,UAAU,CAAC;IAC9B,IAAI,SAAS,CAAC,KAAK,GAAG,GAAG,OAAO;IAChC,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,YAAY,CAAC,GAAG,GAAG,OAAO;IAE/C,MAAM,QAAQ,EAAE;IAChB,MAAM,IAAI,CAAC,MAAM,MAAM,MAAM,MAAM,AAAC,SAAS,IAAK,MAAM,AAAC,SAAS,KAAM,GAAG,SAAS,MAAM,AAAC,UAAU,IAAK;IAC1G,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,KAAK,EAAG;YACjC,IAAI,OAAO;YACX,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IAAK;gBAC1B,MAAM,IAAI,CAAC,AAAC,IAAI,QAAS,CAAC,IAAI,CAAC,CAAC,IAAI;gBACpC,MAAM,IAAI,IAAI,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,IAAI,CAAC,IAAI,EAAE;gBACrE,MAAM,OAAO,SAAS,IAAI,SAAS,IAAI,SAAS;gBAChD,MAAM,UAAU,AAAC,IAAI,MAAQ,OAAO;gBACpC,IAAI,SAAS,QAAS,QAAQ;YAChC;YACA,MAAM,IAAI,CAAC;QACb;IACF;IACA,OAAO,wKAAM,CAAC,IAAI,CAAC;AACrB;AAEA,iCAAiC;AACjC,SAAS,mBAAmB,IAAI;QAU1B,aAGA,cACA,cAK8B;IAlBlC,MAAM,UAAU,IAAI,OAAO,kBAAkB,CAAC,SAAS;QAAE,MAAM;QAAW,OAAO;QAAQ,KAAK;IAAU;IACxG,MAAM,aAAa;IAEnB,IAAI,IAAI;IACR,KAAK,YAAY,OAAO;IACxB,KAAK,gBAAgB,WAAW;IAChC,KAAK,gBAAgB,SAAS;IAE9B,eAAe;IACf,KAAI,cAAA,KAAK,KAAK,cAAV,kCAAA,YAAY,IAAI,EAAE;QACpB,KAAK,iBAAiB,KAAK,KAAK,CAAC,IAAI,GAAG,kBAAkB,qBAAqB;IACjF;IACA,KAAI,eAAA,KAAK,KAAK,cAAV,mCAAA,aAAY,QAAQ,EAAE,KAAK,KAAK,KAAK,CAAC,QAAQ,GAAG;IACrD,KAAI,eAAA,KAAK,KAAK,cAAV,mCAAA,aAAY,QAAQ,EAAE,KAAK,KAAK,KAAK,CAAC,QAAQ,GAAG;IACrD,KAAK;IAEL,eAAe;IACf,KAAK,gBAAgB,aAAa;IAClC,KAAK,SAAS,aAAa,MAAM,CAAC,EAAA,iBAAA,KAAK,QAAQ,cAAb,qCAAA,eAAe,IAAI,KAAI,EAAE,IAAI;IAC/D,KAAK,SAAS,SAAS,MAAM,UAAU;IACvC,KAAK,GAAG,MAAM,CAAC,YAAY,OAAO;IAElC,eAAe;IACf,KAAK,SAAS,eAAe,MAAM,QAAQ,OAAO,KAAK,QAAQ,UAAU,MAAM;IAC/E,KAAK,GAAG,MAAM,CAAC,YAAY,OAAO;IAElC,QAAQ;IACR,MAAM,QAAQ,MAAM,OAAO,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,GAAG,EAAE;IACzD,KAAK,MAAM,MAAM,MAAO;QACtB,MAAM,OAAO,OAAO,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,GAAG;QAC5C,MAAM,MAAM,QAAQ,GAAG,GAAG,IAAI,GAAG;QACjC,MAAM,SAAS,QAAQ,CAAC,GAAG,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI;QACpD,KAAK,SAAS,MAAM,MAAM,MAAM,SAAS;IAC3C;IAEA,KAAK,GAAG,MAAM,CAAC,YAAY,OAAO;IAElC,SAAS;IACT,KAAK,QAAQ,UAAU,MAAM,iBAAiB,QAAQ,CAAC,KAAK,SAAS,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,MAAM;IAC9F,KAAK;IACL,KAAK,QAAQ,WAAW,MAAM,QAAQ,CAAC,KAAK,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,MAAM;IAC3E,KAAK,QAAQ,WAAW,MAAM,QAAQ,CAAC,KAAK,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,MAAM;IAC3E,KAAK,GAAG,MAAM,CAAC,YAAY,OAAO;IAElC,SAAS;IACT,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IAEL,KAAK,gBAAgB,OAAO;IAC5B,KAAK,gBAAgB,MAAM;IAC3B,OAAO;AACT;AAEA,yCAAyC;AACzC,eAAe,mBAAmB,KAAK,EAAE,WAAW;IAClD,MAAM,MAAM,KAAK,IAAI,CAAC,2KAAO,CAAC,GAAG,IAAI,AAAC,WAAqB,OAAX,KAAK,GAAG,IAAG;IAC3D,GAAG,aAAa,CAAC,KAAK;IAEtB,MAAM,WAAW,IAAI,OAAO,CAAC,MAAM;IACnC,MAAM,cAAc,eAAe,OAAO,aAAa,IAAI,GAAG,MAAM,GAChE,AAAC,IAA2C,OAAxC,OAAO,aAAa,OAAO,CAAC,MAAM,OAAM,OAC5C;IAEJ,MAAM,KAAK,AAAC,+CA4CF,OA1CD,UAAS,8lEA0CI,OAAZ,aAAY;IAKtB,MAAM,IAAI,QAAQ,CAAC,SAAS;QAC1B,MAAM,QAAQ,MAAM,cAAc;YAAC;YAAc;YAAoB;YAAU;YAAY;SAAG;QAC9F,IAAI,SAAS,IAAI,SAAS;QAC1B,MAAM,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAM,UAAU,EAAE,QAAQ;QACnD,MAAM,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAM,UAAU,EAAE,QAAQ;QACnD,MAAM,EAAE,CAAC,SAAS,CAAC;YACjB,IAAI,SAAS,GAAG;iBACX,OAAO,IAAI,MAAM,AAAC,6BAAqC,OAAT,MAAK,MAAqB,OAAjB,UAAU;QACxE;IACF;IAEA,IAAI;QAAE,GAAG,UAAU,CAAC;IAAM,EAAE,UAAM,CAAE;AACtC;AAEA,0BAA0B;AAC1B,eAAe,aAAa,IAAI;QAAE,OAAA,iEAAO,CAAC;IACxC,MAAM,WAAW,KAAK,IAAI,CAAC,2KAAO,CAAC,GAAG,IAAI;IAC1C,IAAI,YAAY,KAAK,QAAQ;IAC7B,MAAM,UAAU,MAAM,iBAAiB,UAAU,WAAW,KAAK,CAAC,IAAM,wKAAM,CAAC,KAAK,CAAC;IAErF,MAAM,OAAO,wKAAM,CAAC,IAAI,CAAC,mBAAmB,OAAO;IACnD,MAAM,QAAQ,wKAAM,CAAC,MAAM,CAAC;QAC1B,wKAAM,CAAC,IAAI,CAAC,wBAAwB;QACpC;QACA,wKAAM,CAAC,IAAI,CAAC,kBAAkB;QAC9B;KACD;IAED,QAAQ,GAAG,CAAC,iBAAiB,MAAM,MAAM,EAAE,WAAW,KAAK,WAAW,IAAI;IAC1E,MAAM,mBAAmB,OAAO,KAAK,WAAW,IAAI;IACpD,OAAO;QAAE,SAAS;IAAK;AACzB;AAEA,OAAO,OAAO,GAAG;IAAE;AAAa","debugId":null}},
    {"offset": {"line": 644, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACZ,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IAClB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACjB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACvB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IAClB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACnB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IAClB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS","debugId":null}},
    {"offset": {"line": 771, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/pos/leftCol/useCartSelection.ts"],"sourcesContent":["import { useState } from \"react\";\r\n\r\nexport function useCartSelection<T = string>() {\r\n  const [selectedRowId, setSelectedRowId] = useState<T | null>(null);\r\n\r\n  const selectRow = (rowId: T) => {\r\n    setSelectedRowId(rowId);\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setSelectedRowId(null);\r\n  };\r\n\r\n  return {\r\n    selectedRowId,\r\n    selectRow,\r\n    clearSelection,\r\n  };\r\n}"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS;;IACd,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAW;IAE7D,MAAM,YAAY,CAAC;QACjB,iBAAiB;IACnB;IAEA,MAAM,iBAAiB;QACrB,iBAAiB;IACnB;IAEA,OAAO;QACL;QACA;QACA;IACF;AACF;GAhBgB","debugId":null}},
    {"offset": {"line": 801, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/pos/leftCol/useProductsSearch.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useRef, useMemo } from \"react\";\r\nimport { Product } from \"@/hooks/products/useProductApi\";\r\nimport Fuse from 'fuse.js';\r\nimport debounce from \"lodash.debounce\";\r\nimport axios from \"@/lib/axios\";\r\n\r\n// Add debug product creation function\r\nconst createDebugProduct = (debugCode: string): Product => {\r\n  // Extract number from debug code (e.g., \"debug100\" -> 100)\r\n  const match = debugCode.match(/debug(\\d+)/i);\r\n  const quantity = match ? parseInt(match[1]) : 1;\r\n  \r\n  return {\r\n    id: `debug-${quantity}`, // This will trigger debug mode in finalizeSale\r\n    name: `Debug Product ${quantity}`,\r\n    barcode: debugCode,\r\n    price: 10.00, // Default debug price\r\n    quantity: quantity,\r\n    category_id: 1, // Use default category ID 1 instead of null\r\n    unit: 'pcs'\r\n  };\r\n};\r\n\r\n// Add function to create multiple debug products for cart\r\nconst createMultipleDebugProducts = (debugCode: string): Product[] => {\r\n  const match = debugCode.match(/debug(\\d+)/i);\r\n  const quantity = match ? parseInt(match[1]) : 1;\r\n  \r\n  const products: Product[] = [];\r\n  for (let i = 0; i < quantity; i++) {\r\n    products.push({\r\n      id: `debug-${i + 1}`, // Each gets a unique debug ID\r\n      name: `Debug Product ${i + 1}`,\r\n      barcode: `${debugCode}-${i + 1}`,\r\n      price: 10.00,\r\n      quantity: 1, // Each row has quantity 1\r\n      category_id: 1, // Use default category ID 1 instead of null\r\n      unit: 'pcs'\r\n    });\r\n  }\r\n  \r\n  return products;\r\n};\r\n\r\n// Add debug cheat code detection\r\nconst isDebugCheatCode = (query: string): boolean => {\r\n  return /^debug\\d+$/i.test(query.trim());\r\n};\r\n\r\nexport function useProductSearch(\r\n  onSelect: (p: Product) => void, \r\n  allProducts: Product[] = [],\r\n  onUnregisteredBarcode?: (barcode: string) => void\r\n) {\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [searchResults, setSearchResults] = useState<Product[]>([]);\r\n  const [showSearchResults, setShowSearchResults] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Create Fuse instance for client-side search - only recreate when products change\r\n  const fuse = useMemo(() => {\r\n    if (!allProducts.length) return null;\r\n    \r\n    return new Fuse(allProducts, {\r\n      keys: [\r\n        { name: 'name', weight: 0.7 },\r\n        { name: 'barcode', weight: 0.3 }\r\n      ],\r\n      threshold: 0.1,\r\n      includeScore: true,\r\n      minMatchCharLength: 2,\r\n      ignoreLocation: true,\r\n      findAllMatches: false,\r\n      // Add these for better performance\r\n      shouldSort: true,\r\n      includeMatches: false, // Don't include match details for better performance\r\n    });\r\n  }, [allProducts]);\r\n\r\n  // Track typing speed to detect barcode scanner\r\n  const lastKeyTimeRef = useRef<number | null>(null);\r\n  const isScannerInputRef = useRef(false);\r\n  const lastProcessedBarcodeRef = useRef<string>(\"\");\r\n  \r\n  // Store the onSelect callback in a ref to prevent debounce recreation\r\n  const onSelectRef = useRef(onSelect);\r\n  onSelectRef.current = onSelect;\r\n\r\n  // Function to detect and clean up repeated barcode input\r\n  const cleanBarcodeInput = (input: string): string => {\r\n    // If input is all numbers and very long, it might be repeated barcode\r\n    if (/^\\d+$/.test(input) && input.length > 10) {\r\n      // Try to find the original barcode by looking for repeated patterns\r\n      const possibleLengths = [8, 10, 12, 13, 14, 15]; // Common barcode lengths\r\n      \r\n      for (const length of possibleLengths) {\r\n        if (input.length % length === 0) {\r\n          const possibleBarcode = input.substring(0, length);\r\n          const repeated = possibleBarcode.repeat(input.length / length);\r\n          if (repeated === input) {\r\n            return possibleBarcode;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // If no pattern found, try to extract the most likely barcode\r\n      // Look for the longest unique sequence\r\n      for (let i = 1; i <= input.length / 2; i++) {\r\n        const candidate = input.substring(0, i);\r\n        if (input === candidate.repeat(Math.floor(input.length / i))) {\r\n          return candidate;\r\n        }\r\n      }\r\n    }\r\n    \r\n    return input;\r\n  };\r\n\r\n  const detectScannerInput = (val: string) => {\r\n    const now = Date.now();\r\n    if (lastKeyTimeRef.current) {\r\n      const diff = now - lastKeyTimeRef.current;\r\n      if (diff < 50 && val.length > 3) {\r\n        isScannerInputRef.current = true;\r\n      } else if (diff > 150) {\r\n        isScannerInputRef.current = false;\r\n      }\r\n    }\r\n    lastKeyTimeRef.current = now;\r\n  };\r\n\r\n  // Add search result caching\r\n  const searchCache = useRef<Map<string, Product[]>>(new Map());\r\n\r\n  // Add function to handle debug product selection\r\n  const handleDebugProductSelect = useCallback((debugCode: string) => {\r\n    const multipleProducts = createMultipleDebugProducts(debugCode);\r\n    \r\n    // Add each product to cart individually\r\n    multipleProducts.forEach(product => {\r\n      onSelectRef.current(product);\r\n    });\r\n    \r\n    // Clear search after adding\r\n    setSearchQuery(\"\");\r\n    setSearchResults([]);\r\n    setShowSearchResults(false);\r\n  }, []);\r\n\r\n  const searchProducts = useCallback(\r\n    debounce(async (q: string) => {\r\n      if (!q || q.trim().length < 2) {\r\n        setSearchResults([]);\r\n        setShowSearchResults(false);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Check for debug cheat codes first\r\n      if (isDebugCheatCode(q)) {\r\n        const debugProduct = createDebugProduct(q);\r\n        setSearchResults([debugProduct]);\r\n        setShowSearchResults(true);\r\n        setIsLoading(false);\r\n        \r\n        // DON'T auto-add - wait for Enter key\r\n        return;\r\n      }\r\n\r\n      // Check cache first\r\n      const cacheKey = q.toLowerCase().trim();\r\n      if (searchCache.current.has(cacheKey)) {\r\n        setSearchResults(searchCache.current.get(cacheKey)!);\r\n        setShowSearchResults(true);\r\n        setIsLoading(false);\r\n        \r\n        // ✅ Allow auto-add even for cached results\r\n        const cachedResults = searchCache.current.get(cacheKey)!;\r\n        if (cachedResults.length === 1 && !isDebugCheatCode(q)) {\r\n          const result = cachedResults[0];\r\n          const isExactBarcodeMatch = result.barcode && q.trim() === result.barcode.trim();\r\n          const isExactNameMatch = result.name.toLowerCase().trim() === q.toLowerCase().trim();\r\n          \r\n          if (isScannerInputRef.current || isExactBarcodeMatch || isExactNameMatch) {\r\n            setTimeout(() => {\r\n              onSelectRef.current(result);\r\n              if (isScannerInputRef.current) {\r\n                setSearchQuery(\"\");\r\n                setSearchResults([]);\r\n                setShowSearchResults(false);\r\n                lastProcessedBarcodeRef.current = \"\"; // Reset processed barcode\r\n              }\r\n            }, 100);\r\n          }\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (q.trim().length === 1) {\r\n        const quickResults = allProducts\r\n          .filter(product => \r\n            product.name.toLowerCase().startsWith(q.toLowerCase())\r\n          )\r\n          .slice(0, 5);\r\n        \r\n        setSearchResults(quickResults);\r\n        setShowSearchResults(true);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      setIsLoading(true);\r\n\r\n      try {\r\n        let results: Product[] = [];\r\n        let cleanedQuery = q;\r\n\r\n        // Clean up barcode input if it looks like repeated input\r\n        if (isScannerInputRef.current || /^\\d+$/.test(q)) {\r\n          cleanedQuery = cleanBarcodeInput(q);\r\n        }\r\n\r\n        // Use client-side search if we have products loaded\r\n        if (fuse && allProducts.length > 0) {\r\n          // First, try exact barcode match\r\n          const exactBarcodeMatch = allProducts.find(product => \r\n            product.barcode && product.barcode.trim() === cleanedQuery.trim()\r\n          );\r\n          \r\n          if (exactBarcodeMatch) {\r\n            results = [exactBarcodeMatch];\r\n          } else {\r\n            // Try exact name match (case insensitive)\r\n            const exactNameMatch = allProducts.find(product => \r\n              product.name.toLowerCase().trim() === cleanedQuery.toLowerCase().trim()\r\n            );\r\n            \r\n            if (exactNameMatch) {\r\n              results = [exactNameMatch];\r\n            } else {\r\n              // Try partial name match (contains the search term)\r\n              const partialMatches = allProducts.filter(product => \r\n                product.name.toLowerCase().includes(cleanedQuery.toLowerCase())\r\n              );\r\n              \r\n              if (partialMatches.length > 0) {\r\n                results = partialMatches.slice(0, 50);\r\n              } else {\r\n                // Use Fuse.js for fuzzy search as last resort\r\n                const fuseResults = fuse.search(cleanedQuery);\r\n                results = fuseResults.slice(0, 50).map(result => result.item);\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          // Fallback to server search if no products loaded\r\n          const { data } = await axios.get(`/products/search?q=${encodeURIComponent(cleanedQuery)}`);\r\n          results = data?.data ?? [];\r\n        }\r\n\r\n        // Limit results to 50 for performance\r\n        results = results.slice(0, 50);\r\n        \r\n        // Cache results\r\n        searchCache.current.set(cacheKey, results);\r\n        \r\n        setSearchResults(results);\r\n        setShowSearchResults(true);\r\n        setIsLoading(false);\r\n\r\n        // Auto-add logic when there's only one result (but NOT for debug products)\r\n        if (results.length === 1 && !isDebugCheatCode(q)) {\r\n          const result = results[0];\r\n          const isExactBarcodeMatch = result.barcode && cleanedQuery.trim() === result.barcode.trim();\r\n          const isExactNameMatch = result.name.toLowerCase().trim() === cleanedQuery.toLowerCase().trim();\r\n          \r\n          // Auto-select for exact matches or scanner input\r\n          if (isScannerInputRef.current || isExactBarcodeMatch || isExactNameMatch) {\r\n            setTimeout(() => {\r\n              onSelectRef.current(result);\r\n\r\n              if (isScannerInputRef.current) {\r\n                setSearchQuery(\"\");\r\n                setSearchResults([]);\r\n                setShowSearchResults(false);\r\n                lastProcessedBarcodeRef.current = \"\"; // Reset processed barcode\r\n              }\r\n            }, 100);\r\n          }\r\n        } else if (results.length === 0 && isScannerInputRef.current && /^\\d+$/.test(cleanedQuery)) {\r\n          setTimeout(() => {\r\n            if (onUnregisteredBarcode) {\r\n              onUnregisteredBarcode(cleanedQuery);\r\n            }\r\n            setSearchQuery(\"\");\r\n            setSearchResults([]);\r\n            setShowSearchResults(false);\r\n            lastProcessedBarcodeRef.current = \"\"; // Reset processed barcode\r\n          }, 100);\r\n        }\r\n      } catch (error: unknown) {\r\n        if (\r\n          typeof error === \"object\" &&\r\n          error !== null &&\r\n          \"name\" in error &&\r\n          (error as { name?: unknown }).name !== \"AbortError\" &&\r\n          (error as { name?: unknown }).name !== \"CanceledError\"\r\n        ) {\r\n          console.error(\"Search error:\", error);\r\n        }\r\n        setIsLoading(false);\r\n      }\r\n    }, 100),\r\n    [fuse, allProducts]\r\n  );\r\n\r\n  useEffect(() => {\r\n    searchProducts(searchQuery);\r\n  }, [searchQuery, searchProducts]);\r\n\r\n  const handleSearchChange = (val: string) => {\r\n    detectScannerInput(val);\r\n    setSearchQuery(val);\r\n  };\r\n\r\n  const clearSearch = () => {\r\n    setSearchQuery(\"\");\r\n    setSearchResults([]);\r\n    setShowSearchResults(false);\r\n    setIsLoading(false);\r\n    lastProcessedBarcodeRef.current = \"\"; // Reset processed barcode\r\n  };\r\n\r\n  return {\r\n    searchQuery,\r\n    searchResults,\r\n    showSearchResults,\r\n    setShowSearchResults,\r\n    handleSearchChange,\r\n    clearSearch,\r\n    isScannerInputRef,\r\n    isLoading,\r\n    handleDebugProductSelect,\r\n    isDebugCheatCode,\r\n  };\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1151, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/table.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"table-container\"\r\n      className=\"relative w-full overflow-x-auto\"\r\n    >\r\n      <table\r\n        data-slot=\"table\"\r\n        className={cn(\"w-full caption-bottom text-sm\", className)}\r\n        {...props}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\r\n  return (\r\n    <thead\r\n      data-slot=\"table-header\"\r\n      className={cn(\"[&_tr]:border-b\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\r\n  return (\r\n    <tbody\r\n      data-slot=\"table-body\"\r\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\r\n  return (\r\n    <tfoot\r\n      data-slot=\"table-footer\"\r\n      className={cn(\r\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\r\n  return (\r\n    <tr\r\n      data-slot=\"table-row\"\r\n      className={cn(\r\n        \"hover:bg-muted/50 data-[state=]:bg-muted border-b transition-colors\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\r\n  return (\r\n    <th\r\n      data-slot=\"table-head\"\r\n      className={cn(\r\n        \"text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\r\n  return (\r\n    <td\r\n      data-slot=\"table-cell\"\r\n      className={cn(\r\n        \"p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TableCaption({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"caption\">) {\r\n  return (\r\n    <caption\r\n      data-slot=\"table-caption\"\r\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,KAAsD;QAAtD,EAAE,SAAS,EAAE,GAAG,OAAsC,GAAtD;IACb,qBACE,6LAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,6LAAC;YACC,aAAU;YACV,WAAW,IAAA,4HAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,KAAsD;QAAtD,EAAE,SAAS,EAAE,GAAG,OAAsC,GAAtD;IACnB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,KAAsD;QAAtD,EAAE,SAAS,EAAE,GAAG,OAAsC,GAAtD;IACjB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,KAAsD;QAAtD,EAAE,SAAS,EAAE,GAAG,OAAsC,GAAtD;IACnB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,KAAmD;QAAnD,EAAE,SAAS,EAAE,GAAG,OAAmC,GAAnD;IAChB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,KAAmD;QAAnD,EAAE,SAAS,EAAE,GAAG,OAAmC,GAAnD;IACjB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,KAAmD;QAAnD,EAAE,SAAS,EAAE,GAAG,OAAmC,GAAnD;IACjB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,aAAa,KAGY;QAHZ,EACpB,SAAS,EACT,GAAG,OAC6B,GAHZ;IAIpB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS","debugId":null}},
    {"offset": {"line": 1303, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/POS/components/leftColumn/CartTable.tsx"],"sourcesContent":["import {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Loader2 } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\r\nimport { Product } from \"@/hooks/products/useProductApi\";\r\nimport { useCart } from \"@/contexts/cart-context\";\r\n\r\ninterface CartItem {\r\n  id: string;\r\n  product: Product;\r\n  quantity: number;\r\n}\r\n\r\ninterface CartTableProps {\r\n  cart: CartItem[];\r\n  selectedRowId: string | null;\r\n  selectRow: (id: string) => void;\r\n  updateCartItemQuantity: (id: string, qty: number) => void;\r\n  updateCartItemPrice: (id: string, price: number) => void;\r\n  deleteCartItem: (id: string) => void;\r\n  disabled?: boolean;\r\n}\r\n\r\nexport default function CartTable({\r\n  cart,\r\n  selectedRowId,\r\n  selectRow,\r\n  updateCartItemQuantity,\r\n  updateCartItemPrice,\r\n  deleteCartItem,\r\n  disabled = false,\r\n}: CartTableProps) {\r\n  const { lastAddedItemId } = useCart();\r\n  const lastAutoSelectedId = useRef<string | null>(null);\r\n\r\n  // Auto-select last added cart row\r\n  useEffect(() => {\r\n    if (!lastAddedItemId || lastAutoSelectedId.current === lastAddedItemId) return;\r\n\r\n    let cancelled = false;\r\n    let attempts = 0;\r\n    const maxAttempts = 20;\r\n\r\n    const trySelect = () => {\r\n      if (cancelled) return;\r\n      const exists = cart.some((it) => it.id === lastAddedItemId);\r\n      if (exists) {\r\n        lastAutoSelectedId.current = lastAddedItemId;\r\n        try {\r\n          selectRow(lastAddedItemId);\r\n        } catch {}\r\n        return;\r\n      }\r\n      attempts++;\r\n      if (attempts < maxAttempts) requestAnimationFrame(trySelect);\r\n    };\r\n\r\n    requestAnimationFrame(trySelect);\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [lastAddedItemId, cart, selectRow]);\r\n\r\n  // Reset tracking if row is removed\r\n  useEffect(() => {\r\n    if (lastAutoSelectedId.current && !cart.find((it) => it.id === lastAutoSelectedId.current)) {\r\n      lastAutoSelectedId.current = null;\r\n    }\r\n  }, [cart]);\r\n\r\n  const handleRowClick = (itemId: string, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    selectRow(itemId);\r\n  };\r\n\r\n  const handleCellClick = (itemId: string, e: React.MouseEvent) => {\r\n    const target = e.target as HTMLElement;\r\n    if (target.tagName !== \"INPUT\" && target.tagName !== \"BUTTON\" && !target.closest(\"button\")) {\r\n      handleRowClick(itemId, e);\r\n    }\r\n  };\r\n\r\n  const priceInputRefs = useRef<Record<string, HTMLInputElement | null>>({});\r\n\r\n  // Utility: focus search bar\r\n  const focusSearchBar = useCallback(() => {\r\n    requestAnimationFrame(() => {\r\n      const ps = document.querySelector<HTMLInputElement>('[data-product-search=\"true\"]');\r\n      ps?.focus();\r\n      ps?.select?.();\r\n    });\r\n  }, []);\r\n\r\n  // --- Listen for custom cart events ---\r\n  useEffect(() => {\r\n    function handleIncrementQty(e: Event) {\r\n      const id = (e as CustomEvent).detail?.id;\r\n      const item = cart.find((it) => it.id === id);\r\n      if (item) {\r\n        updateCartItemQuantity(id, item.quantity + 1);\r\n        selectRow(id);\r\n      }\r\n    }\r\n    function handleDecrementQty(e: Event) {\r\n      const id = (e as CustomEvent).detail?.id;\r\n      const item = cart.find((it) => it.id === id);\r\n      if (item) {\r\n        updateCartItemQuantity(id, Math.max(1, item.quantity - 1));\r\n        selectRow(id);\r\n      }\r\n    }\r\n    function handleEditPrice(e: Event) {\r\n      const id = (e as CustomEvent).detail?.id;\r\n      if (!id) return;\r\n      selectRow(id);\r\n      setTimeout(() => {\r\n        const input = priceInputRefs.current[id];\r\n        input?.focus();\r\n        input?.select?.();\r\n      }, 0);\r\n    }\r\n    function handleDeleteItem(e: Event) {\r\n      const id = (e as CustomEvent).detail?.id;\r\n      if (id) {\r\n        deleteCartItem(id);\r\n        focusSearchBar();\r\n      }\r\n    }\r\n\r\n    window.addEventListener(\"cart:increment-qty\", handleIncrementQty);\r\n    window.addEventListener(\"cart:decrement-qty\", handleDecrementQty);\r\n    window.addEventListener(\"cart:edit-price\", handleEditPrice);\r\n    window.addEventListener(\"cart:delete-item\", handleDeleteItem);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"cart:increment-qty\", handleIncrementQty);\r\n      window.removeEventListener(\"cart:decrement-qty\", handleDecrementQty);\r\n      window.removeEventListener(\"cart:edit-price\", handleEditPrice);\r\n      window.removeEventListener(\"cart:delete-item\", handleDeleteItem);\r\n    };\r\n  }, [cart, updateCartItemQuantity, selectRow, deleteCartItem, focusSearchBar]);\r\n\r\n  // --- PriceCell ---\r\n  const PriceCell: React.FC<{ item: CartItem }> = ({ item }) => {\r\n    const [editing, setEditing] = useState(false);\r\n    const [value, setValue] = useState<string>(String(item.product.price ?? 0));\r\n    const ref = useRef<HTMLInputElement | null>(null);\r\n\r\n    useEffect(() => {\r\n      priceInputRefs.current[item.id] = ref.current;\r\n      return () => {\r\n        priceInputRefs.current[item.id] = null;\r\n      };\r\n    }, [item.id]);\r\n\r\n    useEffect(() => {\r\n      if (!editing) setValue(String(item.product.price ?? 0));\r\n    }, [item.product.price, editing]);\r\n\r\n    const commit = useCallback(() => {\r\n      setEditing(false);\r\n      const parsed = Number(String(value).replace(/,/g, \"\"));\r\n      const price = Number.isFinite(parsed) ? parsed : 0;\r\n      updateCartItemPrice(item.id, price);\r\n      focusSearchBar();\r\n    }, [value, item.id, updateCartItemPrice]);\r\n\r\n    return (\r\n      <Input\r\n        ref={ref}\r\n        type=\"text\"\r\n        data-cart-price-input={item.id}\r\n        value={value}\r\n        className=\"w-20 h-8 text-sm\"\r\n        onFocus={() => {\r\n          selectRow(item.id);\r\n          setEditing(true);\r\n        }}\r\n        onChange={(e) => setValue(e.target.value)}\r\n        onBlur={commit}\r\n        onKeyDown={(e) => {\r\n          if (e.key === \"Enter\") {\r\n            (e.target as HTMLInputElement).blur();\r\n          } else if (e.key === \"Escape\") {\r\n            setEditing(false);\r\n            setValue(String(item.product.price ?? 0));\r\n            focusSearchBar();\r\n          }\r\n        }}\r\n        disabled={disabled}\r\n      />\r\n    );\r\n  };\r\n\r\n  // Add this custom quantity input component before the main CartTable component\r\n  const QuantityInput: React.FC<{\r\n    value: number;\r\n    onChange: (value: number) => void;\r\n    onFocus: () => void;\r\n    onBlur: () => void;\r\n    onKeyDown: (e: React.KeyboardEvent) => void;\r\n    disabled?: boolean;\r\n    itemId: string;\r\n  }> = ({ value, onChange, onFocus, onBlur, onKeyDown, disabled, itemId }) => {\r\n    const [inputValue, setInputValue] = useState<string>(value.toString());\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    // Update input value when prop value changes (but not when user is editing)\r\n    useEffect(() => {\r\n      if (!isEditing) {\r\n        setInputValue(value.toString());\r\n      }\r\n    }, [value, isEditing]);\r\n\r\n    // Prevent focus loss from external sources while editing\r\n    useEffect(() => {\r\n      if (isEditing && inputRef.current) {\r\n        const handleFocusLoss = (e: FocusEvent) => {\r\n          // If focus is moving to another input, allow it\r\n          const target = e.relatedTarget as HTMLElement;\r\n          if (target && (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA')) {\r\n            return;\r\n          }\r\n          \r\n          // If focus is being lost to the body or null, prevent it and refocus\r\n          if (!target || target === document.body) {\r\n            e.preventDefault();\r\n            setTimeout(() => {\r\n              if (inputRef.current && isEditing) {\r\n                inputRef.current.focus();\r\n              }\r\n            }, 0);\r\n          }\r\n        };\r\n\r\n        const input = inputRef.current;\r\n        input.addEventListener('blur', handleFocusLoss);\r\n        \r\n        return () => {\r\n          input.removeEventListener('blur', handleFocusLoss);\r\n        };\r\n      }\r\n    }, [isEditing]);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      const newValue = e.target.value;\r\n      \r\n      // Allow empty string, numbers, and valid decimal patterns\r\n      if (newValue === '' || newValue === '.' || /^\\d*\\.?\\d*$/.test(newValue)) {\r\n        setInputValue(newValue);\r\n        // Don't call onChange here - only update on commit to prevent focus loss\r\n      }\r\n    };\r\n\r\n    const handleFocus = () => {\r\n      setIsEditing(true);\r\n      onFocus();\r\n    };\r\n\r\n    const handleBlur = () => {\r\n      setIsEditing(false);\r\n      \r\n      let finalValue: number;\r\n      let displayValue: string;\r\n      \r\n      // Validate and normalize the value on blur\r\n      if (inputValue === '' || inputValue === '.') {\r\n        finalValue = 1;\r\n        displayValue = '1';\r\n      } else {\r\n        const numValue = parseFloat(inputValue);\r\n        if (isNaN(numValue) || numValue <= 0) {\r\n          finalValue = 1;\r\n          displayValue = '1';\r\n        } else {\r\n          finalValue = numValue;\r\n          // Format to max 2 decimals\r\n          displayValue = numValue % 1 === 0 ? numValue.toString() : numValue.toFixed(2).replace(/\\.?0+$/, '');\r\n        }\r\n      }\r\n      \r\n      // Update both the display and the actual value\r\n      setInputValue(displayValue);\r\n      onChange(finalValue);\r\n      \r\n      // Call the original onBlur handler\r\n      onBlur();\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n      // Handle Enter key\r\n      if (e.key === \"Enter\") {\r\n        handleBlur();\r\n        return;\r\n      }\r\n      \r\n      // Allow: backspace, delete, tab, escape, decimal point, and numbers\r\n      if (\r\n        [8, 9, 27, 46, 110, 190].indexOf(e.keyCode) !== -1 ||\r\n        // Allow Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X\r\n        (e.keyCode === 65 && e.ctrlKey === true) ||\r\n        (e.keyCode === 67 && e.ctrlKey === true) ||\r\n        (e.keyCode === 86 && e.ctrlKey === true) ||\r\n        (e.keyCode === 88 && e.ctrlKey === true) ||\r\n        // Allow home, end, left, right, up, down arrows\r\n        (e.keyCode >= 35 && e.keyCode <= 40) ||\r\n        // Allow numbers and decimal point\r\n        (e.keyCode >= 48 && e.keyCode <= 57) ||\r\n        (e.keyCode >= 96 && e.keyCode <= 105)\r\n      ) {\r\n        return;\r\n      }\r\n      e.preventDefault();\r\n    };\r\n\r\n    return (\r\n      <Input\r\n        ref={inputRef}\r\n        type=\"text\"\r\n        data-cart-qty-input={itemId}\r\n        value={inputValue}\r\n        className=\"w-16 h-8 text-sm\"\r\n        onFocus={handleFocus}\r\n        onChange={handleChange}\r\n        onBlur={handleBlur}\r\n        onKeyDown={handleKeyDown}\r\n        disabled={disabled}\r\n        placeholder=\"1\"\r\n      />\r\n    );\r\n  };\r\n\r\n  if (cart.length === 0) {\r\n    return (\r\n      <div className=\"flex-1 flex items-center justify-center w-full h-full\">\r\n        <div className=\"text-center space-y-4\">\r\n          <span className=\"text-gray-500\">🛒 Scan or search to add products</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Table>\r\n      <TableHeader>\r\n        <TableRow>\r\n          <TableHead className=\"text-lg font-semibold py-3\">Barcode</TableHead>\r\n          <TableHead className=\"text-lg font-semibold py-3\">Name</TableHead>\r\n          <TableHead className=\"text-lg font-semibold py-3\">Price</TableHead>\r\n          <TableHead className=\"text-lg font-semibold py-3\">Quantity</TableHead>\r\n          <TableHead className=\"text-lg font-semibold py-3\">Actions</TableHead>\r\n        </TableRow>\r\n      </TableHeader>\r\n      <TableBody>\r\n        {cart.map((item) => {\r\n          const isSelected = selectedRowId === item.id;\r\n\r\n          return (\r\n            <TableRow\r\n              key={item.id}\r\n              data-cart-id={item.id}\r\n              className={cn(\r\n                \"hover:bg-gray-50 cursor-pointer transition-all duration-200\",\r\n                isSelected ? \"bg-gray-100 dark:bg-gray-800\" : \"\"\r\n              )}\r\n              onClick={(e) => handleRowClick(item.id, e)}\r\n              data-cart-selected={isSelected}\r\n            >\r\n              <TableCell\r\n                className=\"font-medium max-w-[140px] break-words whitespace-normal py-3 px-4\"\r\n                onClick={(e) => handleCellClick(item.id, e)}\r\n              >\r\n                {item.product.barcode || \"N/A\"}\r\n              </TableCell>\r\n\r\n              <TableCell\r\n                className=\"min-w-0 max-w-[320px] break-words whitespace-normal py-3 px-4\"\r\n                onClick={(e) => handleCellClick(item.id, e)}\r\n              >\r\n                {item.product.__placeholder ? (\r\n                  <div className=\"flex items-center gap-2 text-gray-500\">\r\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    <span>Fetching product…</span>\r\n                  </div>\r\n                ) : (\r\n                  item.product.name\r\n                )}\r\n              </TableCell>\r\n\r\n              <TableCell className=\"py-3 px-4\">\r\n                <PriceCell item={item} />\r\n              </TableCell>\r\n\r\n              <TableCell className=\"py-3 px-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <QuantityInput\r\n                    value={item.quantity}\r\n                    onChange={(qty) => updateCartItemQuantity(item.id, qty)}\r\n                    onFocus={() => selectRow(item.id)}\r\n                    onBlur={focusSearchBar}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === \"Enter\") {\r\n                        (e.target as HTMLInputElement).blur();\r\n                        focusSearchBar();\r\n                      }\r\n                    }}\r\n                    disabled={disabled}\r\n                    itemId={item.id}\r\n                  />\r\n                  <span className=\"text-sm text-gray-600 font-medium\">\r\n                    {item.product.unit || \"pcs\"}\r\n                  </span>\r\n                </div>\r\n              </TableCell>\r\n\r\n              <TableCell className=\"py-3 px-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"text-sm text-red-600 hover:underline disabled:opacity-50\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    deleteCartItem(item.id);\r\n                    focusSearchBar();\r\n                  }}\r\n                  disabled={disabled}\r\n                >\r\n                  Delete\r\n                </button>\r\n              </TableCell>\r\n            </TableRow>\r\n          );\r\n        })}\r\n      </TableBody>\r\n    </Table>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1909, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/POS/components/leftColumn/ProductSearch.tsx"],"sourcesContent":["import { Input } from \"@/components/ui/input\";\r\nimport { Search, CheckCircle } from \"lucide-react\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport { Product } from \"@/hooks/products/useProductApi\";\r\n\r\ninterface ProductSearchProps {\r\n  searchQuery: string;\r\n  searchResults: Product[];\r\n  showSearchResults: boolean;\r\n  handleSearchChange: (val: string) => void;\r\n  handleSearchSelect: (product: Product) => void;\r\n  clearSearch: () => void;\r\n  disabled?: boolean;\r\n  inputRef?: React.RefObject<HTMLInputElement>;\r\n  isScannerInputRef?: React.MutableRefObject<boolean>;\r\n  isLoading?: boolean;\r\n  onAddProduct?: () => void;\r\n  // Add these new props\r\n  handleDebugProductSelect?: (debugCode: string) => void;\r\n  isDebugCheatCode?: (query: string) => boolean;\r\n}\r\n\r\nexport default function ProductSearch({\r\n  searchQuery,\r\n  searchResults,\r\n  showSearchResults,\r\n  handleSearchChange,\r\n  handleSearchSelect,\r\n  clearSearch,\r\n  disabled = false,\r\n  inputRef,\r\n  isScannerInputRef,\r\n  isLoading,\r\n  onAddProduct,\r\n  handleDebugProductSelect,\r\n  isDebugCheatCode,\r\n}: ProductSearchProps) {\r\n  const isAutoSelecting = searchResults.length === 1 && searchQuery.trim().length >= 2;\r\n  const [highlightedIndex, setHighlightedIndex] = useState<number>(-1);\r\n  const resultsContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Reset highlight when results change\r\n  useEffect(() => {\r\n    setHighlightedIndex(searchResults.length > 0 ? 0 : -1);\r\n  }, [searchResults, showSearchResults]);\r\n\r\n  // Keyboard navigation\r\n  useEffect(() => {\r\n    const inputEl = inputRef?.current;\r\n    if (!inputEl) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === \"ArrowDown\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setHighlightedIndex((prev) =>\r\n          prev < searchResults.length - 1 ? prev + 1 : 0\r\n        );\r\n        scrollToHighlighted();\r\n      } else if (e.key === \"ArrowUp\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setHighlightedIndex((prev) =>\r\n          prev > 0 ? prev - 1 : searchResults.length - 1\r\n        );\r\n        scrollToHighlighted();\r\n      } else if (e.key === \"Enter\") {\r\n        if (highlightedIndex >= 0 && highlightedIndex < searchResults.length) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          \r\n          const selectedProduct = searchResults[highlightedIndex];\r\n          \r\n          // Check if it's a debug product\r\n          if (isDebugCheatCode && handleDebugProductSelect && isDebugCheatCode(searchQuery)) {\r\n            handleDebugProductSelect(searchQuery);\r\n          } else {\r\n            handleSearchSelect(selectedProduct);\r\n          }\r\n        }\r\n      } else if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        clearSearch();\r\n        requestAnimationFrame(() => {\r\n          inputEl.focus();\r\n          inputEl.select?.();\r\n        });\r\n      }\r\n    };\r\n\r\n    inputEl.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => inputEl.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [searchResults, highlightedIndex, handleSearchSelect, clearSearch, inputRef, handleDebugProductSelect, isDebugCheatCode, searchQuery]);\r\n\r\n  // Scroll highlighted item into view\r\n  const scrollToHighlighted = () => {\r\n    setTimeout(() => {\r\n      if (resultsContainerRef.current) {\r\n        const item = resultsContainerRef.current.querySelector(\r\n          `[data-highlighted=\"true\"]`\r\n        );\r\n        if (item) {\r\n          (item as HTMLElement).scrollIntoView({ block: \"nearest\" });\r\n        }\r\n      }\r\n    }, 0);\r\n  };\r\n\r\n  // Skip rendering dropdown if scanner already auto-selected\r\n  const shouldShowDropdown =\r\n    showSearchResults &&\r\n    !isScannerInputRef?.current &&\r\n    searchResults.length > 0;\r\n\r\n  return (\r\n    <div className=\"relative mb-6\">\r\n      <div className=\"relative flex items-center\">\r\n        <Search\r\n          className=\"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400\"\r\n          size={20}\r\n        />\r\n        <Input\r\n          ref={inputRef}\r\n          data-product-search=\"true\"\r\n          data-search-open={showSearchResults ? \"true\" : \"false\"}\r\n          className=\"pl-9 w-full\"\r\n          placeholder=\"Search by product name or barcode...\"\r\n          value={searchQuery}\r\n          onChange={(e) => handleSearchChange(e.target.value)}\r\n          onClick={(e) => e.stopPropagation()}\r\n          disabled={disabled}\r\n        />\r\n        {isAutoSelecting && !isScannerInputRef?.current && (\r\n          <CheckCircle\r\n            className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-green-500 animate-pulse\"\r\n            size={20}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {isLoading && (\r\n        <div className=\"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 p-3 text-center text-gray-500\">\r\n          Searching...\r\n        </div>\r\n      )}\r\n\r\n      {shouldShowDropdown && (\r\n        <div\r\n          ref={resultsContainerRef}\r\n          className=\"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 max-h-[32rem] overflow-y-auto\"\r\n        >\r\n          {searchResults.map((product, idx) => (\r\n            <div\r\n              key={product.id}\r\n              data-highlighted={highlightedIndex === idx}\r\n              className={`p-3 cursor-pointer border-b last:border-b-0 ${\r\n                highlightedIndex === idx\r\n                  ? \"bg-blue-100\"\r\n                  : \"hover:bg-gray-50\"\r\n              }`}\r\n              onClick={() => {\r\n                // Check if it's a debug product\r\n                if (isDebugCheatCode && handleDebugProductSelect && isDebugCheatCode(searchQuery)) {\r\n                  handleDebugProductSelect(searchQuery);\r\n                } else {\r\n                  handleSearchSelect(product);\r\n                }\r\n              }}\r\n            >\r\n              <div className=\"flex justify-between items-center\">\r\n                <div className=\"min-w-0\">\r\n                  <div className=\"font-medium break-words whitespace-normal flex items-center gap-2\">\r\n                    {product.name}\r\n                    {isDebugCheatCode && isDebugCheatCode(searchQuery) && (\r\n                      <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">\r\n                        DEBUG\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-500\">\r\n                    Barcode: {product.barcode}\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right ml-4 flex-shrink-0\">\r\n                  <div className=\"font-medium\">\r\n                    ₱ {product.price.toFixed(2)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {showSearchResults &&\r\n        !isScannerInputRef?.current &&\r\n        searchResults.length === 0 &&\r\n        searchQuery.length >= 2 &&\r\n        !isLoading && (\r\n          <div className=\"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 p-3 text-center text-gray-500\">\r\n            <div className=\"mb-2\">\r\n              No product found matching \"{searchQuery}\"\r\n            </div>\r\n            {onAddProduct && (\r\n              <button\r\n                onClick={onAddProduct}\r\n                className=\"text-blue-600 hover:text-blue-800 hover:underline text-sm font-medium\"\r\n              >\r\n                Add new product\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2203, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { buttonVariants } from \"@/components/ui/button\"\r\n\r\nfunction AlertDialog({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {\r\n  return <AlertDialogPrimitive.Root data-slot=\"alert-dialog\" {...props} />\r\n}\r\n\r\nfunction AlertDialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {\r\n  return (\r\n    <AlertDialogPrimitive.Trigger data-slot=\"alert-dialog-trigger\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {\r\n  return (\r\n    <AlertDialogPrimitive.Portal data-slot=\"alert-dialog-portal\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {\r\n  return (\r\n    <AlertDialogPrimitive.Overlay\r\n      data-slot=\"alert-dialog-overlay\"\r\n      className={cn(\r\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {\r\n  return (\r\n    <AlertDialogPortal>\r\n      <AlertDialogOverlay />\r\n      <AlertDialogPrimitive.Content\r\n        data-slot=\"alert-dialog-content\"\r\n        className={cn(\r\n          \"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\r\n          className\r\n        )}\r\n        {...props}\r\n      />\r\n    </AlertDialogPortal>\r\n  )\r\n}\r\n\r\nfunction AlertDialogHeader({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-header\"\r\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogFooter({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-footer\"\r\n      className={cn(\r\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {\r\n  return (\r\n    <AlertDialogPrimitive.Title\r\n      data-slot=\"alert-dialog-title\"\r\n      className={cn(\"text-lg font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {\r\n  return (\r\n    <AlertDialogPrimitive.Description\r\n      data-slot=\"alert-dialog-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogAction({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {\r\n  return (\r\n    <AlertDialogPrimitive.Action\r\n      className={cn(buttonVariants(), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogCancel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {\r\n  return (\r\n    <AlertDialogPrimitive.Cancel\r\n      className={cn(buttonVariants({ variant: \"outline\" }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAGA;AAEA;AACA;AANA;;;;;AAQA,SAAS,YAAY,KAEoC;QAFpC,EACnB,GAAG,OACoD,GAFpC;IAGnB,qBAAO,6LAAC,sLAAyB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AACtE;KAJS;AAMT,SAAS,mBAAmB,KAEgC;QAFhC,EAC1B,GAAG,OACuD,GAFhC;IAG1B,qBACE,6LAAC,yLAA4B;QAAC,aAAU;QAAwB,GAAG,KAAK;;;;;;AAE5E;MANS;AAQT,SAAS,kBAAkB,KAEgC;QAFhC,EACzB,GAAG,OACsD,GAFhC;IAGzB,qBACE,6LAAC,wLAA2B;QAAC,aAAU;QAAuB,GAAG,KAAK;;;;;;AAE1E;MANS;AAQT,SAAS,mBAAmB,KAGgC;QAHhC,EAC1B,SAAS,EACT,GAAG,OACuD,GAHhC;IAI1B,qBACE,6LAAC,yLAA4B;QAC3B,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,mBAAmB,KAGgC;QAHhC,EAC1B,SAAS,EACT,GAAG,OACuD,GAHhC;IAI1B,qBACE,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,aAAU;gBACV,WAAW,IAAA,4HAAE,EACX,+WACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIjB;MAjBS;AAmBT,SAAS,kBAAkB,KAGG;QAHH,EACzB,SAAS,EACT,GAAG,OACyB,GAHH;IAIzB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,KAGG;QAHH,EACzB,SAAS,EACT,GAAG,OACyB,GAHH;IAIzB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,iBAAiB,KAGgC;QAHhC,EACxB,SAAS,EACT,GAAG,OACqD,GAHhC;IAIxB,qBACE,6LAAC,uLAA0B;QACzB,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,uBAAuB,KAGgC;QAHhC,EAC9B,SAAS,EACT,GAAG,OAC2D,GAHhC;IAI9B,qBACE,6LAAC,6LAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,KAGgC;QAHhC,EACzB,SAAS,EACT,GAAG,OACsD,GAHhC;IAIzB,qBACE,6LAAC,wLAA2B;QAC1B,WAAW,IAAA,4HAAE,EAAC,IAAA,uJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;AAGf;MAVS;AAYT,SAAS,kBAAkB,KAGgC;QAHhC,EACzB,SAAS,EACT,GAAG,OACsD,GAHhC;IAIzB,qBACE,6LAAC,wLAA2B;QAC1B,WAAW,IAAA,4HAAE,EAAC,IAAA,uJAAc,EAAC;YAAE,SAAS;QAAU,IAAI;QACrD,GAAG,KAAK;;;;;;AAGf;OAVS","debugId":null}},
    {"offset": {"line": 2409, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/POS/components/leftColumn/index.tsx"],"sourcesContent":["import { Card, CardContent } from \"@/components/ui/card\";\r\nimport { useCart } from \"@/contexts/cart-context\";\r\nimport { useCartSelection } from \"@/hooks/pos/leftCol/useCartSelection\";\r\nimport { useProducts } from \"@/hooks/global/fetching/useProducts\";\r\nimport { useProductSearch } from \"@/hooks/pos/leftCol/useProductsSearch\";\r\nimport { useCartKeyboard } from \"@/contexts/cart-context\";\r\nimport React, { useRef, useEffect, useState, useCallback } from \"react\";\r\nimport CartTable from \"./CartTable\";\r\nimport ProductSearch from \"./ProductSearch\";\r\nimport { useProductModal } from \"@/contexts/productRegister-context\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport ProductRegisterModal from \"@/components/product/components/ProductRegisterModal\";\r\nimport { productApi } from \"@/hooks/products/useProductApi\";\r\n\r\ninterface POSLeftColProps {\r\n  step: 1 | 2 | 3;\r\n}\r\n\r\nexport default function POSLeftCol({ step }: POSLeftColProps) {\r\n  const { selectedRowId, selectRow, clearSelection } = useCartSelection<string>();\r\n  const { products } = useProducts();\r\n  const {\r\n    cart,\r\n    updateCartItemQuantity,\r\n    scanAndAddToCart,\r\n    addProductToCart,\r\n    updateCartItemPrice,\r\n    deleteCartItem,\r\n  } = useCart();\r\n\r\n  const { setOpen, setBarcode } = useProductModal();\r\n\r\n  useCartKeyboard(selectedRowId);\r\n\r\n  const productSearchInputRef = useRef<HTMLInputElement>(null!);\r\n\r\n  // Utility: focus search bar (same as in CartTable)\r\n  const focusSearchBar = useCallback(() => {\r\n    requestAnimationFrame(() => {\r\n      const ps = document.querySelector<HTMLInputElement>('[data-product-search=\"true\"]');\r\n      ps?.focus();\r\n      ps?.select?.();\r\n    });\r\n  }, []);\r\n\r\n  // Flag to prevent focusing search when user triggers \"edit price\"\r\n  const priceEditRequestedRef = useRef(false);\r\n\r\n  // CRITICAL: Listen for focusBarcodeScanner event from pos-screen.tsx\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    const handleFocusBarcodeScanner = () => {\r\n      if (priceEditRequestedRef.current) return;\r\n      focusSearchBar();\r\n    };\r\n\r\n    window.addEventListener(\"focusBarcodeScanner\", handleFocusBarcodeScanner);\r\n    return () => {\r\n      window.removeEventListener(\"focusBarcodeScanner\", handleFocusBarcodeScanner);\r\n    };\r\n  }, [focusSearchBar]);\r\n\r\n  // Handle edit price request\r\n  useEffect(() => {\r\n    const onEditRequest = () => {\r\n      priceEditRequestedRef.current = true;\r\n      setTimeout(() => (priceEditRequestedRef.current = false), 600);\r\n    };\r\n    window.addEventListener(\"cart:edit-price\", onEditRequest);\r\n    return () => window.removeEventListener(\"cart:edit-price\", onEditRequest);\r\n  }, []);\r\n\r\n  // DECLARE FUNCTIONS FIRST before using them in useProductSearch\r\n  const handleSearchSelect = useCallback(\r\n    (product: any) => {\r\n      addProductToCart(product);\r\n      // clearSearch will be called by the useProductSearch hook\r\n      setTimeout(() => {\r\n        try {\r\n          productSearchInputRef.current?.focus();\r\n          productSearchInputRef.current?.select?.();\r\n        } catch {}\r\n      }, 100);\r\n    },\r\n    [addProductToCart]\r\n  );\r\n\r\n  const handleScanAndAddToCart = useCallback(\r\n    async (barcode: string) => {\r\n      try {\r\n        await scanAndAddToCart(barcode);\r\n        // clearSearch will be called by the useProductSearch hook\r\n        setTimeout(() => {\r\n          try {\r\n            productSearchInputRef.current?.focus();\r\n            productSearchInputRef.current?.select?.();\r\n          } catch {}\r\n        }, 100);\r\n      } catch (error) {\r\n        console.error(\"Scan error:\", error);\r\n      }\r\n    },\r\n    [scanAndAddToCart]\r\n  );\r\n\r\n  const {\r\n    searchQuery,\r\n    searchResults,\r\n    showSearchResults,\r\n    handleSearchChange,\r\n    clearSearch,\r\n    isScannerInputRef,\r\n    isLoading,\r\n    handleDebugProductSelect,\r\n    isDebugCheatCode,\r\n  } = useProductSearch(handleSearchSelect, products, handleScanAndAddToCart);\r\n\r\n  const [showRegisterDialog, setShowRegisterDialog] = useState(false);\r\n  const [unregisteredBarcode, setUnregisteredBarcode] = useState<string | null>(null);\r\n\r\n  // Add this function\r\n  const handleAddProduct = () => {\r\n    setBarcode(searchQuery); // Pre-fill with the search query\r\n    setOpen(true);\r\n  };\r\n\r\n  // Add effect to handle product added event\r\n  useEffect(() => {\r\n    const handleProductAdded = () => {\r\n      // Clear search and refocus search bar when product is added\r\n      clearSearch();\r\n      setTimeout(() => {\r\n        try {\r\n          productSearchInputRef.current?.focus();\r\n          productSearchInputRef.current?.select?.();\r\n        } catch {}\r\n      }, 100);\r\n    };\r\n\r\n    window.addEventListener(\"product:added\", handleProductAdded);\r\n    return () => window.removeEventListener(\"product:added\", handleProductAdded);\r\n  }, [clearSearch]);\r\n\r\n  // Handle unregistered barcode\r\n  const handleUnregisteredBarcode = useCallback((barcode: string) => {\r\n    setUnregisteredBarcode(barcode);\r\n    setShowRegisterDialog(true);\r\n  }, []);\r\n\r\n  // ✅ FIXED: Listen for unregistered barcode events from cart-context\r\n  useEffect(() => {\r\n    const handleUnregisteredBarcodeEvent = (e: Event) => {\r\n      const detail = (e as CustomEvent)?.detail;\r\n      if (detail?.barcode) {\r\n        handleUnregisteredBarcode(detail.barcode);\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"unregistered-barcode\", handleUnregisteredBarcodeEvent);\r\n    return () => {\r\n      window.removeEventListener(\"unregistered-barcode\", handleUnregisteredBarcodeEvent);\r\n    };\r\n  }, [handleUnregisteredBarcode]);\r\n\r\n  // Handle register dialog close\r\n  const handleRegisterDialogClose = useCallback(() => {\r\n    setShowRegisterDialog(false);\r\n    setUnregisteredBarcode(null);\r\n    setTimeout(() => {\r\n      try {\r\n        productSearchInputRef.current?.focus();\r\n        productSearchInputRef.current?.select?.();\r\n      } catch {}\r\n    }, 100);\r\n  }, []);\r\n\r\n  // ✅ FIXED: Handle register dialog confirm - now opens the modal\r\n  const handleRegisterDialogConfirm = useCallback(() => {\r\n    setShowRegisterDialog(false);\r\n    if (unregisteredBarcode) {\r\n      setBarcode(unregisteredBarcode);\r\n      setOpen(true);\r\n    }\r\n    setUnregisteredBarcode(null);\r\n    setTimeout(() => {\r\n      try {\r\n        productSearchInputRef.current?.focus();\r\n        productSearchInputRef.current?.select?.();\r\n      } catch {}\r\n    }, 100);\r\n  }, [unregisteredBarcode, setBarcode, setOpen]);\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      <Card className=\"flex-1 overflow-hidden\">\r\n        <CardContent className=\"p-4 h-full flex flex-col\">\r\n          <ProductSearch\r\n            searchQuery={searchQuery}\r\n            searchResults={searchResults}\r\n            showSearchResults={showSearchResults}\r\n            handleSearchChange={handleSearchChange}\r\n            handleSearchSelect={handleSearchSelect}\r\n            clearSearch={clearSearch}\r\n            disabled={step !== 1}\r\n            inputRef={productSearchInputRef}\r\n            isScannerInputRef={isScannerInputRef}\r\n            isLoading={isLoading}\r\n            onAddProduct={handleAddProduct}\r\n            handleDebugProductSelect={handleDebugProductSelect}\r\n            isDebugCheatCode={isDebugCheatCode}\r\n          />\r\n          {isLoading && (\r\n            <div className=\"text-center text-gray-500 py-4\">\r\n              Searching...\r\n            </div>\r\n          )}\r\n          <CartTable\r\n            cart={cart}\r\n            selectedRowId={selectedRowId}\r\n            selectRow={selectRow}\r\n            updateCartItemQuantity={updateCartItemQuantity}\r\n            updateCartItemPrice={updateCartItemPrice}\r\n            deleteCartItem={deleteCartItem}\r\n            disabled={step !== 1}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Unregistered Barcode Dialog */}\r\n      <AlertDialog open={showRegisterDialog} onOpenChange={setShowRegisterDialog}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Product Not Found</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              The barcode \"{unregisteredBarcode}\" is not registered in the system. \r\n              Would you like to add this product?\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel onClick={handleRegisterDialogClose}>\r\n              Cancel\r\n            </AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleRegisterDialogConfirm}>\r\n              Add Product\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Product Register Modal */}\r\n      <ProductRegisterModal />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2800, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/POS/pos-screen.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { CartProvider } from \"@/contexts/cart-context\";\r\n\r\nimport POSright from \"./components/rightColumn/index\";\r\nimport POSleft from \"./components/leftColumn/index\";\r\n\r\nexport default function MainDashboard() {\r\n  const [step, setStep] = useState<1 | 2 | 3>(1);\r\n\r\n  // Sync React step into a global so the existing document-level keyboard handler\r\n  // (useCartKeyboard) can detect the current POS step. Cleared on unmount.\r\n  useEffect(() => {\r\n    try {\r\n      (window as any).posStep = step;\r\n    } catch { }\r\n    return () => {\r\n      try {\r\n        delete (window as any).posStep;\r\n      } catch { }\r\n    };\r\n  }, [step]);\r\n\r\n  // ensure scanner input in POS immediately receives focus when this page mounts\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    const focusScanner = () => {\r\n      try {\r\n        window.dispatchEvent(new Event(\"focusBarcodeScanner\"));\r\n      } catch { }\r\n    };\r\n\r\n    // immediate + a short delayed dispatch to cover timing differences\r\n    focusScanner();\r\n    const t = setTimeout(focusScanner, 120);\r\n\r\n    // also focus when the browser window regains focus (user alt-tabs back)\r\n    window.addEventListener(\"focus\", focusScanner);\r\n\r\n    return () => {\r\n      clearTimeout(t);\r\n      window.removeEventListener(\"focus\", focusScanner);\r\n    };\r\n  }, []);\r\n\r\n  // Handle Ctrl+Enter and dispatch a focus event for the cash input\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    const handleCtrlEnter = (e: KeyboardEvent) => {\r\n      if (e.ctrlKey && e.key === \"Enter\") {\r\n        // Only act while on the POS page (this component is only mounted on the POS page)\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        window.dispatchEvent(new Event(\"focusCashInput\"));\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"keydown\", handleCtrlEnter);\r\n    return () => window.removeEventListener(\"keydown\", handleCtrlEnter);\r\n  }, []);\r\n\r\n  // Handle Ctrl+B for step back functionality with event capture\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    const handleCtrlB = (e: KeyboardEvent) => {\r\n      if (e.ctrlKey && e.key.toLowerCase() === \"b\") {\r\n        // Prevent browser bold shortcut and sidebar collapse\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n        \r\n        // Dispatch the step back event\r\n        window.dispatchEvent(new Event(\"pos:step-1-back\"));\r\n      }\r\n    };\r\n\r\n    // Use capture phase to ensure this runs before other listeners\r\n    window.addEventListener(\"keydown\", handleCtrlB, true);\r\n    return () => window.removeEventListener(\"keydown\", handleCtrlB, true);\r\n  }, []);\r\n\r\n  return (\r\n    <CartProvider>\r\n      <div className=\"flex flex-col lg:flex-row w-full h-full py-4 px-4 gap-2\">\r\n        {/* Left side */}\r\n        <div className=\"flex-1\">\r\n          <POSleft step={step} />\r\n        </div>\r\n\r\n        {/* Right side (hidden on flex-col, shown only on lg+ when flex-row applies) */}\r\n        <div className=\"hidden lg:flex flex-col basis-[30%] gap-2\">\r\n          <POSright step={step} setStep={setStep} />\r\n        </div>\r\n      </div>\r\n    </CartProvider>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;AACA;;;;;;;AAEe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAY;IAE5C,gFAAgF;IAChF,yEAAyE;IACzE,IAAA,0KAAS;mCAAC;YACR,IAAI;gBACD,OAAe,OAAO,GAAG;YAC5B,EAAE,UAAM,CAAE;YACV;2CAAO;oBACL,IAAI;wBACF,OAAO,AAAC,OAAe,OAAO;oBAChC,EAAE,UAAM,CAAE;gBACZ;;QACF;kCAAG;QAAC;KAAK;IAET,+EAA+E;IAC/E,IAAA,0KAAS;mCAAC;YACR;;YAEA,MAAM;wDAAe;oBACnB,IAAI;wBACF,OAAO,aAAa,CAAC,IAAI,MAAM;oBACjC,EAAE,UAAM,CAAE;gBACZ;;YAEA,mEAAmE;YACnE;YACA,MAAM,IAAI,WAAW,cAAc;YAEnC,wEAAwE;YACxE,OAAO,gBAAgB,CAAC,SAAS;YAEjC;2CAAO;oBACL,aAAa;oBACb,OAAO,mBAAmB,CAAC,SAAS;gBACtC;;QACF;kCAAG,EAAE;IAEL,kEAAkE;IAClE,IAAA,0KAAS;mCAAC;YACR;;YAEA,MAAM;2DAAkB,CAAC;oBACvB,IAAI,EAAE,OAAO,IAAI,EAAE,GAAG,KAAK,SAAS;wBAClC,kFAAkF;wBAClF,EAAE,cAAc;wBAChB,EAAE,eAAe;wBACjB,OAAO,aAAa,CAAC,IAAI,MAAM;oBACjC;gBACF;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YACnC;2CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACrD;kCAAG,EAAE;IAEL,+DAA+D;IAC/D,IAAA,0KAAS;mCAAC;YACR;;YAEA,MAAM;uDAAc,CAAC;oBACnB,IAAI,EAAE,OAAO,IAAI,EAAE,GAAG,CAAC,WAAW,OAAO,KAAK;wBAC5C,qDAAqD;wBACrD,EAAE,cAAc;wBAChB,EAAE,eAAe;wBACjB,EAAE,wBAAwB;wBAE1B,+BAA+B;wBAC/B,OAAO,aAAa,CAAC,IAAI,MAAM;oBACjC;gBACF;;YAEA,+DAA+D;YAC/D,OAAO,gBAAgB,CAAC,WAAW,aAAa;YAChD;2CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW,aAAa;;QAClE;kCAAG,EAAE;IAEL,qBACE,6LAAC,sJAAY;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BAEb,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,4LAAO;wBAAC,MAAM;;;;;;;;;;;8BAIjB,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,6LAAQ;wBAAC,MAAM;wBAAM,SAAS;;;;;;;;;;;;;;;;;;;;;;AAKzC;GA5FwB;KAAA","debugId":null}},
    {"offset": {"line": 2962, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/head.tsx"],"sourcesContent":["import React, { useCallback, memo } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Plus } from \"lucide-react\";\r\nimport { useProductModal } from \"@/contexts/productRegister-context\";\r\n\r\nfunction HeadComponent() {\r\n  const { openModal } = useProductModal();\r\n\r\n  const openAddCategory = useCallback(() => openModal(\"addCategory\"), [openModal]);\r\n  const openAddProduct = useCallback(() => openModal(\"addProduct\"), [openModal]);\r\n\r\n  const btnClass = \"flex items-center justify-center gap-2 p-3\";\r\n\r\n  return (\r\n    <div className=\"flex justify-between items-center\">\r\n      <h1 className=\"text-4xl font-bold\">Products</h1>\r\n\r\n      <div className=\"flex gap-3\">\r\n        <Button className={btnClass} onClick={openAddCategory} aria-label=\"Add category\">\r\n          <Plus size={16} />\r\n          Add Category\r\n        </Button>\r\n\r\n        <Button className={btnClass} onClick={openAddProduct} aria-label=\"Add product\">\r\n          <Plus size={16} />\r\n          Add Product\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default memo(HeadComponent);\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;AAEA,SAAS;;IACP,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,oKAAe;IAErC,MAAM,kBAAkB,IAAA,4KAAW;sDAAC,IAAM,UAAU;qDAAgB;QAAC;KAAU;IAC/E,MAAM,iBAAiB,IAAA,4KAAW;qDAAC,IAAM,UAAU;oDAAe;QAAC;KAAU;IAE7E,MAAM,WAAW;IAEjB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAAqB;;;;;;0BAEnC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,+IAAM;wBAAC,WAAW;wBAAU,SAAS;wBAAiB,cAAW;;0CAChE,6LAAC,6MAAI;gCAAC,MAAM;;;;;;4BAAM;;;;;;;kCAIpB,6LAAC,+IAAM;wBAAC,WAAW;wBAAU,SAAS;wBAAgB,cAAW;;0CAC/D,6LAAC,6MAAI;gCAAC,MAAM;;;;;;4BAAM;;;;;;;;;;;;;;;;;;;AAM5B;GAzBS;;QACe,oKAAe;;;KAD9B;2DA2BM,IAAA,qKAAI,EAAC","debugId":null}},
    {"offset": {"line": 3073, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/ProductStats.tsx"],"sourcesContent":["import { Card, CardContent } from \"@/components/ui/card\";\r\nimport useSWR from \"swr\";\r\nimport { productApi } from \"@/hooks/products/useProductApi\";\r\nimport type { Product } from \"@/hooks/products/useProductApi\";\r\nimport { useMemo } from \"react\";\r\n\r\n// Use consistent key\r\nconst PRODUCTS_KEY = \"products:list\";\r\nconst fetcher = () => productApi.getAll();\r\n\r\nexport default function ProductStats() {\r\n  const { data: products = [], isLoading } = useSWR(PRODUCTS_KEY, fetcher, {\r\n    revalidateOnFocus: false,\r\n    dedupingInterval: 30_000,\r\n  });\r\n\r\n  const stats = useMemo(() => {\r\n    let totalProducts = 0;\r\n    let lowStockItems = 0;\r\n    let outOfStockItems = 0;\r\n    let totalValue = 0;\r\n\r\n    for (const p of products as Product[]) {\r\n      if (!p || typeof p.quantity !== \"number\" || typeof p.price !== \"number\") continue;\r\n      totalProducts++;\r\n      if (p.quantity === 0) outOfStockItems++;\r\n      else if (p.quantity < 5) lowStockItems++;\r\n      totalValue += p.price * p.quantity;\r\n    }\r\n\r\n    return {\r\n      totalProducts,\r\n      lowStockItems,\r\n      outOfStockItems,\r\n      totalValueFormatted: `₱ ${totalValue.toLocaleString(undefined, {\r\n        minimumFractionDigits: 2,\r\n        maximumFractionDigits: 2,\r\n      })}`,\r\n    };\r\n  }, [products]);\r\n\r\n  const statsData = [\r\n    { title: \"Total Products\", content: isLoading ? \"...\" : stats.totalProducts },\r\n    { title: \"Low Stock Items\", content: isLoading ? \"...\" : stats.lowStockItems },\r\n    { title: \"Out of Stock\", content: isLoading ? \"...\" : stats.outOfStockItems },\r\n    { title: \"Total Value\", content: isLoading ? \"...\" : stats.totalValueFormatted },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-4 gap-4 w-full h-full\">\r\n      {statsData.map((stat, idx) => (\r\n        <Card key={idx}>\r\n          <CardContent className=\"flex flex-col justify-center items-start h-full\">\r\n            <h1 className=\"text-xl font-semibold pb-4\">{stat.title}</h1>\r\n            <p className=\"text-2xl font-bold\">{stat.content}</p>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;;AAEA,qBAAqB;AACrB,MAAM,eAAe;AACrB,MAAM,UAAU,IAAM,0JAAU,CAAC,MAAM;AAExB,SAAS;;IACtB,MAAM,EAAE,MAAM,WAAW,EAAE,EAAE,SAAS,EAAE,GAAG,IAAA,4KAAM,EAAC,cAAc,SAAS;QACvE,mBAAmB;QACnB,kBAAkB;IACpB;IAEA,MAAM,QAAQ,IAAA,wKAAO;uCAAC;YACpB,IAAI,gBAAgB;YACpB,IAAI,gBAAgB;YACpB,IAAI,kBAAkB;YACtB,IAAI,aAAa;YAEjB,KAAK,MAAM,KAAK,SAAuB;gBACrC,IAAI,CAAC,KAAK,OAAO,EAAE,QAAQ,KAAK,YAAY,OAAO,EAAE,KAAK,KAAK,UAAU;gBACzE;gBACA,IAAI,EAAE,QAAQ,KAAK,GAAG;qBACjB,IAAI,EAAE,QAAQ,GAAG,GAAG;gBACzB,cAAc,EAAE,KAAK,GAAG,EAAE,QAAQ;YACpC;YAEA,OAAO;gBACL;gBACA;gBACA;gBACA,qBAAqB,AAAC,KAGnB,OAHuB,WAAW,cAAc,CAAC,WAAW;oBAC7D,uBAAuB;oBACvB,uBAAuB;gBACzB;YACF;QACF;sCAAG;QAAC;KAAS;IAEb,MAAM,YAAY;QAChB;YAAE,OAAO;YAAkB,SAAS,YAAY,QAAQ,MAAM,aAAa;QAAC;QAC5E;YAAE,OAAO;YAAmB,SAAS,YAAY,QAAQ,MAAM,aAAa;QAAC;QAC7E;YAAE,OAAO;YAAgB,SAAS,YAAY,QAAQ,MAAM,eAAe;QAAC;QAC5E;YAAE,OAAO;YAAe,SAAS,YAAY,QAAQ,MAAM,mBAAmB;QAAC;KAChF;IAED,qBACE,6LAAC;QAAI,WAAU;kBACZ,UAAU,GAAG,CAAC,CAAC,MAAM,oBACpB,6LAAC,2IAAI;0BACH,cAAA,6LAAC,kJAAW;oBAAC,WAAU;;sCACrB,6LAAC;4BAAG,WAAU;sCAA8B,KAAK,KAAK;;;;;;sCACtD,6LAAC;4BAAE,WAAU;sCAAsB,KAAK,OAAO;;;;;;;;;;;;eAHxC;;;;;;;;;;AASnB;GAlDwB;;QACqB,4KAAM;;;KAD3B","debugId":null}},
    {"offset": {"line": 3195, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Select({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\r\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\r\n}\r\n\r\nfunction SelectGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\r\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\r\n}\r\n\r\nfunction SelectValue({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\r\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\r\n}\r\n\r\nfunction SelectTrigger({\r\n  className,\r\n  size = \"default\",\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\r\n  size?: \"sm\" | \"default\"\r\n}) {\r\n  return (\r\n    <SelectPrimitive.Trigger\r\n      data-slot=\"select-trigger\"\r\n      data-size={size}\r\n      className={cn(\r\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <SelectPrimitive.Icon asChild>\r\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\r\n      </SelectPrimitive.Icon>\r\n    </SelectPrimitive.Trigger>\r\n  )\r\n}\r\n\r\nfunction SelectContent({\r\n  className,\r\n  children,\r\n  position = \"popper\",\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        data-slot=\"select-content\"\r\n        className={cn(\r\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction SelectLabel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\r\n  return (\r\n    <SelectPrimitive.Label\r\n      data-slot=\"select-label\"\r\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectItem({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\r\n  return (\r\n    <SelectPrimitive.Item\r\n      data-slot=\"select-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\r\n        <SelectPrimitive.ItemIndicator>\r\n          <CheckIcon className=\"size-4\" />\r\n        </SelectPrimitive.ItemIndicator>\r\n      </span>\r\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n    </SelectPrimitive.Item>\r\n  )\r\n}\r\n\r\nfunction SelectSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\r\n  return (\r\n    <SelectPrimitive.Separator\r\n      data-slot=\"select-separator\"\r\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectScrollUpButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollUpButton\r\n      data-slot=\"select-scroll-up-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronUpIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollUpButton>\r\n  )\r\n}\r\n\r\nfunction SelectScrollDownButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollDownButton\r\n      data-slot=\"select-scroll-down-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronDownIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollDownButton>\r\n  )\r\n}\r\n\r\nexport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectScrollDownButton,\r\n  SelectScrollUpButton,\r\n  SelectSeparator,\r\n  SelectTrigger,\r\n  SelectValue,\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3462, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/productCatalog/ProductCatalogToolbar.tsx"],"sourcesContent":["import { Input } from \"@/components/ui/input\";\r\nimport { Search } from \"lucide-react\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Funnel } from \"lucide-react\";\r\nimport { useCategories } from \"@/hooks/global/fetching/useCategories\";\r\nimport { useState, useMemo, useCallback } from \"react\";\r\n\r\ninterface ProductCatalogToolbarProps {\r\n  selectedCategory: string;\r\n  setSelectedCategory: (category: string) => void;\r\n  selectedProducts: string;\r\n  setSelectedProducts: (products: string) => void;\r\n  search: string;\r\n  setSearch: (s: string) => void;\r\n}\r\n\r\nexport default function ProductCatalogToolbar({\r\n  selectedCategory,\r\n  setSelectedCategory,\r\n  selectedProducts,\r\n  setSelectedProducts,\r\n  search,\r\n  setSearch,\r\n}: ProductCatalogToolbarProps) {\r\n  const { categories, loading: categoriesLoading, error: categoriesError } = useCategories();\r\n  const [categorySearch, setCategorySearch] = useState(\"\");\r\n\r\n  const handleReset = useCallback(() => {\r\n    setSelectedCategory(\"all\");\r\n    setSelectedProducts(\"all\");\r\n    setCategorySearch(\"\");\r\n    setSearch(\"\");\r\n  }, [setSelectedCategory, setSelectedProducts, setSearch]);\r\n\r\n  const onSearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearch(e.target.value);\r\n  }, [setSearch]);\r\n\r\n  const onCategorySearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setCategorySearch(e.target.value);\r\n  }, []);\r\n\r\n  const filteredCategories = useMemo(() => {\r\n    const list = categories ?? [];\r\n    const q = categorySearch.trim().toLowerCase();\r\n    return q ? list.filter((c) => c.name.toLowerCase().includes(q)) : list;\r\n  }, [categories, categorySearch]);\r\n\r\n  const onCategoryChange = useCallback(\r\n    (val: string) => {\r\n      setSelectedCategory(val);\r\n    },\r\n    [setSelectedCategory]\r\n  );\r\n\r\n  const onProductsChange = useCallback(\r\n    (val: string) => {\r\n      setSelectedProducts(val);\r\n    },\r\n    [setSelectedProducts]\r\n  );\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-between gap-4\">\r\n      <div className=\"relative flex items-center flex-1 max-w-[700px]\">\r\n        <Search className=\"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400\" size={20} />\r\n        <Input\r\n          className=\"pl-9 w-full\"\r\n          placeholder=\"Search by product name or barcode...\"\r\n          value={search}\r\n          onChange={onSearchChange}\r\n          onClick={(e) => e.stopPropagation()}\r\n        />\r\n      </div>\r\n\r\n      <DropdownMenu>\r\n        <DropdownMenuTrigger asChild>\r\n          <Button variant=\"outline\" className=\"flex items-center gap-2\">\r\n            <Funnel />\r\n            Filter\r\n          </Button>\r\n        </DropdownMenuTrigger>\r\n\r\n        <DropdownMenuContent className=\"w-[320px]\">\r\n          <div className=\"p-3\">\r\n            <h3 className=\"text-sm font-medium\">Filter</h3>\r\n          </div>\r\n          <DropdownMenuSeparator />\r\n\r\n          <div className=\"p-3\">\r\n            <h4 className=\"text-sm font-medium\">Category</h4>\r\n            <Select value={selectedCategory} onValueChange={onCategoryChange}>\r\n              <SelectTrigger className=\"w-full mt-2\">\r\n                <SelectValue placeholder=\"Category\" />\r\n              </SelectTrigger>\r\n\r\n              <SelectContent>\r\n                <div className=\"p-2\">\r\n                  <Input\r\n                    placeholder=\"Search category...\"\r\n                    value={categorySearch}\r\n                    onChange={onCategorySearchChange}\r\n                    className=\"mb-2\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"max-h-40 overflow-auto\">\r\n                  <SelectItem value=\"all\">All Categories</SelectItem>\r\n\r\n                  {categoriesLoading && <SelectItem value=\"loading\" disabled>Loading categories...</SelectItem>}\r\n                  {categoriesError && <SelectItem value=\"error\" disabled>{String(categoriesError)}</SelectItem>}\r\n\r\n                  {!categoriesLoading && !categoriesError && filteredCategories.length === 0 && (\r\n                    <SelectItem value=\"none\" disabled>No categories found</SelectItem>\r\n                  )}\r\n\r\n                  {!categoriesLoading && !categoriesError &&\r\n                    filteredCategories.map((cat) => (\r\n                      <SelectItem key={cat.id} value={String(cat.id)}>\r\n                        {cat.name}\r\n                      </SelectItem>\r\n                    ))}\r\n                </div>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <DropdownMenuSeparator />\r\n\r\n          <div className=\"p-3\">\r\n            <h4 className=\"text-sm font-medium\">Status</h4>\r\n            <Select value={selectedProducts} onValueChange={onProductsChange}>\r\n              <SelectTrigger className=\"w-full mt-2\">\r\n                <SelectValue placeholder=\"Status\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Stock</SelectItem>\r\n                <SelectItem value=\"in stock\">In Stock</SelectItem>\r\n                <SelectItem value=\"low stock\">Low Stock</SelectItem>\r\n                <SelectItem value=\"out of stock\">Out of Stock</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <DropdownMenuSeparator />\r\n\r\n          <div className=\"flex justify-end p-3\">\r\n            <Button variant=\"ghost\" className=\"font-normal\" onClick={handleReset}>\r\n              Reset All\r\n            </Button>\r\n          </div>\r\n        </DropdownMenuContent>\r\n      </DropdownMenu>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3879, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/table/dataTable.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport {\r\n  ColumnDef,\r\n  flexRender,\r\n  getCoreRowModel,\r\n  getSortedRowModel,\r\n  useReactTable,\r\n  SortingState,\r\n} from \"@tanstack/react-table\"\r\nimport { useState, useEffect, useRef, useMemo } from \"react\"\r\n\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\"\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[]\r\n  data: TData[]\r\n  page: number\r\n  pageSize: number\r\n  onFilteredCountChange?: (count: number) => void\r\n}\r\n\r\nexport function DataTable<TData, TValue>({\r\n  columns,\r\n  data,\r\n  page,\r\n  pageSize,\r\n  onFilteredCountChange,\r\n}: DataTableProps<TData, TValue>) {\r\n  const [sorting, setSorting] = useState<SortingState>([])\r\n\r\n  // create the table instance (react-table hook internally memoizes heavy parts)\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    state: { sorting, pagination: { pageIndex: page } as any },\r\n    onSortingChange: setSorting,\r\n    // keep pagination control outside of react-table to avoid internal pageIndex churn\r\n    onPaginationChange: (() => { }) as any,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    getSortedRowModel: getSortedRowModel(),\r\n  })\r\n\r\n  // derived rows and paginated rows (memoized to avoid extra work on unrelated renders)\r\n  const rows = table.getRowModel().rows\r\n  const paginatedRows = useMemo(\r\n    () => rows.slice(page * pageSize, (page + 1) * pageSize),\r\n    [rows, page, pageSize]\r\n  )\r\n\r\n  // notify parent of filtered/sorted count with a deferred callback to avoid sync updates\r\n  const prevCountRef = useRef<number | null>(null)\r\n  const notifyTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null)\r\n  const rowCount = rows.length\r\n\r\n  useEffect(() => {\r\n    if (!onFilteredCountChange) return\r\n\r\n    if (prevCountRef.current !== rowCount) {\r\n      prevCountRef.current = rowCount\r\n\r\n      if (notifyTimerRef.current) {\r\n        clearTimeout(notifyTimerRef.current)\r\n        notifyTimerRef.current = null\r\n      }\r\n\r\n      // defer notification so parent state updates don't run synchronously here\r\n      notifyTimerRef.current = setTimeout(() => {\r\n        onFilteredCountChange(rowCount)\r\n        notifyTimerRef.current = null\r\n      }, 0)\r\n    }\r\n\r\n    return () => {\r\n      if (notifyTimerRef.current) {\r\n        clearTimeout(notifyTimerRef.current)\r\n        notifyTimerRef.current = null\r\n      }\r\n    }\r\n  }, [rowCount, onFilteredCountChange])\r\n\r\n  return (\r\n    <div className=\"rounded-md border\">\r\n      <Table>\r\n        <TableHeader>\r\n          {table.getHeaderGroups().map((headerGroup) => (\r\n            <TableRow key={headerGroup.id}>\r\n              {headerGroup.headers.map((header) => (\r\n                <TableHead key={header.id}>\r\n                  {header.isPlaceholder ? null : flexRender(header.column.columnDef.header, header.getContext())}\r\n                </TableHead>\r\n              ))}\r\n            </TableRow>\r\n          ))}\r\n        </TableHeader>\r\n\r\n        <TableBody>\r\n          {paginatedRows.length > 0 ? (\r\n            paginatedRows.map((row) => (\r\n              <TableRow key={row.id} data-state={row.getIsSelected() ? \"selected\" : undefined}>\r\n                {row.getVisibleCells().map((cell) => (\r\n                  <TableCell key={cell.id} className=\"align-top break-words whitespace-normal\">\r\n                    {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                  </TableCell>\r\n                ))}\r\n              </TableRow>\r\n            ))\r\n          ) : (\r\n            <TableRow>\r\n              <TableCell colSpan={columns.length} className=\"h-24 text-center\">\r\n                No results.\r\n              </TableCell>\r\n            </TableRow>\r\n          )}\r\n        </TableBody>\r\n      </Table>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAQA;AAEA;;;AAZA;;;;AA6BO,SAAS,UAAyB,KAMT;QANS,EACvC,OAAO,EACP,IAAI,EACJ,IAAI,EACJ,QAAQ,EACR,qBAAqB,EACS,GANS;;IAOvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAe,EAAE;IAEvD,+EAA+E;IAC/E,MAAM,QAAQ,IAAA,0MAAa,EAAC;QAC1B;QACA;QACA,OAAO;YAAE;YAAS,YAAY;gBAAE,WAAW;YAAK;QAAS;QACzD,iBAAiB;QACjB,mFAAmF;QACnF,kBAAkB;8CAAG,KAAQ;;QAC7B,iBAAiB,AADG,IACH,2LAAe,AADF;QAE9B,mBAAmB,IAAA,6LAAiB;IACtC;IAEA,sFAAsF;IACtF,MAAM,OAAO,MAAM,WAAW,GAAG,IAAI;IACrC,MAAM,gBAAgB,IAAA,wKAAO;4CAC3B,IAAM,KAAK,KAAK,CAAC,OAAO,UAAU,CAAC,OAAO,CAAC,IAAI;2CAC/C;QAAC;QAAM;QAAM;KAAS;IAGxB,wFAAwF;IACxF,MAAM,eAAe,IAAA,uKAAM,EAAgB;IAC3C,MAAM,iBAAiB,IAAA,uKAAM,EAAuC;IACpE,MAAM,WAAW,KAAK,MAAM;IAE5B,IAAA,0KAAS;+BAAC;YACR,IAAI,CAAC,uBAAuB;YAE5B,IAAI,aAAa,OAAO,KAAK,UAAU;gBACrC,aAAa,OAAO,GAAG;gBAEvB,IAAI,eAAe,OAAO,EAAE;oBAC1B,aAAa,eAAe,OAAO;oBACnC,eAAe,OAAO,GAAG;gBAC3B;gBAEA,0EAA0E;gBAC1E,eAAe,OAAO,GAAG;2CAAW;wBAClC,sBAAsB;wBACtB,eAAe,OAAO,GAAG;oBAC3B;0CAAG;YACL;YAEA;uCAAO;oBACL,IAAI,eAAe,OAAO,EAAE;wBAC1B,aAAa,eAAe,OAAO;wBACnC,eAAe,OAAO,GAAG;oBAC3B;gBACF;;QACF;8BAAG;QAAC;QAAU;KAAsB;IAEpC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,6IAAK;;8BACJ,6LAAC,mJAAW;8BACT,MAAM,eAAe,GAAG,GAAG,CAAC,CAAC,4BAC5B,6LAAC,gJAAQ;sCACN,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC,uBACxB,6LAAC,iJAAS;8CACP,OAAO,aAAa,GAAG,OAAO,IAAA,uMAAU,EAAC,OAAO,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,UAAU;mCAD7E,OAAO,EAAE;;;;;2BAFd,YAAY,EAAE;;;;;;;;;;8BAUjC,6LAAC,iJAAS;8BACP,cAAc,MAAM,GAAG,IACtB,cAAc,GAAG,CAAC,CAAC,oBACjB,6LAAC,gJAAQ;4BAAc,cAAY,IAAI,aAAa,KAAK,aAAa;sCACnE,IAAI,eAAe,GAAG,GAAG,CAAC,CAAC,qBAC1B,6LAAC,iJAAS;oCAAe,WAAU;8CAChC,IAAA,uMAAU,EAAC,KAAK,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,UAAU;mCADzC,KAAK,EAAE;;;;;2BAFZ,IAAI,EAAE;;;;kDASvB,6LAAC,gJAAQ;kCACP,cAAA,6LAAC,iJAAS;4BAAC,SAAS,QAAQ,MAAM;4BAAE,WAAU;sCAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS/E;GAhGgB;;QAUA,0MAAa;;;KAVb","debugId":null}},
    {"offset": {"line": 4044, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"span\"> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"span\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,KAM6C;QAN7C,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD,GAN7C;IAOb,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS","debugId":null}},
    {"offset": {"line": 4097, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/table/columns.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { ColumnDef } from \"@tanstack/react-table\";\r\nimport { ArrowUpDown } from \"lucide-react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\n\r\nexport type Products = {\r\n  id: string;\r\n  productName: string;\r\n  barcode: string;\r\n  category: string;\r\n  currentStock: number;\r\n  productPrice: number;\r\n  status: \"out of stock\" | \"low stock\" | \"in stock\";\r\n  original?: any;\r\n};\r\n\r\nconst statusConfig: Record<\r\n  Products[\"status\"],\r\n  { variant: \"default\" | \"outline\" | \"secondary\" | \"destructive\"; className: string }\r\n> = {\r\n  \"in stock\": { variant: \"default\", className: \"bg-green-300 text-black\" },\r\n  \"low stock\": { variant: \"secondary\", className: \"bg-yellow-500 text-black\" },\r\n  \"out of stock\": { variant: \"destructive\", className: \"bg-red-500 text-white\" },\r\n};\r\n\r\nexport const columns: ColumnDef<Products>[] = [\r\n  {\r\n    accessorKey: \"productName\",\r\n    header: ({ column }) => (\r\n      <button\r\n        className=\"flex items-center gap-2 font-medium focus:outline-none\"\r\n        onClick={() => column.toggleSorting(column.getIsSorted() === \"asc\")}\r\n      >\r\n        Product\r\n        <ArrowUpDown className=\"ml-1 h-4 w-4\" />\r\n      </button>\r\n    ),\r\n    cell: ({ row }) => (\r\n      <div className=\"flex w-full\">\r\n        <div\r\n          className=\"flex-1 flex flex-col items-start font-medium break-words whitespace-normal leading-tight\"\r\n          title={String(row.getValue(\"productName\"))}\r\n          style={{ wordBreak: \"break-word\", whiteSpace: \"normal\" }}\r\n        >\r\n          {row.getValue(\"productName\")}\r\n        </div>\r\n      </div>\r\n    ),\r\n  },\r\n  {\r\n    accessorKey: \"barcode\",\r\n    header: \"Barcode\",\r\n  },\r\n  {\r\n    accessorKey: \"category\",\r\n    header: \"Category\",\r\n  },\r\n  {\r\n    accessorKey: \"currentStock\",\r\n    header: ({ column }) => (\r\n      <button\r\n        className=\"flex items-center gap-2 font-medium focus:outline-none\"\r\n        onClick={() => column.toggleSorting(column.getIsSorted() === \"asc\")}\r\n      >\r\n        Current Stock\r\n        <ArrowUpDown className=\"ml-1 h-4 w-4\" />\r\n      </button>\r\n    ),\r\n    cell: ({ row }) => <div className=\"flex items-center font-medium\">{row.getValue(\"currentStock\")}</div>,\r\n  },\r\n  {\r\n    accessorKey: \"productPrice\",\r\n    header: \"Price\",\r\n  },\r\n  {\r\n    accessorKey: \"status\",\r\n    header: \"Status\",\r\n    cell: ({ row }) => {\r\n      const status = row.original.status;\r\n      const cfg = statusConfig[status];\r\n      const label = status.charAt(0).toUpperCase() + status.slice(1);\r\n      return (\r\n        <Badge variant={cfg.variant} className={cfg.className}>\r\n          {label}\r\n        </Badge>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    id: \"actions\",\r\n    header: () => <div className=\"text-center font-medium\">Actions</div>,\r\n    // leave actions cell empty here — table parent can provide the real handlers to avoid duplicate button code and reduce bundle\r\n    cell: () => <div className=\"flex gap-5 justify-center\" aria-hidden />,\r\n    enableSorting: false,\r\n    enableHiding: false,\r\n  },\r\n];\r\n//"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAiBA,MAAM,eAGF;IACF,YAAY;QAAE,SAAS;QAAW,WAAW;IAA0B;IACvE,aAAa;QAAE,SAAS;QAAa,WAAW;IAA2B;IAC3E,gBAAgB;QAAE,SAAS;QAAe,WAAW;IAAwB;AAC/E;AAEO,MAAM,UAAiC;IAC5C;QACE,aAAa;QACb,QAAQ;gBAAC,EAAE,MAAM,EAAE;iCACjB,6LAAC;gBACC,WAAU;gBACV,SAAS,IAAM,OAAO,aAAa,CAAC,OAAO,WAAW,OAAO;;oBAC9D;kCAEC,6LAAC,0OAAW;wBAAC,WAAU;;;;;;;;;;;;;QAG3B,MAAM;gBAAC,EAAE,GAAG,EAAE;iCACZ,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,WAAU;oBACV,OAAO,OAAO,IAAI,QAAQ,CAAC;oBAC3B,OAAO;wBAAE,WAAW;wBAAc,YAAY;oBAAS;8BAEtD,IAAI,QAAQ,CAAC;;;;;;;;;;;;IAItB;IACA;QACE,aAAa;QACb,QAAQ;IACV;IACA;QACE,aAAa;QACb,QAAQ;IACV;IACA;QACE,aAAa;QACb,QAAQ;gBAAC,EAAE,MAAM,EAAE;iCACjB,6LAAC;gBACC,WAAU;gBACV,SAAS,IAAM,OAAO,aAAa,CAAC,OAAO,WAAW,OAAO;;oBAC9D;kCAEC,6LAAC,0OAAW;wBAAC,WAAU;;;;;;;;;;;;;QAG3B,MAAM;gBAAC,EAAE,GAAG,EAAE;iCAAK,6LAAC;gBAAI,WAAU;0BAAiC,IAAI,QAAQ,CAAC;;;;;;;IAClF;IACA;QACE,aAAa;QACb,QAAQ;IACV;IACA;QACE,aAAa;QACb,QAAQ;QACR,MAAM;gBAAC,EAAE,GAAG,EAAE;YACZ,MAAM,SAAS,IAAI,QAAQ,CAAC,MAAM;YAClC,MAAM,MAAM,YAAY,CAAC,OAAO;YAChC,MAAM,QAAQ,OAAO,MAAM,CAAC,GAAG,WAAW,KAAK,OAAO,KAAK,CAAC;YAC5D,qBACE,6LAAC,6IAAK;gBAAC,SAAS,IAAI,OAAO;gBAAE,WAAW,IAAI,SAAS;0BAClD;;;;;;QAGP;IACF;IACA;QACE,IAAI;QACJ,QAAQ,kBAAM,6LAAC;gBAAI,WAAU;0BAA0B;;;;;;QACvD,8HAA8H;QAC9H,MAAM,kBAAM,6LAAC;gBAAI,WAAU;gBAA4B,aAAW;;;;;;QAClE,eAAe;QACf,cAAc;IAChB;CACD,EACD,EAAE","debugId":null}},
    {"offset": {"line": 4266, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/pagination.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport {\r\n  ChevronLeftIcon,\r\n  ChevronRightIcon,\r\n  MoreHorizontalIcon,\r\n} from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Button, buttonVariants } from \"@/components/ui/button\"\r\n\r\nfunction Pagination({ className, ...props }: React.ComponentProps<\"nav\">) {\r\n  return (\r\n    <nav\r\n      role=\"navigation\"\r\n      aria-label=\"pagination\"\r\n      data-slot=\"pagination\"\r\n      className={cn(\"mx-auto flex w-full justify-center\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction PaginationContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"ul\">) {\r\n  return (\r\n    <ul\r\n      data-slot=\"pagination-content\"\r\n      className={cn(\"flex flex-row items-center gap-1\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction PaginationItem({ ...props }: React.ComponentProps<\"li\">) {\r\n  return <li data-slot=\"pagination-item\" {...props} />\r\n}\r\n\r\ntype PaginationLinkProps = {\r\n  isActive?: boolean\r\n} & Pick<React.ComponentProps<typeof Button>, \"size\"> &\r\n  React.ComponentProps<\"a\">\r\n\r\nfunction PaginationLink({\r\n  className,\r\n  isActive,\r\n  size = \"icon\",\r\n  ...props\r\n}: PaginationLinkProps) {\r\n  return (\r\n    <a\r\n      aria-current={isActive ? \"page\" : undefined}\r\n      data-slot=\"pagination-link\"\r\n      data-active={isActive}\r\n      className={cn(\r\n        buttonVariants({\r\n          variant: isActive ? \"outline\" : \"ghost\",\r\n          size,\r\n        }),\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction PaginationPrevious({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof PaginationLink>) {\r\n  return (\r\n    <PaginationLink\r\n      aria-label=\"Go to previous page\"\r\n      size=\"default\"\r\n      className={cn(\"gap-1 px-2.5 sm:pl-2.5\", className)}\r\n      {...props}\r\n    >\r\n      <ChevronLeftIcon />\r\n      <span className=\"hidden sm:block\">Previous</span>\r\n    </PaginationLink>\r\n  )\r\n}\r\n\r\nfunction PaginationNext({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof PaginationLink>) {\r\n  return (\r\n    <PaginationLink\r\n      aria-label=\"Go to next page\"\r\n      size=\"default\"\r\n      className={cn(\"gap-1 px-2.5 sm:pr-2.5\", className)}\r\n      {...props}\r\n    >\r\n      <span className=\"hidden sm:block\">Next</span>\r\n      <ChevronRightIcon />\r\n    </PaginationLink>\r\n  )\r\n}\r\n\r\nfunction PaginationEllipsis({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"span\">) {\r\n  return (\r\n    <span\r\n      aria-hidden\r\n      data-slot=\"pagination-ellipsis\"\r\n      className={cn(\"flex size-9 items-center justify-center\", className)}\r\n      {...props}\r\n    >\r\n      <MoreHorizontalIcon className=\"size-4\" />\r\n      <span className=\"sr-only\">More pages</span>\r\n    </span>\r\n  )\r\n}\r\n\r\nexport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationLink,\r\n  PaginationItem,\r\n  PaginationPrevious,\r\n  PaginationNext,\r\n  PaginationEllipsis,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AACA;AAAA;AAAA;AAMA;AACA;;;;;AAEA,SAAS,WAAW,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IAClB,qBACE,6LAAC;QACC,MAAK;QACL,cAAW;QACX,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;KAVS;AAYT,SAAS,kBAAkB,KAGE;QAHF,EACzB,SAAS,EACT,GAAG,OACwB,GAHF;IAIzB,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,oCAAoC;QACjD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,eAAe,KAAwC;QAAxC,EAAE,GAAG,OAAmC,GAAxC;IACtB,qBAAO,6LAAC;QAAG,aAAU;QAAmB,GAAG,KAAK;;;;;;AAClD;MAFS;AAST,SAAS,eAAe,KAKF;QALE,EACtB,SAAS,EACT,QAAQ,EACR,OAAO,MAAM,EACb,GAAG,OACiB,GALE;IAMtB,qBACE,6LAAC;QACC,gBAAc,WAAW,SAAS;QAClC,aAAU;QACV,eAAa;QACb,WAAW,IAAA,4HAAE,EACX,IAAA,uJAAc,EAAC;YACb,SAAS,WAAW,YAAY;YAChC;QACF,IACA;QAED,GAAG,KAAK;;;;;;AAGf;MArBS;AAuBT,SAAS,mBAAmB,KAGkB;QAHlB,EAC1B,SAAS,EACT,GAAG,OACyC,GAHlB;IAI1B,qBACE,6LAAC;QACC,cAAW;QACX,MAAK;QACL,WAAW,IAAA,4HAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;0BAET,6LAAC,8OAAe;;;;;0BAChB,6LAAC;gBAAK,WAAU;0BAAkB;;;;;;;;;;;;AAGxC;MAfS;AAiBT,SAAS,eAAe,KAGsB;QAHtB,EACtB,SAAS,EACT,GAAG,OACyC,GAHtB;IAItB,qBACE,6LAAC;QACC,cAAW;QACX,MAAK;QACL,WAAW,IAAA,4HAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BAAkB;;;;;;0BAClC,6LAAC,iPAAgB;;;;;;;;;;;AAGvB;MAfS;AAiBT,SAAS,mBAAmB,KAGG;QAHH,EAC1B,SAAS,EACT,GAAG,OAC0B,GAHH;IAI1B,qBACE,6LAAC;QACC,aAAW;QACX,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;0BAET,6LAAC,6OAAkB;gBAAC,WAAU;;;;;;0BAC9B,6LAAC;gBAAK,WAAU;0BAAU;;;;;;;;;;;;AAGhC;MAfS","debugId":null}},
    {"offset": {"line": 4455, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/productCatalog/Pagination.tsx"],"sourcesContent":["import {\r\n    Pagination as PaginationRoot,\r\n    PaginationContent,\r\n    PaginationItem,\r\n    PaginationPrevious,\r\n    PaginationNext,\r\n    PaginationEllipsis,\r\n    PaginationLink\r\n} from \"@/components/ui/pagination\";\r\n\r\ntype PaginationProps = {\r\n    page: number;\r\n    pageCount: number;\r\n    setPage: (page: number) => void;\r\n    pageSize: number;\r\n    onPageSizeChange: (size: number) => void;\r\n};\r\n\r\nexport default function Pagination({ page, pageCount, setPage, pageSize, onPageSizeChange }: PaginationProps) {\r\n    if (pageCount <= 1) {\r\n        // nothing to paginate\r\n        return null;\r\n    }\r\n\r\n    const go = (p: number) => (e?: React.MouseEvent) => {\r\n        e?.preventDefault();\r\n        if (p < 0) p = 0;\r\n        if (p > pageCount - 1) p = pageCount - 1;\r\n        if (p !== page) setPage(p);\r\n    };\r\n\r\n    // build a compact page list: always show first and last, and a window around current page\r\n    const buildPages = () => {\r\n        const pages: (number | \"ellipsis\")[] = [];\r\n        const left = Math.max(1, page - 1);\r\n        const right = Math.min(pageCount - 2, page + 1);\r\n\r\n        pages.push(0); // first page\r\n\r\n        if (left > 1) pages.push(\"ellipsis\");\r\n\r\n        for (let i = left; i <= right; i++) {\r\n            pages.push(i);\r\n        }\r\n\r\n        if (right < pageCount - 2) pages.push(\"ellipsis\");\r\n\r\n        if (pageCount > 1) pages.push(pageCount - 1); // last page\r\n\r\n        return pages;\r\n    };\r\n\r\n    const pages = buildPages();\r\n\r\n    return (\r\n        <PaginationRoot className=\"mt-2 flex items-center gap-4\">\r\n            <PaginationContent>\r\n                <PaginationItem>\r\n                    <PaginationPrevious\r\n                        href=\"#\"\r\n                        onClick={go(Math.max(page - 1, 0))}\r\n                        aria-disabled={page === 0}\r\n                    />\r\n                </PaginationItem>\r\n\r\n                {pages.map((p, idx) =>\r\n                    p === \"ellipsis\" ? (\r\n                        <PaginationItem key={`e-${idx}`}>\r\n                            <PaginationEllipsis />\r\n                        </PaginationItem>\r\n                    ) : (\r\n                        <PaginationItem key={p}>\r\n                            <PaginationLink\r\n                                href=\"#\"\r\n                                isActive={p === page}\r\n                                onClick={go(p)}\r\n                            >\r\n                                {p + 1}\r\n                            </PaginationLink>\r\n                        </PaginationItem>\r\n                    )\r\n                )}\r\n\r\n                <PaginationItem>\r\n                    <PaginationNext\r\n                        href=\"#\"\r\n                        onClick={go(Math.min(page + 1, pageCount - 1))}\r\n                        aria-disabled={page === pageCount - 1}\r\n                    />\r\n                </PaginationItem>\r\n            </PaginationContent>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n                <label htmlFor=\"page-size\" className=\"text-sm\">Rows per page:</label>\r\n                <input\r\n                    id=\"page-size\"\r\n                    type=\"number\"\r\n                    min={1}\r\n                    max={100}\r\n                    value={pageSize}\r\n                    onChange={e => onPageSizeChange(Number(e.target.value) || 1)}\r\n                    className=\"border rounded px-2 py-1 w-16 text-sm\"\r\n                />\r\n            </div>\r\n        </PaginationRoot>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;;;AAkBe,SAAS,WAAW,KAAyE;QAAzE,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAE,gBAAgB,EAAmB,GAAzE;IAC/B,IAAI,aAAa,GAAG;QAChB,sBAAsB;QACtB,OAAO;IACX;IAEA,MAAM,KAAK,CAAC,IAAc,CAAC;YACvB,cAAA,wBAAA,EAAG,cAAc;YACjB,IAAI,IAAI,GAAG,IAAI;YACf,IAAI,IAAI,YAAY,GAAG,IAAI,YAAY;YACvC,IAAI,MAAM,MAAM,QAAQ;QAC5B;IAEA,0FAA0F;IAC1F,MAAM,aAAa;QACf,MAAM,QAAiC,EAAE;QACzC,MAAM,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;QAChC,MAAM,QAAQ,KAAK,GAAG,CAAC,YAAY,GAAG,OAAO;QAE7C,MAAM,IAAI,CAAC,IAAI,aAAa;QAE5B,IAAI,OAAO,GAAG,MAAM,IAAI,CAAC;QAEzB,IAAK,IAAI,IAAI,MAAM,KAAK,OAAO,IAAK;YAChC,MAAM,IAAI,CAAC;QACf;QAEA,IAAI,QAAQ,YAAY,GAAG,MAAM,IAAI,CAAC;QAEtC,IAAI,YAAY,GAAG,MAAM,IAAI,CAAC,YAAY,IAAI,YAAY;QAE1D,OAAO;IACX;IAEA,MAAM,QAAQ;IAEd,qBACI,6LAAC,uJAAc;QAAC,WAAU;;0BACtB,6LAAC,8JAAiB;;kCACd,6LAAC,2JAAc;kCACX,cAAA,6LAAC,+JAAkB;4BACf,MAAK;4BACL,SAAS,GAAG,KAAK,GAAG,CAAC,OAAO,GAAG;4BAC/B,iBAAe,SAAS;;;;;;;;;;;oBAI/B,MAAM,GAAG,CAAC,CAAC,GAAG,MACX,MAAM,2BACF,6LAAC,2JAAc;sCACX,cAAA,6LAAC,+JAAkB;;;;;2BADF,AAAC,KAAQ,OAAJ;;;;iDAI1B,6LAAC,2JAAc;sCACX,cAAA,6LAAC,2JAAc;gCACX,MAAK;gCACL,UAAU,MAAM;gCAChB,SAAS,GAAG;0CAEX,IAAI;;;;;;2BANQ;;;;;kCAY7B,6LAAC,2JAAc;kCACX,cAAA,6LAAC,2JAAc;4BACX,MAAK;4BACL,SAAS,GAAG,KAAK,GAAG,CAAC,OAAO,GAAG,YAAY;4BAC3C,iBAAe,SAAS,YAAY;;;;;;;;;;;;;;;;;0BAKhD,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAM,SAAQ;wBAAY,WAAU;kCAAU;;;;;;kCAC/C,6LAAC;wBACG,IAAG;wBACH,MAAK;wBACL,KAAK;wBACL,KAAK;wBACL,OAAO;wBACP,UAAU,CAAA,IAAK,iBAAiB,OAAO,EAAE,MAAM,CAAC,KAAK,KAAK;wBAC1D,WAAU;;;;;;;;;;;;;;;;;;AAK9B;KAxFwB","debugId":null}},
    {"offset": {"line": 4605, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/productCatalog/ProductTable.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState, useMemo, useCallback, useEffect } from \"react\";\r\nimport useSWR, { mutate } from \"swr\";\r\nimport { DataTable } from \"../../table/dataTable\";\r\nimport { columns, Products } from \"../../table/columns\";\r\nimport Pagination from \"./Pagination\";\r\nimport { productApi, Product } from \"@/hooks/products/useProductApi\";\r\nimport { useCategories } from \"@/hooks/global/fetching/useCategories\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Pencil, Trash2, ChevronDown } from \"lucide-react\";\r\nimport { showSuccessToast, showErrorToast } from \"@/utils/toast\";\r\n\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogClose,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\n\r\n// Use consistent key\r\nconst PRODUCTS_KEY = \"products:list\";\r\nconst fetcher = () => productApi.getAll();\r\nconst PAGE_SIZE = 6;\r\n\r\n// Memoize row mapping function\r\nconst mapProductToRow = (product: Product, categoryMap: Map<string, string>): Products => {\r\n    const status = product.quantity === 0 ? \"out of stock\" : product.quantity < 5 ? \"low stock\" : \"in stock\";\r\n    const categoryName = categoryMap.get(String(product.category_id)) || `Category ${product.category_id}`;\r\n\r\n    return {\r\n        id: String(product.id),\r\n        productName: product.name,\r\n        barcode: product.barcode ?? \"\",\r\n        category: categoryName,\r\n        currentStock: product.quantity,\r\n        productPrice: product.price,\r\n        status,\r\n    };\r\n};\r\n\r\ntype ProductTableProps = {\r\n    selectedCategory: string;\r\n    selectedStatus: string;\r\n    onProductDeleted?: (id: number) => void;\r\n    search?: string;\r\n};\r\n\r\nexport default function ProductTable({\r\n    selectedCategory,\r\n    selectedStatus,\r\n    onProductDeleted,\r\n    search = \"\",\r\n}: ProductTableProps) {\r\n    const { data: products = [], isLoading, mutate: refetchProducts } = useSWR(PRODUCTS_KEY, fetcher, {\r\n        revalidateOnFocus: false,\r\n        revalidateOnReconnect: true,\r\n        dedupingInterval: 10_000,\r\n        errorRetryCount: 2,\r\n    });\r\n\r\n    const { categories = [] } = useCategories();\r\n\r\n    // Create category map for faster lookups\r\n    const categoryMap = useMemo(() => {\r\n        const map = new Map<string, string>();\r\n        categories.forEach(cat => map.set(String(cat.id), cat.name));\r\n        return map;\r\n    }, [categories]);\r\n\r\n    const [page, setPage] = useState(0);\r\n    const [pageSize, setPageSize] = useState(PAGE_SIZE);\r\n    const [editProductId, setEditProductId] = useState<number | null>(null);\r\n    const [showEditDialog, setShowEditDialog] = useState(false);\r\n    const [showUpdateConfirm, setShowUpdateConfirm] = useState(false);\r\n    const [deleteProduct, setDeleteProduct] = useState<Products | null>(null);\r\n    const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n    const [categorySearch, setCategorySearch] = useState(\"\");\r\n\r\n    const [editForm, setEditForm] = useState({\r\n        name: \"\",\r\n        barcode: \"\",\r\n        category_id: \"\",\r\n        price: 0,\r\n        quantity: 0,\r\n        unit: \"pcs\", // Change to lowercase\r\n    });\r\n\r\n    // Optimized filtering with useMemo\r\n    const filteredProducts = useMemo(() => {\r\n        let list: Product[] = products;\r\n\r\n        // Early return if no filters\r\n        if (selectedCategory === \"all\" && selectedStatus === \"all\" && !search.trim()) {\r\n            return list;\r\n        }\r\n\r\n        if (selectedCategory !== \"all\") {\r\n            list = list.filter((p) => String(p.category_id) === selectedCategory);\r\n        }\r\n\r\n        if (selectedStatus !== \"all\") {\r\n            list = list.filter((p) => {\r\n                const status = p.quantity === 0 ? \"out of stock\" : p.quantity < 5 ? \"low stock\" : \"in stock\";\r\n                return status === selectedStatus;\r\n            });\r\n        }\r\n\r\n        const searchTerm = search.trim().toLowerCase();\r\n        if (searchTerm) {\r\n            list = list.filter((p) => {\r\n                const name = p.name?.toLowerCase() || \"\";\r\n                const barcode = p.barcode?.toLowerCase() || \"\";\r\n                return name.includes(searchTerm) || barcode.includes(searchTerm);\r\n            });\r\n        }\r\n\r\n        return list;\r\n    }, [products, selectedCategory, selectedStatus, search]);\r\n\r\n    // Memoize mapped products\r\n    const mappedProducts = useMemo(\r\n        () => filteredProducts.map((p) => mapProductToRow(p, categoryMap)),\r\n        [filteredProducts, categoryMap]\r\n    );\r\n\r\n    // Reset page when filters change\r\n    useEffect(() => setPage(0), [selectedCategory, selectedStatus, search]);\r\n\r\n    const pageCount = Math.max(1, Math.ceil(mappedProducts.length / pageSize));\r\n\r\n    const editProduct = useMemo(\r\n        () => products.find((p) => p.id === editProductId),\r\n        [products, editProductId]\r\n    );\r\n\r\n    // Sync edit form\r\n    useEffect(() => {\r\n        if (showEditDialog && editProduct) {\r\n            setEditForm({\r\n                name: editProduct.name || \"\",\r\n                barcode: editProduct.barcode || \"\",\r\n                category_id: String(editProduct.category_id || \"\"),\r\n                price: editProduct.price || 0,\r\n                quantity: editProduct.quantity || 0,\r\n                unit: editProduct.unit || \"pcs\", // Change to lowercase\r\n            });\r\n        }\r\n    }, [showEditDialog, editProduct]);\r\n\r\n    const handleEdit = useCallback((row: Products) => {\r\n        setEditProductId(Number(row.id));\r\n        setShowEditDialog(true);\r\n        setShowUpdateConfirm(false);\r\n    }, []);\r\n\r\n    const handleDelete = useCallback((row: Products) => {\r\n        setDeleteProduct(row);\r\n        setShowDeleteDialog(true);\r\n    }, []);\r\n\r\n    const handleUpdateProduct = useCallback(async () => {\r\n        if (!editProduct) return;\r\n\r\n        const updatedData = {\r\n            name: editForm.name,\r\n            barcode: editForm.barcode,\r\n            category_id: Number(editForm.category_id),\r\n            price: Number(editForm.price),\r\n            quantity: Number(editForm.quantity),\r\n            unit: editForm.unit, // Add unit field\r\n        };\r\n\r\n        try {\r\n            // Optimistic update\r\n            const optimisticProduct = { ...editProduct, ...updatedData };\r\n\r\n            mutate(\r\n                PRODUCTS_KEY,\r\n                (current: Product[] = []) =>\r\n                    current.map(p => p.id === editProduct.id ? optimisticProduct : p),\r\n                false\r\n            );\r\n\r\n            await productApi.update(Number(editProduct.id), updatedData);\r\n\r\n            showSuccessToast(\"Product updated\", `${editForm.name} has been updated.`);\r\n\r\n            setShowEditDialog(false);\r\n            setShowUpdateConfirm(false);\r\n\r\n            // Final revalidation\r\n            mutate(PRODUCTS_KEY);\r\n\r\n        } catch (err: any) {\r\n            // Revert on error\r\n            mutate(PRODUCTS_KEY);\r\n            showErrorToast(\"Failed to update product\", err?.message || \"An error occurred.\");\r\n        }\r\n    }, [editProduct, editForm]);\r\n\r\n    const handleDeleteProduct = useCallback(async () => {\r\n        if (!deleteProduct) return;\r\n\r\n        const productId = Number(deleteProduct.id);\r\n\r\n        try {\r\n            // Optimistic update\r\n            mutate(\r\n                PRODUCTS_KEY,\r\n                (current: Product[] = []) => current.filter(p => p.id !== productId),\r\n                false\r\n            );\r\n\r\n            await productApi.delete(productId);\r\n\r\n            showSuccessToast(\"Product deleted\", `${deleteProduct.productName} has been deleted.`);\r\n\r\n            setShowDeleteDialog(false);\r\n            setDeleteProduct(null);\r\n            onProductDeleted?.(productId);\r\n\r\n            // Final revalidation\r\n            mutate(PRODUCTS_KEY);\r\n\r\n        } catch (err: any) {\r\n            // Revert on error\r\n            mutate(PRODUCTS_KEY);\r\n            showErrorToast(\"Failed to delete product\", err?.message || \"An error occurred.\");\r\n        }\r\n    }, [deleteProduct, onProductDeleted]);\r\n\r\n    // Enhanced columns with actions\r\n    const enhancedColumns = useMemo(() =>\r\n        columns.map((col) =>\r\n            col.id === \"actions\"\r\n                ? {\r\n                    ...col,\r\n                    cell: ({ row }: any) => (\r\n                        <div className=\"flex gap-2 justify-center\">\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                size=\"icon\"\r\n                                onClick={() => handleEdit(row.original)}\r\n                                disabled={isLoading}\r\n                            >\r\n                                <Pencil className=\"w-4 h-4\" />\r\n                            </Button>\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                size=\"icon\"\r\n                                onClick={() => handleDelete(row.original)}\r\n                                disabled={isLoading}\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                            </Button>\r\n                        </div>\r\n                    ),\r\n                }\r\n                : col\r\n        ), [handleEdit, handleDelete, isLoading]);\r\n\r\n    return (\r\n        <div className=\"w-full mt-4 relative\">\r\n            {isLoading && (\r\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-blue-200 z-10\">\r\n                    <div className=\"h-full bg-blue-500 animate-pulse\"></div>\r\n                </div>\r\n            )}\r\n\r\n            <DataTable\r\n                columns={enhancedColumns}\r\n                data={mappedProducts}\r\n                page={page}\r\n                pageSize={pageSize}\r\n            />\r\n\r\n            <div className=\"mt-7\">\r\n                <Pagination\r\n                    page={page}\r\n                    pageCount={pageCount}\r\n                    setPage={setPage}\r\n                    pageSize={pageSize}\r\n                    onPageSizeChange={(size) => {\r\n                        setPageSize(size);\r\n                        setPage(0);\r\n                    }}\r\n                />\r\n            </div>\r\n\r\n            {/* Edit Dialog */}\r\n            <Dialog open={showEditDialog} onOpenChange={setShowEditDialog}>\r\n                <DialogContent>\r\n                    {showUpdateConfirm ? (\r\n                        <div className=\"flex flex-col items-center justify-center py-8\">\r\n                            <h2 className=\"font-bold text-lg mb-2\">Are you absolutely sure?</h2>\r\n                            <p className=\"mb-6 text-gray-500\">This will update the product details.</p>\r\n                            <div className=\"flex gap-2\">\r\n                                <Button variant=\"outline\" onClick={() => setShowUpdateConfirm(false)}>\r\n                                    Cancel\r\n                                </Button>\r\n                                <Button onClick={handleUpdateProduct}>Continue</Button>\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <DialogHeader>\r\n                                <DialogTitle>Edit Product</DialogTitle>\r\n                                <DialogDescription>Update product details below.</DialogDescription>\r\n                            </DialogHeader>\r\n\r\n                            <div className=\"flex flex-col gap-4\">\r\n                                <div className=\"flex flex-col gap-2\">\r\n                                    <Label htmlFor=\"edit-name\">Product Name</Label>\r\n                                    <Input\r\n                                        id=\"edit-name\"\r\n                                        value={editForm.name}\r\n                                        onChange={(e) => setEditForm(f => ({ ...f, name: e.target.value }))}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-2\">\r\n                                    <div className=\"flex-1 flex flex-col gap-2\">\r\n                                        <Label htmlFor=\"edit-barcode\">Barcode</Label>\r\n                                        <Input\r\n                                            id=\"edit-barcode\"\r\n                                            value={editForm.barcode}\r\n                                            onChange={(e) => setEditForm(f => ({ ...f, barcode: e.target.value }))}\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"flex-1 flex flex-col gap-2\">\r\n                                        <Label htmlFor=\"edit-category\">Category</Label>\r\n                                        <DropdownMenu>\r\n                                            <DropdownMenuTrigger asChild>\r\n                                                <Input\r\n                                                    readOnly\r\n                                                    value={categoryMap.get(editForm.category_id) || \"\"}\r\n                                                    placeholder=\"Select category\"\r\n                                                    className=\"cursor-pointer\"\r\n                                                />\r\n                                            </DropdownMenuTrigger>\r\n                                            <DropdownMenuContent>\r\n                                                {categories.map((cat) => (\r\n                                                    <DropdownMenuItem\r\n                                                        key={cat.id}\r\n                                                        onClick={() => setEditForm(f => ({ ...f, category_id: String(cat.id) }))}\r\n                                                    >\r\n                                                        {cat.name}\r\n                                                    </DropdownMenuItem>\r\n                                                ))}\r\n                                            </DropdownMenuContent>\r\n                                        </DropdownMenu>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-2\">\r\n                                    <div className=\"flex-1 flex flex-col gap-2\">\r\n                                        <Label htmlFor=\"edit-price\">Price</Label>\r\n                                        <div className=\"relative\">\r\n                                            <span className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\">₱</span>\r\n                                            <Input\r\n                                                id=\"edit-price\"\r\n                                                type=\"number\"\r\n                                                value={editForm.price || \"\"}\r\n                                                onChange={(e) => setEditForm(f => ({ ...f, price: Number(e.target.value) || 0 }))}\r\n                                                className=\"pl-8\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex-1 flex flex-col gap-2\">\r\n                                        <Label htmlFor=\"edit-quantity\">Quantity</Label>\r\n                                        <Input\r\n                                            id=\"edit-quantity\"\r\n                                            type=\"number\"\r\n                                            value={editForm.quantity || \"\"}\r\n                                            onChange={(e) => setEditForm(f => ({ ...f, quantity: Number(e.target.value) || 0 }))}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex flex-col gap-2\">\r\n                                    <Label htmlFor=\"edit-unit\">Unit</Label>\r\n                                    <DropdownMenu>\r\n                                        <DropdownMenuTrigger asChild>\r\n                                            <Button \r\n                                                variant=\"outline\" \r\n                                                className=\"w-full justify-between\"\r\n                                            >\r\n                                                {editForm.unit === \"pcs\" ? \"pcs (pieces)\" : \r\n                                                 editForm.unit === \"kg\" ? \"kg (kilogram)\" : \r\n                                                 editForm.unit === \"pck\" ? \"pck (pack)\" : \"pcs (pieces)\"}\r\n                                                <ChevronDown className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                        </DropdownMenuTrigger>\r\n                                        <DropdownMenuContent align=\"start\" className=\"w-full\">\r\n                                            <DropdownMenuItem\r\n                                                onClick={() => setEditForm(f => ({ ...f, unit: \"pcs\" }))}\r\n                                            >\r\n                                                pcs (pieces)\r\n                                            </DropdownMenuItem>\r\n                                            <DropdownMenuItem\r\n                                                onClick={() => setEditForm(f => ({ ...f, unit: \"kg\" }))}\r\n                                            >\r\n                                                kg (kilogram)\r\n                                            </DropdownMenuItem>\r\n                                            <DropdownMenuItem\r\n                                                onClick={() => setEditForm(f => ({ ...f, unit: \"pck\" }))}\r\n                                            >\r\n                                                pck (pack)\r\n                                            </DropdownMenuItem>\r\n                                        </DropdownMenuContent>\r\n                                    </DropdownMenu>\r\n                                </div>\r\n\r\n                                <DialogFooter>\r\n                                    <Button variant=\"outline\" onClick={() => setShowEditDialog(false)}>\r\n                                        Cancel\r\n                                    </Button>\r\n                                    <Button onClick={() => setShowUpdateConfirm(true)}>\r\n                                        Update Product\r\n                                    </Button>\r\n                                </DialogFooter>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n                </DialogContent>\r\n            </Dialog>\r\n\r\n            {/* Delete Dialog */}\r\n            <Dialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n                <DialogContent>\r\n                    <DialogHeader>\r\n                        <DialogTitle>Are you absolutely sure?</DialogTitle>\r\n                        <DialogDescription>\r\n                            This action cannot be undone. This will permanently delete the product.\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    <DialogFooter>\r\n                        <Button variant=\"outline\" onClick={() => setShowDeleteDialog(false)}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button variant=\"destructive\" onClick={handleDeleteProduct}>\r\n                            Continue\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5499, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/components/productCatalog/index.tsx"],"sourcesContent":["import { Card, CardContent, CardHeader } from \"@/components/ui/card\";\r\nimport ProductCatalogToolbar from \"./ProductCatalogToolbar\";\r\nimport ProductTable from \"./ProductTable\";\r\nimport { useState } from \"react\";\r\n\r\ninterface IndexProps {\r\n  onProductDeleted?: (id: number) => void;\r\n}\r\n\r\nexport default function Index({ onProductDeleted }: IndexProps) {\r\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\r\n  const [selectedProducts, setSelectedProducts] = useState(\"all\");\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  return (\r\n    <Card className=\"h-full w-full\">\r\n      <CardHeader>\r\n        <h2 className=\"text-2xl font-semibold\">Product Catalog</h2>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <ProductCatalogToolbar\r\n          selectedCategory={selectedCategory}\r\n          setSelectedCategory={setSelectedCategory}\r\n          selectedProducts={selectedProducts}\r\n          setSelectedProducts={setSelectedProducts}\r\n          search={search}\r\n          setSearch={setSearch}\r\n        />\r\n        <ProductTable\r\n          selectedCategory={selectedCategory}\r\n          selectedStatus={selectedProducts}\r\n          onProductDeleted={onProductDeleted}\r\n          search={search}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;AAMe,SAAS,MAAM,KAAgC;QAAhC,EAAE,gBAAgB,EAAc,GAAhC;;IAC5B,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,qBACE,6LAAC,2IAAI;QAAC,WAAU;;0BACd,6LAAC,iJAAU;0BACT,cAAA,6LAAC;oBAAG,WAAU;8BAAyB;;;;;;;;;;;0BAEzC,6LAAC,kJAAW;;kCACV,6LAAC,qNAAqB;wBACpB,kBAAkB;wBAClB,qBAAqB;wBACrB,kBAAkB;wBAClB,qBAAqB;wBACrB,QAAQ;wBACR,WAAW;;;;;;kCAEb,6LAAC,4MAAY;wBACX,kBAAkB;wBAClB,gBAAgB;wBAChB,kBAAkB;wBAClB,QAAQ;;;;;;;;;;;;;;;;;;AAKlB;GA5BwB;KAAA","debugId":null}},
    {"offset": {"line": 5585, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Products/productsScreen.tsx"],"sourcesContent":["'use client'\r\n\r\nimport Head from './components/head';\r\nimport ProductsStats from './components/ProductStats';\r\nimport Index from './components/productCatalog/index';\r\nimport AddCategoryModal from './components/addCategoryModal';\r\n\r\nexport default function ProductsScreen() {\r\n  return (\r\n    <div className=\"flex flex-col gap-4 h-full p-8\">\r\n      <div className=\"flex-[7%]\">\r\n        <Head />\r\n      </div>\r\n\r\n      <div className=\"flex-[18%]\">\r\n        <ProductsStats />\r\n      </div>\r\n\r\n      <div className=\"flex-[75%]\">\r\n        <Index />\r\n      </div>\r\n\r\n      <AddCategoryModal />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,kLAAI;;;;;;;;;;0BAGP,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,0LAAa;;;;;;;;;;0BAGhB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,qMAAK;;;;;;;;;;0BAGR,6LAAC,8LAAgB;;;;;;;;;;;AAGvB;KAlBwB","debugId":null}},
    {"offset": {"line": 5662, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/global/fetching/useSaleItems.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"@/lib/axios\";\r\n\r\nexport interface AggregatedSaleItem {\r\n  category: string;\r\n  quantity: number;\r\n}\r\n\r\n/**\r\n * Hook for fetching aggregated sale items by category.\r\n * Accepts optional { from, to } ISO date strings.\r\n */\r\nexport const useSaleItems = (opts?: { from?: string; to?: string }) => {\r\n  const [saleItems, setSaleItems] = useState<AggregatedSaleItem[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchSaleItems = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const params = new URLSearchParams();\r\n      params.set(\"limit\", \"all\");\r\n      if (opts?.from) params.set(\"from\", opts.from);\r\n      if (opts?.to) params.set(\"to\", opts.to);\r\n\r\n      const url = `/sales-items?${params.toString()}`;\r\n      const res = await axios.get(url);\r\n\r\n      const payload = res.data;\r\n      setSaleItems(Array.isArray(payload) ? payload : payload?.data ?? []);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : \"Unknown error\");\r\n      setSaleItems([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSaleItems();\r\n  }, [opts?.from, opts?.to]);\r\n\r\n  return { saleItems, loading, error, refetch: fetchSaleItems };\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAWO,MAAM,eAAe,CAAC;;IAC3B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAuB,EAAE;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,iBAAiB;QACrB,IAAI;YACF,WAAW;YACX,SAAS;YAET,MAAM,SAAS,IAAI;YACnB,OAAO,GAAG,CAAC,SAAS;YACpB,IAAI,iBAAA,2BAAA,KAAM,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,KAAK,IAAI;YAC5C,IAAI,iBAAA,2BAAA,KAAM,EAAE,EAAE,OAAO,GAAG,CAAC,MAAM,KAAK,EAAE;YAEtC,MAAM,MAAM,AAAC,gBAAiC,OAAlB,OAAO,QAAQ;YAC3C,MAAM,MAAM,MAAM,iIAAK,CAAC,GAAG,CAAC;YAE5B,MAAM,UAAU,IAAI,IAAI;gBACwB;YAAhD,aAAa,MAAM,OAAO,CAAC,WAAW,UAAU,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB,EAAE;QACrE,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAC9C,aAAa,EAAE;QACjB,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR;QACF;iCAAG;QAAC,iBAAA,2BAAA,KAAM,IAAI;QAAE,iBAAA,2BAAA,KAAM,EAAE;KAAC;IAEzB,OAAO;QAAE;QAAW;QAAS;QAAO,SAAS;IAAe;AAC9D;GAjCa","debugId":null}},
    {"offset": {"line": 5719, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/global/fetching/useSales.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"@/lib/axios\";\r\n\r\nexport interface Sale {\r\n  id: number;\r\n  customer_id: number | null;\r\n  total_purchase: number;\r\n  created_at: string;\r\n}\r\n\r\ninterface UseSalesParams {\r\n  from?: string;\r\n  to?: string;\r\n}\r\n\r\nexport const useSales = (params?: UseSalesParams) => {\r\n  const [sales, setSales] = useState<Sale[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchSales = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const res = await axios.get(\"/sales\", {\r\n        params: {\r\n          from: params?.from,\r\n          to: params?.to,\r\n        },\r\n      });\r\n\r\n      setSales(res.data.data || []);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : \"Unknown error\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSales();\r\n  }, [params?.from, params?.to]);\r\n\r\n  return { sales, loading, error, refetch: fetchSales };\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAcO,MAAM,WAAW,CAAC;;IACvB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAS,EAAE;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,aAAa;QACjB,IAAI;YACF,WAAW;YACX,SAAS;YAET,MAAM,MAAM,MAAM,iIAAK,CAAC,GAAG,CAAC,UAAU;gBACpC,QAAQ;oBACN,IAAI,EAAE,mBAAA,6BAAA,OAAQ,IAAI;oBAClB,EAAE,EAAE,mBAAA,6BAAA,OAAQ,EAAE;gBAChB;YACF;YAEA,SAAS,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE;QAC9B,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;8BAAC;YACR;QACF;6BAAG;QAAC,mBAAA,6BAAA,OAAQ,IAAI;QAAE,mBAAA,6BAAA,OAAQ,EAAE;KAAC;IAE7B,OAAO;QAAE;QAAO;QAAS;QAAO,SAAS;IAAW;AACtD;GA9Ba","debugId":null}},
    {"offset": {"line": 5773, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Dashboard/components/stats.tsx"],"sourcesContent":["// Stats.tsx\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { DollarSign, Package, ShoppingCart } from \"lucide-react\";\r\nimport { useSaleItems } from \"@/hooks/global/fetching/useSaleItems\";\r\nimport { useProducts } from \"@/hooks/global/fetching/useProducts\";\r\nimport { useSales } from \"@/hooks/global/fetching/useSales\";\r\nfunction getCalendarDayRange() {\r\n    const now = new Date();\r\n\r\n    const start = new Date(now);\r\n    start.setHours(0, 0, 0, 0); // 12:00 AM\r\n\r\n    const end = new Date(now);\r\n    end.setHours(23, 59, 59, 999); // 11:59 PM\r\n\r\n    return { from: start.toISOString(), to: end.toISOString() };\r\n}\r\n\r\nexport default function Stats() {\r\n    const { products = [], loading: productsLoading } = useProducts();\r\n\r\n    const { from, to } = getCalendarDayRange();\r\n\r\n    const { sales = [], loading: salesLoading } = useSales({ from, to });\r\n    const { saleItems: todaysSaleItems = [], loading: saleItemsLoading } =\r\n        useSaleItems({ from, to });\r\n\r\n    const todaysSales = sales.reduce((sum, sale) => sum + sale.total_purchase, 0);\r\n    const todaysTransactions = sales.length;\r\n    const itemsSoldToday = todaysSaleItems.reduce(\r\n        (sum, item) => sum + (Number(item.quantity) || 0),\r\n        0\r\n    );\r\n\r\n    const statsData = [\r\n        {\r\n            title: \"Today's Sales\",\r\n            content: salesLoading ? \"...\" : `₱ ${todaysSales.toLocaleString()}`,\r\n            icon: <DollarSign size={20} />,\r\n        },\r\n        {\r\n            title: \"Items Sold Today\",\r\n            content: saleItemsLoading ? \"...\" : itemsSoldToday.toLocaleString(),\r\n            icon: <Package size={20} />,\r\n        },\r\n        {\r\n            title: \"Today's Transactions\",\r\n            content: salesLoading ? \"...\" : todaysTransactions.toLocaleString(),\r\n            icon: <ShoppingCart size={20} />,\r\n        },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"grid grid-cols-3 gap-4 w-full h-full\">\r\n            {statsData.map((stat, idx) => (\r\n                <Card key={idx} className=\"gap-0 flex justify-center\">\r\n                    <CardHeader className=\"mb-4 flex flex-row justify-between items-center\">\r\n                        <CardTitle className=\"text-md font-semibold\">\r\n                            {stat.title}\r\n                        </CardTitle>\r\n                        <div className=\"opacity-60\">{stat.icon}</div>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-3xl font-bold mb-6\">{stat.content}</div>\r\n                    </CardContent>\r\n                </Card>\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,YAAY;;;;;;AACZ;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;AACA,SAAS;IACL,MAAM,MAAM,IAAI;IAEhB,MAAM,QAAQ,IAAI,KAAK;IACvB,MAAM,QAAQ,CAAC,GAAG,GAAG,GAAG,IAAI,WAAW;IAEvC,MAAM,MAAM,IAAI,KAAK;IACrB,IAAI,QAAQ,CAAC,IAAI,IAAI,IAAI,MAAM,WAAW;IAE1C,OAAO;QAAE,MAAM,MAAM,WAAW;QAAI,IAAI,IAAI,WAAW;IAAG;AAC9D;AAEe,SAAS;;IACpB,MAAM,EAAE,WAAW,EAAE,EAAE,SAAS,eAAe,EAAE,GAAG,IAAA,mKAAW;IAE/D,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG;IAErB,MAAM,EAAE,QAAQ,EAAE,EAAE,SAAS,YAAY,EAAE,GAAG,IAAA,6JAAQ,EAAC;QAAE;QAAM;IAAG;IAClE,MAAM,EAAE,WAAW,kBAAkB,EAAE,EAAE,SAAS,gBAAgB,EAAE,GAChE,IAAA,qKAAY,EAAC;QAAE;QAAM;IAAG;IAE5B,MAAM,cAAc,MAAM,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,cAAc,EAAE;IAC3E,MAAM,qBAAqB,MAAM,MAAM;IACvC,MAAM,iBAAiB,gBAAgB,MAAM,CACzC,CAAC,KAAK,OAAS,MAAM,CAAC,OAAO,KAAK,QAAQ,KAAK,CAAC,GAChD;IAGJ,MAAM,YAAY;QACd;YACI,OAAO;YACP,SAAS,eAAe,QAAQ,AAAC,KAAiC,OAA7B,YAAY,cAAc;YAC/D,oBAAM,6LAAC,mOAAU;gBAAC,MAAM;;;;;;QAC5B;QACA;YACI,OAAO;YACP,SAAS,mBAAmB,QAAQ,eAAe,cAAc;YACjE,oBAAM,6LAAC,sNAAO;gBAAC,MAAM;;;;;;QACzB;QACA;YACI,OAAO;YACP,SAAS,eAAe,QAAQ,mBAAmB,cAAc;YACjE,oBAAM,6LAAC,yOAAY;gBAAC,MAAM;;;;;;QAC9B;KACH;IAED,qBACI,6LAAC;QAAI,WAAU;kBACV,UAAU,GAAG,CAAC,CAAC,MAAM,oBAClB,6LAAC,2IAAI;gBAAW,WAAU;;kCACtB,6LAAC,iJAAU;wBAAC,WAAU;;0CAClB,6LAAC,gJAAS;gCAAC,WAAU;0CAChB,KAAK,KAAK;;;;;;0CAEf,6LAAC;gCAAI,WAAU;0CAAc,KAAK,IAAI;;;;;;;;;;;;kCAE1C,6LAAC,kJAAW;kCACR,cAAA,6LAAC;4BAAI,WAAU;sCAA2B,KAAK,OAAO;;;;;;;;;;;;eARnD;;;;;;;;;;AAc3B;GAnDwB;;QACgC,mKAAW;QAIjB,6JAAQ;QAElD,qKAAY;;;KAPI","debugId":null}},
    {"offset": {"line": 5927, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/calendar.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport {\r\n  ChevronDownIcon,\r\n  ChevronLeftIcon,\r\n  ChevronRightIcon,\r\n} from \"lucide-react\"\r\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Button, buttonVariants } from \"@/components/ui/button\"\r\n\r\nfunction Calendar({\r\n  className,\r\n  classNames,\r\n  showOutsideDays = true,\r\n  captionLayout = \"label\",\r\n  buttonVariant = \"ghost\",\r\n  formatters,\r\n  components,\r\n  ...props\r\n}: React.ComponentProps<typeof DayPicker> & {\r\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\r\n}) {\r\n  const defaultClassNames = getDefaultClassNames()\r\n\r\n  return (\r\n    <DayPicker\r\n      showOutsideDays={showOutsideDays}\r\n      className={cn(\r\n        \"bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\r\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\r\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\r\n        className\r\n      )}\r\n      captionLayout={captionLayout}\r\n      formatters={{\r\n        formatMonthDropdown: (date) =>\r\n          date.toLocaleString(\"default\", { month: \"short\" }),\r\n        ...formatters,\r\n      }}\r\n      classNames={{\r\n        root: cn(\"w-fit\", defaultClassNames.root),\r\n        months: cn(\r\n          \"flex gap-4 flex-col md:flex-row relative\",\r\n          defaultClassNames.months\r\n        ),\r\n        month: cn(\"flex flex-col w-full gap-4\", defaultClassNames.month),\r\n        nav: cn(\r\n          \"flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between\",\r\n          defaultClassNames.nav\r\n        ),\r\n        button_previous: cn(\r\n          buttonVariants({ variant: buttonVariant }),\r\n          \"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none\",\r\n          defaultClassNames.button_previous\r\n        ),\r\n        button_next: cn(\r\n          buttonVariants({ variant: buttonVariant }),\r\n          \"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none\",\r\n          defaultClassNames.button_next\r\n        ),\r\n        month_caption: cn(\r\n          \"flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)\",\r\n          defaultClassNames.month_caption\r\n        ),\r\n        dropdowns: cn(\r\n          \"w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5\",\r\n          defaultClassNames.dropdowns\r\n        ),\r\n        dropdown_root: cn(\r\n          \"relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md\",\r\n          defaultClassNames.dropdown_root\r\n        ),\r\n        dropdown: cn(\r\n          \"absolute bg-popover inset-0 opacity-0\",\r\n          defaultClassNames.dropdown\r\n        ),\r\n        caption_label: cn(\r\n          \"select-none font-medium\",\r\n          captionLayout === \"label\"\r\n            ? \"text-sm\"\r\n            : \"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5\",\r\n          defaultClassNames.caption_label\r\n        ),\r\n        table: \"w-full border-collapse\",\r\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\r\n        weekday: cn(\r\n          \"text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none\",\r\n          defaultClassNames.weekday\r\n        ),\r\n        week: cn(\"flex w-full mt-2\", defaultClassNames.week),\r\n        week_number_header: cn(\r\n          \"select-none w-(--cell-size)\",\r\n          defaultClassNames.week_number_header\r\n        ),\r\n        week_number: cn(\r\n          \"text-[0.8rem] select-none text-muted-foreground\",\r\n          defaultClassNames.week_number\r\n        ),\r\n        day: cn(\r\n          \"relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none\",\r\n          defaultClassNames.day\r\n        ),\r\n        range_start: cn(\r\n          \"rounded-l-md bg-accent\",\r\n          defaultClassNames.range_start\r\n        ),\r\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\r\n        range_end: cn(\"rounded-r-md bg-accent\", defaultClassNames.range_end),\r\n        today: cn(\r\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\r\n          defaultClassNames.today\r\n        ),\r\n        outside: cn(\r\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\r\n          defaultClassNames.outside\r\n        ),\r\n        disabled: cn(\r\n          \"text-muted-foreground opacity-50\",\r\n          defaultClassNames.disabled\r\n        ),\r\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\r\n        ...classNames,\r\n      }}\r\n      components={{\r\n        Root: ({ className, rootRef, ...props }) => {\r\n          return (\r\n            <div\r\n              data-slot=\"calendar\"\r\n              ref={rootRef}\r\n              className={cn(className)}\r\n              {...props}\r\n            />\r\n          )\r\n        },\r\n        Chevron: ({ className, orientation, ...props }) => {\r\n          if (orientation === \"left\") {\r\n            return (\r\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\r\n            )\r\n          }\r\n\r\n          if (orientation === \"right\") {\r\n            return (\r\n              <ChevronRightIcon\r\n                className={cn(\"size-4\", className)}\r\n                {...props}\r\n              />\r\n            )\r\n          }\r\n\r\n          return (\r\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\r\n          )\r\n        },\r\n        DayButton: CalendarDayButton,\r\n        WeekNumber: ({ children, ...props }) => {\r\n          return (\r\n            <td {...props}>\r\n              <div className=\"flex size-(--cell-size) items-center justify-center text-center\">\r\n                {children}\r\n              </div>\r\n            </td>\r\n          )\r\n        },\r\n        ...components,\r\n      }}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CalendarDayButton({\r\n  className,\r\n  day,\r\n  modifiers,\r\n  ...props\r\n}: React.ComponentProps<typeof DayButton>) {\r\n  const defaultClassNames = getDefaultClassNames()\r\n\r\n  const ref = React.useRef<HTMLButtonElement>(null)\r\n  React.useEffect(() => {\r\n    if (modifiers.focused) ref.current?.focus()\r\n  }, [modifiers.focused])\r\n\r\n  return (\r\n    <Button\r\n      ref={ref}\r\n      variant=\"ghost\"\r\n      size=\"icon\"\r\n      data-day={day.date.toLocaleDateString()}\r\n      data-selected-single={\r\n        modifiers.selected &&\r\n        !modifiers.range_start &&\r\n        !modifiers.range_end &&\r\n        !modifiers.range_middle\r\n      }\r\n      data-range-start={modifiers.range_start}\r\n      data-range-end={modifiers.range_end}\r\n      data-range-middle={modifiers.range_middle}\r\n      className={cn(\r\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70\",\r\n        defaultClassNames.day,\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Calendar, CalendarDayButton }\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/chart.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as RechartsPrimitive from \"recharts\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\n// Format: { THEME_NAME: CSS_SELECTOR }\r\nconst THEMES = { light: \"\", dark: \".dark\" } as const\r\n\r\nexport type ChartConfig = {\r\n  [k in string]: {\r\n    label?: React.ReactNode\r\n    icon?: React.ComponentType\r\n  } & (\r\n    | { color?: string; theme?: never }\r\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\r\n  )\r\n}\r\n\r\ntype ChartContextProps = {\r\n  config: ChartConfig\r\n}\r\n\r\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\r\n\r\nfunction useChart() {\r\n  const context = React.useContext(ChartContext)\r\n\r\n  if (!context) {\r\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\r\n  }\r\n\r\n  return context\r\n}\r\n\r\nfunction ChartContainer({\r\n  id,\r\n  className,\r\n  children,\r\n  config,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  config: ChartConfig\r\n  children: React.ComponentProps<\r\n    typeof RechartsPrimitive.ResponsiveContainer\r\n  >[\"children\"]\r\n}) {\r\n  const uniqueId = React.useId()\r\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\r\n\r\n  return (\r\n    <ChartContext.Provider value={{ config }}>\r\n      <div\r\n        data-slot=\"chart\"\r\n        data-chart={chartId}\r\n        className={cn(\r\n          \"[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        <ChartStyle id={chartId} config={config} />\r\n        <RechartsPrimitive.ResponsiveContainer>\r\n          {children}\r\n        </RechartsPrimitive.ResponsiveContainer>\r\n      </div>\r\n    </ChartContext.Provider>\r\n  )\r\n}\r\n\r\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\r\n  const colorConfig = Object.entries(config).filter(\r\n    ([, config]) => config.theme || config.color\r\n  )\r\n\r\n  if (!colorConfig.length) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <style\r\n      dangerouslySetInnerHTML={{\r\n        __html: Object.entries(THEMES)\r\n          .map(\r\n            ([theme, prefix]) => `\r\n${prefix} [data-chart=${id}] {\r\n${colorConfig\r\n  .map(([key, itemConfig]) => {\r\n    const color =\r\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\r\n      itemConfig.color\r\n    return color ? `  --color-${key}: ${color};` : null\r\n  })\r\n  .join(\"\\n\")}\r\n}\r\n`\r\n          )\r\n          .join(\"\\n\"),\r\n      }}\r\n    />\r\n  )\r\n}\r\n\r\nconst ChartTooltip = RechartsPrimitive.Tooltip\r\n\r\nfunction ChartTooltipContent({\r\n  active,\r\n  payload,\r\n  className,\r\n  indicator = \"dot\",\r\n  hideLabel = false,\r\n  hideIndicator = false,\r\n  label,\r\n  labelFormatter,\r\n  labelClassName,\r\n  formatter,\r\n  color,\r\n  nameKey,\r\n  labelKey,\r\n}: React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\r\n  React.ComponentProps<\"div\"> & {\r\n    hideLabel?: boolean\r\n    hideIndicator?: boolean\r\n    indicator?: \"line\" | \"dot\" | \"dashed\"\r\n    nameKey?: string\r\n    labelKey?: string\r\n  }) {\r\n  const { config } = useChart()\r\n\r\n  const tooltipLabel = React.useMemo(() => {\r\n    if (hideLabel || !payload?.length) {\r\n      return null\r\n    }\r\n\r\n    const [item] = payload\r\n    const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\r\n    const itemConfig = getPayloadConfigFromPayload(config, item, key)\r\n    const value =\r\n      !labelKey && typeof label === \"string\"\r\n        ? config[label as keyof typeof config]?.label || label\r\n        : itemConfig?.label\r\n\r\n    if (labelFormatter) {\r\n      return (\r\n        <div className={cn(\"font-medium\", labelClassName)}>\r\n          {labelFormatter(value, payload)}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (!value) {\r\n      return null\r\n    }\r\n\r\n    return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\r\n  }, [\r\n    label,\r\n    labelFormatter,\r\n    payload,\r\n    hideLabel,\r\n    labelClassName,\r\n    config,\r\n    labelKey,\r\n  ])\r\n\r\n  if (!active || !payload?.length) {\r\n    return null\r\n  }\r\n\r\n  const nestLabel = payload.length === 1 && indicator !== \"dot\"\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl\",\r\n        className\r\n      )}\r\n    >\r\n      {!nestLabel ? tooltipLabel : null}\r\n      <div className=\"grid gap-1.5\">\r\n        {payload.map((item, index) => {\r\n          const key = `${nameKey || item.name || item.dataKey || \"value\"}`\r\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\r\n          const indicatorColor = color || item.payload.fill || item.color\r\n\r\n          return (\r\n            <div\r\n              key={item.dataKey}\r\n              className={cn(\r\n                \"[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5\",\r\n                indicator === \"dot\" && \"items-center\"\r\n              )}\r\n            >\r\n              {formatter && item?.value !== undefined && item.name ? (\r\n                formatter(item.value, item.name, item, index, item.payload)\r\n              ) : (\r\n                <>\r\n                  {itemConfig?.icon ? (\r\n                    <itemConfig.icon />\r\n                  ) : (\r\n                    !hideIndicator && (\r\n                      <div\r\n                        className={cn(\r\n                          \"shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)\",\r\n                          {\r\n                            \"h-2.5 w-2.5\": indicator === \"dot\",\r\n                            \"w-1\": indicator === \"line\",\r\n                            \"w-0 border-[1.5px] border-dashed bg-transparent\":\r\n                              indicator === \"dashed\",\r\n                            \"my-0.5\": nestLabel && indicator === \"dashed\",\r\n                          }\r\n                        )}\r\n                        style={\r\n                          {\r\n                            \"--color-bg\": indicatorColor,\r\n                            \"--color-border\": indicatorColor,\r\n                          } as React.CSSProperties\r\n                        }\r\n                      />\r\n                    )\r\n                  )}\r\n                  <div\r\n                    className={cn(\r\n                      \"flex flex-1 justify-between leading-none\",\r\n                      nestLabel ? \"items-end\" : \"items-center\"\r\n                    )}\r\n                  >\r\n                    <div className=\"grid gap-1.5\">\r\n                      {nestLabel ? tooltipLabel : null}\r\n                      <span className=\"text-muted-foreground\">\r\n                        {itemConfig?.label || item.name}\r\n                      </span>\r\n                    </div>\r\n                    {item.value && (\r\n                      <span className=\"text-foreground font-mono font-medium tabular-nums\">\r\n                        {item.value.toLocaleString()}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst ChartLegend = RechartsPrimitive.Legend\r\n\r\nfunction ChartLegendContent({\r\n  className,\r\n  hideIcon = false,\r\n  payload,\r\n  verticalAlign = \"bottom\",\r\n  nameKey,\r\n}: React.ComponentProps<\"div\"> &\r\n  Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\r\n    hideIcon?: boolean\r\n    nameKey?: string\r\n  }) {\r\n  const { config } = useChart()\r\n\r\n  if (!payload?.length) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"flex items-center justify-center gap-4\",\r\n        verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\r\n        className\r\n      )}\r\n    >\r\n      {payload.map((item) => {\r\n        const key = `${nameKey || item.dataKey || \"value\"}`\r\n        const itemConfig = getPayloadConfigFromPayload(config, item, key)\r\n\r\n        return (\r\n          <div\r\n            key={item.value}\r\n            className={cn(\r\n              \"[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3\"\r\n            )}\r\n          >\r\n            {itemConfig?.icon && !hideIcon ? (\r\n              <itemConfig.icon />\r\n            ) : (\r\n              <div\r\n                className=\"h-2 w-2 shrink-0 rounded-[2px]\"\r\n                style={{\r\n                  backgroundColor: item.color,\r\n                }}\r\n              />\r\n            )}\r\n            {itemConfig?.label}\r\n          </div>\r\n        )\r\n      })}\r\n    </div>\r\n  )\r\n}\r\n\r\n// Helper to extract item config from a payload.\r\nfunction getPayloadConfigFromPayload(\r\n  config: ChartConfig,\r\n  payload: unknown,\r\n  key: string\r\n) {\r\n  if (typeof payload !== \"object\" || payload === null) {\r\n    return undefined\r\n  }\r\n\r\n  const payloadPayload =\r\n    \"payload\" in payload &&\r\n    typeof payload.payload === \"object\" &&\r\n    payload.payload !== null\r\n      ? payload.payload\r\n      : undefined\r\n\r\n  let configLabelKey: string = key\r\n\r\n  if (\r\n    key in payload &&\r\n    typeof payload[key as keyof typeof payload] === \"string\"\r\n  ) {\r\n    configLabelKey = payload[key as keyof typeof payload] as string\r\n  } else if (\r\n    payloadPayload &&\r\n    key in payloadPayload &&\r\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\r\n  ) {\r\n    configLabelKey = payloadPayload[\r\n      key as keyof typeof payloadPayload\r\n    ] as string\r\n  }\r\n\r\n  return configLabelKey in config\r\n    ? config[configLabelKey]\r\n    : config[key as keyof typeof config]\r\n}\r\n\r\nexport {\r\n  ChartContainer,\r\n  ChartTooltip,\r\n  ChartTooltipContent,\r\n  ChartLegend,\r\n  ChartLegendContent,\r\n  ChartStyle,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAEA;AACA;AAAA;AAAA;AAEA;;;AALA;;;;AAOA,uCAAuC;AACvC,MAAM,SAAS;IAAE,OAAO;IAAI,MAAM;AAAQ;AAgB1C,MAAM,6BAAe,8KAAmB,CAA2B;AAEnE,SAAS;;IACP,MAAM,UAAU,2KAAgB,CAAC;IAEjC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;GARS;AAUT,SAAS,eAAe,KAWvB;QAXuB,EACtB,EAAE,EACF,SAAS,EACT,QAAQ,EACR,MAAM,EACN,GAAG,OAMJ,GAXuB;;IAYtB,MAAM,WAAW,sKAAW;IAC5B,MAAM,UAAU,AAAC,SAAyC,OAAjC,MAAM,SAAS,OAAO,CAAC,MAAM;IAEtD,qBACE,6LAAC,aAAa,QAAQ;QAAC,OAAO;YAAE;QAAO;kBACrC,cAAA,6LAAC;YACC,aAAU;YACV,cAAY;YACZ,WAAW,IAAA,4HAAE,EACX,+pBACA;YAED,GAAG,KAAK;;8BAET,6LAAC;oBAAW,IAAI;oBAAS,QAAQ;;;;;;8BACjC,6LAAC,6LAAqC;8BACnC;;;;;;;;;;;;;;;;;AAKX;IAjCS;KAAA;AAmCT,MAAM,aAAa;QAAC,EAAE,EAAE,EAAE,MAAM,EAAuC;IACrE,MAAM,cAAc,OAAO,OAAO,CAAC,QAAQ,MAAM,CAC/C;YAAC,GAAG,OAAO;eAAK,OAAO,KAAK,IAAI,OAAO,KAAK;;IAG9C,IAAI,CAAC,YAAY,MAAM,EAAE;QACvB,OAAO;IACT;IAEA,qBACE,6LAAC;QACC,yBAAyB;YACvB,QAAQ,OAAO,OAAO,CAAC,QACpB,GAAG,CACF;oBAAC,CAAC,OAAO,OAAO;uBAAK,AAAC,KACV,OAAtB,QAAO,iBACP,OADsB,IAAG,SAQb,OAPZ,YACC,GAAG,CAAC;wBAAC,CAAC,KAAK,WAAW;wBAEnB;oBADF,MAAM,QACJ,EAAA,oBAAA,WAAW,KAAK,cAAhB,wCAAA,iBAAkB,CAAC,MAAuC,KAC1D,WAAW,KAAK;oBAClB,OAAO,QAAQ,AAAC,aAAoB,OAAR,KAAI,MAAU,OAAN,OAAM,OAAK;gBACjD,GACC,IAAI,CAAC,OAAM;eAIH,IAAI,CAAC;QACV;;;;;;AAGN;MA/BM;AAiCN,MAAM,eAAe,qKAAyB;AAE9C,SAAS,oBAAoB,KAqB1B;QArB0B,EAC3B,MAAM,EACN,OAAO,EACP,SAAS,EACT,YAAY,KAAK,EACjB,YAAY,KAAK,EACjB,gBAAgB,KAAK,EACrB,KAAK,EACL,cAAc,EACd,cAAc,EACd,SAAS,EACT,KAAK,EACL,OAAO,EACP,QAAQ,EAQP,GArB0B;;IAsB3B,MAAM,EAAE,MAAM,EAAE,GAAG;IAEnB,MAAM,eAAe,wKAAa;qDAAC;gBAU3B;YATN,IAAI,aAAa,EAAC,oBAAA,8BAAA,QAAS,MAAM,GAAE;gBACjC,OAAO;YACT;YAEA,MAAM,CAAC,KAAK,GAAG;YACf,MAAM,MAAM,AAAC,GAAqD,OAAnD,aAAY,iBAAA,2BAAA,KAAM,OAAO,MAAI,iBAAA,2BAAA,KAAM,IAAI,KAAI;YAC1D,MAAM,aAAa,4BAA4B,QAAQ,MAAM;YAC7D,MAAM,QACJ,CAAC,YAAY,OAAO,UAAU,WAC1B,EAAA,gBAAA,MAAM,CAAC,MAA6B,cAApC,oCAAA,cAAsC,KAAK,KAAI,QAC/C,uBAAA,iCAAA,WAAY,KAAK;YAEvB,IAAI,gBAAgB;gBAClB,qBACE,6LAAC;oBAAI,WAAW,IAAA,4HAAE,EAAC,eAAe;8BAC/B,eAAe,OAAO;;;;;;YAG7B;YAEA,IAAI,CAAC,OAAO;gBACV,OAAO;YACT;YAEA,qBAAO,6LAAC;gBAAI,WAAW,IAAA,4HAAE,EAAC,eAAe;0BAAkB;;;;;;QAC7D;oDAAG;QACD;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,IAAI,CAAC,UAAU,EAAC,oBAAA,8BAAA,QAAS,MAAM,GAAE;QAC/B,OAAO;IACT;IAEA,MAAM,YAAY,QAAQ,MAAM,KAAK,KAAK,cAAc;IAExD,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,0HACA;;YAGD,CAAC,YAAY,eAAe;0BAC7B,6LAAC;gBAAI,WAAU;0BACZ,QAAQ,GAAG,CAAC,CAAC,MAAM;oBAClB,MAAM,MAAM,AAAC,GAAkD,OAAhD,WAAW,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI;oBACvD,MAAM,aAAa,4BAA4B,QAAQ,MAAM;oBAC7D,MAAM,iBAAiB,SAAS,KAAK,OAAO,CAAC,IAAI,IAAI,KAAK,KAAK;oBAE/D,qBACE,6LAAC;wBAEC,WAAW,IAAA,4HAAE,EACX,uGACA,cAAc,SAAS;kCAGxB,aAAa,CAAA,iBAAA,2BAAA,KAAM,KAAK,MAAK,aAAa,KAAK,IAAI,GAClD,UAAU,KAAK,KAAK,EAAE,KAAK,IAAI,EAAE,MAAM,OAAO,KAAK,OAAO,kBAE1D;;gCACG,CAAA,uBAAA,iCAAA,WAAY,IAAI,kBACf,6LAAC,WAAW,IAAI;;;;2CAEhB,CAAC,+BACC,6LAAC;oCACC,WAAW,IAAA,4HAAE,EACX,kEACA;wCACE,eAAe,cAAc;wCAC7B,OAAO,cAAc;wCACrB,mDACE,cAAc;wCAChB,UAAU,aAAa,cAAc;oCACvC;oCAEF,OACE;wCACE,cAAc;wCACd,kBAAkB;oCACpB;;;;;;8CAKR,6LAAC;oCACC,WAAW,IAAA,4HAAE,EACX,4CACA,YAAY,cAAc;;sDAG5B,6LAAC;4CAAI,WAAU;;gDACZ,YAAY,eAAe;8DAC5B,6LAAC;oDAAK,WAAU;8DACb,CAAA,uBAAA,iCAAA,WAAY,KAAK,KAAI,KAAK,IAAI;;;;;;;;;;;;wCAGlC,KAAK,KAAK,kBACT,6LAAC;4CAAK,WAAU;sDACb,KAAK,KAAK,CAAC,cAAc;;;;;;;;;;;;;;uBAhD/B,KAAK,OAAO;;;;;gBAwDvB;;;;;;;;;;;;AAIR;IA9IS;;QAsBY;;;MAtBZ;AAgJT,MAAM,cAAc,mKAAwB;AAE5C,SAAS,mBAAmB,KAUzB;QAVyB,EAC1B,SAAS,EACT,WAAW,KAAK,EAChB,OAAO,EACP,gBAAgB,QAAQ,EACxB,OAAO,EAKN,GAVyB;;IAW1B,MAAM,EAAE,MAAM,EAAE,GAAG;IAEnB,IAAI,EAAC,oBAAA,8BAAA,QAAS,MAAM,GAAE;QACpB,OAAO;IACT;IAEA,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,0CACA,kBAAkB,QAAQ,SAAS,QACnC;kBAGD,QAAQ,GAAG,CAAC,CAAC;YACZ,MAAM,MAAM,AAAC,GAAqC,OAAnC,WAAW,KAAK,OAAO,IAAI;YAC1C,MAAM,aAAa,4BAA4B,QAAQ,MAAM;YAE7D,qBACE,6LAAC;gBAEC,WAAW,IAAA,4HAAE,EACX;;oBAGD,CAAA,uBAAA,iCAAA,WAAY,IAAI,KAAI,CAAC,yBACpB,6LAAC,WAAW,IAAI;;;;6CAEhB,6LAAC;wBACC,WAAU;wBACV,OAAO;4BACL,iBAAiB,KAAK,KAAK;wBAC7B;;;;;;oBAGH,uBAAA,iCAAA,WAAY,KAAK;;eAfb,KAAK,KAAK;;;;;QAkBrB;;;;;;AAGN;IApDS;;QAWY;;;MAXZ;AAsDT,gDAAgD;AAChD,SAAS,4BACP,MAAmB,EACnB,OAAgB,EAChB,GAAW;IAEX,IAAI,OAAO,YAAY,YAAY,YAAY,MAAM;QACnD,OAAO;IACT;IAEA,MAAM,iBACJ,aAAa,WACb,OAAO,QAAQ,OAAO,KAAK,YAC3B,QAAQ,OAAO,KAAK,OAChB,QAAQ,OAAO,GACf;IAEN,IAAI,iBAAyB;IAE7B,IACE,OAAO,WACP,OAAO,OAAO,CAAC,IAA4B,KAAK,UAChD;QACA,iBAAiB,OAAO,CAAC,IAA4B;IACvD,OAAO,IACL,kBACA,OAAO,kBACP,OAAO,cAAc,CAAC,IAAmC,KAAK,UAC9D;QACA,iBAAiB,cAAc,CAC7B,IACD;IACH;IAEA,OAAO,kBAAkB,SACrB,MAAM,CAAC,eAAe,GACtB,MAAM,CAAC,IAA2B;AACxC","debugId":null}},
    {"offset": {"line": 6471, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/components/ui/popover.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Popover({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Root>) {\r\n  return <PopoverPrimitive.Root data-slot=\"popover\" {...props} />\r\n}\r\n\r\nfunction PopoverTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {\r\n  return <PopoverPrimitive.Trigger data-slot=\"popover-trigger\" {...props} />\r\n}\r\n\r\nfunction PopoverContent({\r\n  className,\r\n  align = \"center\",\r\n  sideOffset = 4,\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Content>) {\r\n  return (\r\n    <PopoverPrimitive.Portal>\r\n      <PopoverPrimitive.Content\r\n        data-slot=\"popover-content\"\r\n        align={align}\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden\",\r\n          className\r\n        )}\r\n        {...props}\r\n      />\r\n    </PopoverPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction PopoverAnchor({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {\r\n  return <PopoverPrimitive.Anchor data-slot=\"popover-anchor\" {...props} />\r\n}\r\n\r\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,QAAQ,KAEoC;QAFpC,EACf,GAAG,OACgD,GAFpC;IAGf,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAW,GAAG,KAAK;;;;;;AAC7D;KAJS;AAMT,SAAS,eAAe,KAEgC;QAFhC,EACtB,GAAG,OACmD,GAFhC;IAGtB,qBAAO,6LAAC,iLAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;MAJS;AAMT,SAAS,eAAe,KAKgC;QALhC,EACtB,SAAS,EACT,QAAQ,QAAQ,EAChB,aAAa,CAAC,EACd,GAAG,OACmD,GALhC;IAMtB,qBACE,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,aAAU;YACV,OAAO;YACP,YAAY;YACZ,WAAW,IAAA,4HAAE,EACX,keACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIjB;MApBS;AAsBT,SAAS,cAAc,KAEgC;QAFhC,EACrB,GAAG,OACkD,GAFhC;IAGrB,qBAAO,6LAAC,gLAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS","debugId":null}},
    {"offset": {"line": 6558, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Dashboard/components/categoryStats.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useMemo, useEffect, useCallback } from 'react'\r\nimport useSWR from 'swr'\r\nimport { CalendarIcon, ChevronDown, ChevronUp, History } from 'lucide-react'\r\nimport type { DateRange } from 'react-day-picker'\r\nimport { Bar, BarChart, CartesianGrid, XAxis } from 'recharts'\r\nimport axios from \"@/lib/axios\"\r\nimport { Button } from '@/components/ui/button'\r\nimport { Calendar } from '@/components/ui/calendar'\r\nimport {\r\n  Card,\r\n  CardAction,\r\n  CardContent,\r\n  CardDescription,\r\n  CardFooter,\r\n  CardHeader,\r\n  CardTitle\r\n} from '@/components/ui/card'\r\nimport type { ChartConfig } from '@/components/ui/chart'\r\nimport { ChartContainer, ChartTooltip, ChartTooltipContent } from '@/components/ui/chart'\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\"\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\n\r\ntype SaleItem = {\r\n  category: string\r\n  quantity: number\r\n  total_sales: number  // Add this field\r\n  last_purchase: string\r\n  unit?: string\r\n}\r\n\r\ntype Product = {\r\n  name: string\r\n  qty: number\r\n  price: number\r\n  unit?: string\r\n  last_purchase?: string // Add this property\r\n  total?: number // Add this property too\r\n}\r\n\r\ntype ChartData = SaleItem\r\n\r\nconst chartConfig: ChartConfig = {\r\n  total_sales: {\r\n    label: 'Total Sales',\r\n    color: 'var(--color-primary)'\r\n  }\r\n}\r\n\r\n\r\nconst fetcher = async (url: string) => {\r\n  const response = await axios.get(url)\r\n  return response.data?.data || response.data || []\r\n}\r\n\r\n// Fetch products to get unit information\r\nconst productsFetcher = async () => {\r\n  const response = await axios.get('/products?limit=all')\r\n  return response.data?.data || response.data || []\r\n}\r\n\r\nexport default function ProductStats() {\r\n  const today = new Date()\r\n  const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\r\n\r\n  const [range, setRange] = useState<DateRange | undefined>({\r\n    from: startOfMonth,\r\n    to: today\r\n  })\r\n  // Change the default sort order from 'desc' to 'recent':\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc' | 'recent'>('recent')\r\n  \r\n  // ADD: Move these state declarations here\r\n  const [open, setOpen] = useState(false)\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null)\r\n  const [products, setProducts] = useState<Product[]>([])\r\n  const [loadingProducts, setLoadingProducts] = useState(false)\r\n  // Also change the table sort order default:\r\n  const [tableSortOrder, setTableSortOrder] = useState<'asc' | 'desc' | 'recent'>('recent')\r\n  const [categoryTotals, setCategoryTotals] = useState<{[key: string]: number}>({})\r\n\r\n  const saleItemsUrl = useMemo(() => {\r\n    const params = new URLSearchParams()\r\n    if (range?.from) params.set('from', range.from.toISOString())\r\n    if (range?.to) params.set('to', range.to.toISOString())\r\n    return `/sales-items?${params.toString()}`\r\n  }, [range])\r\n\r\n  // Keep previous data during revalidation and avoid refetch on window focus\r\n  const { data: saleItems = [], error, isLoading, isValidating } = useSWR<SaleItem[]>(\r\n    saleItemsUrl,\r\n    fetcher,\r\n    { keepPreviousData: true, revalidateOnFocus: false }\r\n  )\r\n\r\n  // Fetch products to get unit information\r\n  const { data: allProducts = [] } = useSWR(\r\n    '/products?limit=all',\r\n    productsFetcher,\r\n    { keepPreviousData: true, revalidateOnFocus: false }\r\n  )\r\n\r\n  // Create a map of category to unit (assuming products in same category have same unit)\r\n  const categoryUnitMap = useMemo(() => {\r\n    const map = new Map<string, string>()\r\n    console.log('All products for mapping:', allProducts) // Debug log\r\n    allProducts.forEach((product: any) => {\r\n      if (product.category_id && product.unit) {\r\n        // We need to find the actual category name, not just \"Category X\"\r\n        // Let's use the category_id to map to the actual category name from the chart data\r\n        map.set(`Category ${product.category_id}`, product.unit)\r\n\r\n        // Also try to map common category names\r\n        if (product.category_name) {\r\n          map.set(product.category_name, product.unit)\r\n        }\r\n      }\r\n    })\r\n    console.log('Final category-unit map:', map) // Debug log\r\n    return map\r\n  }, [allProducts])\r\n\r\n  // MODIFY: Update handleBarClick to also calculate the correct total for tooltip\r\n  const handleBarClick = async (data: any) => {\r\n    console.log('Clicked category:', data.category)\r\n    setSelectedCategory(data.category)\r\n    setOpen(true)\r\n    setLoadingProducts(true)\r\n\r\n    try {\r\n      const params = new URLSearchParams()\r\n      params.set('category_name', data.category)\r\n      if (range?.from) params.set('from_date', range.from.toISOString())\r\n      if (range?.to) params.set('to_date', range.to.toISOString())\r\n\r\n      const url = `/sales-items/products-by-category?${params.toString()}`\r\n      console.log('Making request to:', url)\r\n\r\n      const response = await axios.get(url)\r\n      console.log('Products by category response:', response.data)\r\n      const items = response.data?.data || response.data || []\r\n      console.log('Parsed product items:', items)\r\n\r\n      // Find the correct unit for this category\r\n      let categoryUnit = 'pcs' // default\r\n      const categoryProduct = allProducts.find((p: any) => {\r\n        return p.category_name === data.category ||\r\n          p.category_id && `Category ${p.category_id}` === data.category\r\n      })\r\n      if (categoryProduct && categoryProduct.unit) {\r\n        categoryUnit = categoryProduct.unit\r\n      }\r\n\r\n      // Transform the data to match expected structure\r\n      const transformedItems = items.map((item: any) => ({\r\n        name: item.product_name || 'Unknown Product',\r\n        qty: item.qty || 0,\r\n        price: item.price || 0,\r\n        total: item.total || 0,\r\n        unit: item.unit || 'pcs',\r\n        last_purchase: item.last_purchase\r\n      }))\r\n\r\n      console.log('Transformed product items:', transformedItems)\r\n      setProducts(transformedItems)\r\n\r\n      // ADD: Calculate and store the correct total for this category\r\n      const correctTotal = transformedItems.reduce((acc: number, item: Product) => acc + (Number(item.total) || 0), 0)\r\n      setCategoryTotals(prev => ({\r\n        ...prev,\r\n        [data.category]: correctTotal\r\n      }))\r\n      \r\n      console.log(`Correct total for ${data.category}: ₱${correctTotal.toLocaleString()}`)\r\n    } catch (error: any) {\r\n      console.error('Error fetching products by category:', error)\r\n      console.error('Error details:', error.response?.data)\r\n      setProducts([])\r\n    } finally {\r\n      setLoadingProducts(false)\r\n    }\r\n  }\r\n  // Sort table data locally based on tableSortOrder\r\n  const sortedProducts = useMemo(() => {\r\n    switch (tableSortOrder) {\r\n      case 'asc':\r\n        return [...products].sort((a, b) => (a.total || 0) - (b.total || 0))\r\n      case 'desc':\r\n        return [...products].sort((a, b) => (b.total || 0) - (a.total || 0))\r\n      case 'recent':\r\n      default:\r\n        // newest first by last_purchase (robust to missing values)\r\n        return [...products].sort((a, b) => {\r\n          const ta = a.last_purchase ? new Date(a.last_purchase).getTime() : 0\r\n          const tb = b.last_purchase ? new Date(b.last_purchase).getTime() : 0\r\n          return tb - ta\r\n        })\r\n    }\r\n  }, [products, tableSortOrder])\r\n\r\n  // compute total of products currently shown in modal\r\n  const productsTotal = products.reduce((acc, p) => acc + (Number(p.total) || 0), 0)\r\n\r\n  // ADD: Debug the modal total calculation\r\n  console.log('Modal products:', products)\r\n  console.log('Modal total calculation:', productsTotal)\r\n  console.log('Individual product totals:', products.map(p => ({ name: p.name, total: p.total })))\r\n\r\n  // initial empty state: show skeleton full-chart if first load and no data\r\n  const initialLoadingNoData = isLoading && saleItems.length === 0\r\n  // updating overlay while revalidating (keep previous chart visible)\r\n  const isUpdating = isValidating && saleItems.length > 0\r\n\r\n  // Note: do not return early on error — render error inside the chart area so header/footer remain visible.\r\n\r\n  // ADD: Fetch correct totals for all categories\r\n  const fetchCategoryTotals = useCallback(async () => {\r\n    if (!range?.from || !range?.to) return\r\n\r\n    try {\r\n      const categoryTotalsMap: {[key: string]: number} = {}\r\n      \r\n      // Get all unique categories from saleItems\r\n      const categories = [...new Set(saleItems.map(si => si.category))]\r\n      \r\n      // Fetch totals for each category\r\n      for (const category of categories) {\r\n        try {\r\n          const params = new URLSearchParams()\r\n          params.set('category_name', category)\r\n          params.set('from_date', range.from.toISOString())\r\n          params.set('to_date', range.to.toISOString())\r\n\r\n          const response = await axios.get(`/sales-items/products-by-category?${params.toString()}`)\r\n          const items = response.data?.data || response.data || []\r\n          \r\n          const total = items.reduce((acc: number, item: any) => acc + (Number(item.total) || 0), 0)\r\n          categoryTotalsMap[category] = total\r\n          \r\n          console.log(`Correct total for ${category}: ₱${total.toLocaleString()}`)\r\n        } catch (error) {\r\n          console.error(`Error fetching total for ${category}:`, error)\r\n          // Fallback to original total\r\n          const originalItem = saleItems.find(si => si.category === category)\r\n          categoryTotalsMap[category] = Number(originalItem?.total_sales) || 0\r\n        }\r\n      }\r\n      \r\n      setCategoryTotals(categoryTotalsMap)\r\n    } catch (error) {\r\n      console.error('Error fetching category totals:', error)\r\n    }\r\n  }, [saleItems, range])\r\n\r\n  // ADD: Effect to fetch category totals when data changes\r\n  useEffect(() => {\r\n    if (saleItems.length > 0 && range?.from && range?.to) {\r\n      fetchCategoryTotals()\r\n    }\r\n  }, [saleItems, range, fetchCategoryTotals])\r\n\r\n  // MODIFY: Update chartData to use correct totals when available\r\n  const chartData = useMemo(() => {\r\n    const arr = saleItems.map(si => {\r\n      // Try to find the unit for this category\r\n      let unit = 'pcs' // default\r\n\r\n      // First try to find by exact category name\r\n      if (categoryUnitMap.has(si.category)) {\r\n        unit = categoryUnitMap.get(si.category)!\r\n      } else {\r\n        // If not found, try to find by looking up products in this category\r\n        const categoryProduct = allProducts.find((p: any) => {\r\n          return p.category_name === si.category ||\r\n            p.category_id && `Category ${p.category_id}` === si.category\r\n        })\r\n        if (categoryProduct && categoryProduct.unit) {\r\n          unit = categoryProduct.unit\r\n        }\r\n      }\r\n\r\n      // USE CORRECT TOTAL if available, otherwise use the aggregated total\r\n      const totalSales = categoryTotals[si.category] || Number(si.total_sales) || 0\r\n\r\n      return {\r\n        category: si.category,\r\n        quantity: Number(si.quantity) || 0,\r\n        total_sales: totalSales, // Use correct total\r\n        last_purchase: si.last_purchase,\r\n        unit: unit\r\n      }\r\n    })\r\n\r\n    // Debug log to see the actual data\r\n    console.log('Chart data before sorting:', arr)\r\n    console.log('Total sales sum:', arr.reduce((acc, curr) => acc + curr.total_sales, 0))\r\n    \r\n    // Debug each category's total\r\n    arr.forEach(item => {\r\n      console.log(`Category: ${item.category}, Total Sales: ₱${item.total_sales.toLocaleString()}`)\r\n    })\r\n\r\n    switch (sortOrder) {\r\n      case 'asc': return [...arr].sort((a, b) => a.total_sales - b.total_sales)\r\n      case 'desc': return [...arr].sort((a, b) => b.total_sales - a.total_sales)\r\n      case 'recent': return [...arr].sort((a, b) => new Date(b.last_purchase).getTime() - new Date(a.last_purchase).getTime())\r\n      default: return [...arr].sort((a, b) => b.total_sales - a.total_sales)\r\n    }\r\n  }, [saleItems, sortOrder, categoryUnitMap, allProducts, categoryTotals]) // ADD categoryTotals to dependencies\r\n\r\n  const total = useMemo(() => chartData.reduce((acc, curr) => acc + curr.total_sales, 0), [chartData])\r\n\r\n  return (\r\n    <>\r\n      <Card className='@container/card w-full relative'>\r\n        <CardHeader className='flex flex-col border-b @md/card:grid'>\r\n          <CardTitle>Category Analytics</CardTitle>\r\n          <CardDescription>Showing most sold categories for this month.</CardDescription>\r\n          <CardAction className='mt-2 @md/card:mt-0'>\r\n            <div className=\"flex gap-2 items-center mt-2\">\r\n              <Button onClick={() => setSortOrder('desc')} variant={sortOrder === 'desc' ? 'default' : 'outline'} size=\"sm\"><ChevronDown size={16} /></Button>\r\n              <Button onClick={() => setSortOrder('recent')} variant={sortOrder === 'recent' ? 'default' : 'outline'} size=\"sm\"><History size={16} /></Button>\r\n              <Button onClick={() => setSortOrder('asc')} variant={sortOrder === 'asc' ? 'default' : 'outline'} size=\"sm\"><ChevronUp size={16} /></Button>\r\n              <Popover>\r\n                <PopoverTrigger asChild>\r\n                  <Button variant='outline'>\r\n                    <CalendarIcon />\r\n                    {range?.from && range?.to\r\n                      ? `${range.from.toLocaleDateString()} - ${range.to.toLocaleDateString()}`\r\n                      : `${startOfMonth.toLocaleDateString()} - ${today.toLocaleDateString()}`}\r\n                  </Button>\r\n                </PopoverTrigger>\r\n                <PopoverContent className='w-auto p-0' align='end'>\r\n                  <Calendar mode='range' defaultMonth={range?.from} selected={range} onSelect={setRange} fixedWeeks showOutsideDays disabled={{ after: today }} />\r\n                </PopoverContent>\r\n              </Popover>\r\n            </div>\r\n          </CardAction>\r\n        </CardHeader>\r\n\r\n        {/* CardContent is always rendered so header/footer don't disappear */}\r\n        <CardContent className='px-4'>\r\n          {/* Chart wrapper: relative so we can overlay the skeleton.\r\n              h-89 is preserved on the wrapper so size remains constant. */}\r\n          <div className=\"relative h-89 w-full\">\r\n            {/* Chart area (keeps previous data visible because SWR keepPreviousData is enabled).\r\n                We render either:\r\n                  - the chart (when there is chart data),\r\n                  - a \"no data\" / error message (when not loading & no data),\r\n                  - underlying empty area (chart hidden) while initial skeleton shows on top.\r\n            */}\r\n            <div className=\"absolute inset-0 z-10 flex items-center justify-center\">\r\n              {chartData.length > 0 ? (\r\n                <div className=\"w-full h-full\">\r\n                  {/* ChartContainer sized to fill the area */}\r\n                  <ChartContainer config={chartConfig} className='aspect-auto h-89 w-full'>\r\n                    <BarChart data={chartData} margin={{ left: 12, right: 12 }}>\r\n                      <CartesianGrid vertical={false} />\r\n                      <XAxis dataKey='category' tickLine={false} axisLine={false} tickMargin={8} minTickGap={20} />\r\n                      <ChartTooltip\r\n                        content={\r\n                          <ChartTooltipContent\r\n                            className='w-[150px]'\r\n                            nameKey='total_sales'\r\n                            labelFormatter={v => v}\r\n                            formatter={(value, name, props) => {\r\n                              console.log('Tooltip data:', { value, name, props }) // Debug log\r\n                              return [\r\n                                `₱ ${Number(value).toLocaleString()}`, // Show just the price\r\n                                '' // Empty string instead of 'Total Sales'\r\n                              ]\r\n                            }}\r\n                          />\r\n                        }\r\n                      />\r\n                      <Bar dataKey='total_sales' fill={`var(--color-total_sales)`} radius={4} onClick={handleBarClick} />\r\n                    </BarChart>\r\n                  </ChartContainer>\r\n                </div>\r\n              ) : (\r\n                // show helpful messages when there is no chart data\r\n                <div className=\"w-full h-full flex items-center justify-center px-4\">\r\n                  {error ? (\r\n                    <div className=\"text-sm text-red-600\">Error loading product stats.</div>\r\n                  ) : (!isLoading && saleItems.length === 0) ? (\r\n                    <div className=\"text-sm text-gray-600\">No data for the selected range.</div>\r\n                  ) : (\r\n                    // keep empty while initial skeleton (below) handles first-load UX\r\n                    <div className=\"w-full h-full\" />\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Skeleton overlay — used both for initial loading (no data) and for updates.\r\n                Overlay sits above chart (z-20), fades in/out using transition-opacity.\r\n                pointer-events-none ensures underlying chart remains interactive if needed. */}\r\n            <div\r\n              aria-hidden\r\n              className={`absolute inset-0 z-20 flex items-end px-4 pointer-events-none transition-opacity duration-300 ease-in-out ${(isUpdating || initialLoadingNoData) ? 'opacity-100' : 'opacity-0'\r\n                }`}\r\n            >\r\n              <div className=\"flex w-full h-full items-end gap-3\">\r\n                {Array.from({ length: Math.max(6, chartData.length || 6) }).map((_, i) => {\r\n                  // create some height variety for a natural skeleton chart\r\n                  const heights = [28, 44, 60, 36, 52, 40]\r\n                  const pct = heights[i % heights.length]\r\n                  return (\r\n                    <div key={i} className=\"flex-1 flex items-end justify-center\">\r\n                      <div className=\"w-3/4\">\r\n                        <Skeleton className=\"rounded-t-md animate-pulse\" style={{ height: `${pct}%` }} />\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n\r\n        <CardFooter className='border-t'>\r\n          <div className='text-sm'>\r\n            Total sales: <span className='font-semibold'>₱ {total.toLocaleString()}</span>\r\n          </div>\r\n        </CardFooter>\r\n      </Card>\r\n\r\n      {/* Modal with filter buttons + scroll area */}\r\n      <Dialog open={open} onOpenChange={setOpen}>\r\n        <DialogContent className=\"w-full max-w-5xl sm:max-w-4xl md:max-w-3xl lg:max-w-5xl xl:max-w-6xl\">\r\n          <DialogHeader className=\"flex flex-row items-center justify-between\">\r\n            <DialogTitle className=\"text-lg font-semibold items-center\">\r\n              {selectedCategory ? `${selectedCategory} — Total Amount: ₱ ${productsTotal.toLocaleString()}` : `₱ ${productsTotal.toLocaleString()}`}\r\n            </DialogTitle>\r\n            <div className=\"flex gap-2 pr-4\">\r\n              <Button\r\n                onClick={() => setTableSortOrder('desc')}\r\n                variant={tableSortOrder === 'desc' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <ChevronDown size={16} />\r\n              </Button>\r\n              <Button\r\n                onClick={() => setTableSortOrder('recent')}\r\n                variant={tableSortOrder === 'recent' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <History size={16} />\r\n              </Button>\r\n              <Button\r\n                onClick={() => setTableSortOrder('asc')}\r\n                variant={tableSortOrder === 'asc' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <ChevronUp size={16} />\r\n              </Button>\r\n            </div>\r\n          </DialogHeader>\r\n\r\n          {/* Table area */}\r\n          <ScrollArea className=\"h-80 mt-4 rounded-md border bg-white\">\r\n            {/* If we're loading and have no previous products, show loading message */}\r\n            {loadingProducts && products.length === 0 && (\r\n              <div className=\"p-4 text-center text-gray-600\">Loading products…</div>\r\n            )}\r\n\r\n            {/* Show existing / fetched table if we have products */}\r\n            {sortedProducts.length > 0 ? (\r\n              <>\r\n                {/* optional small loader banner while updating */}\r\n                {loadingProducts && (\r\n                  <div className=\"p-2 text-sm text-gray-600 border-b\">Updating products…</div>\r\n                )}\r\n                <table className=\"w-full text-sm border-collapse\">\r\n                  <thead className=\"bg-gray-100 sticky top-0\">\r\n                    <tr>\r\n                      <th className=\"p-2 border text-left font-semibold\">Product</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Quantity Sold</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Unit Price</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Total</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {sortedProducts.map((p, idx) => (\r\n                      <tr key={idx} className=\"hover:bg-gray-50 transition\">\r\n                        <td className=\"p-2 border font-medium\">{p.name}</td>\r\n                        <td className=\"p-2 border text-center font-semibold text-blue-600\">\r\n                          {p.qty.toLocaleString()} {p.unit}\r\n                        </td>\r\n                        <td className=\"p-2 border text-left\">₱ {p.price.toLocaleString()}</td>\r\n                        <td className=\"p-2 border text-left font-semibold\">₱ {(p.total || 0).toLocaleString()}</td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </>\r\n            ) : (\r\n              // If not loading and no products, show empty state\r\n              !loadingProducts && (\r\n                <p className=\"p-4 text-center text-gray-500\">No products found for this category.</p>\r\n              )\r\n            )}\r\n          </ScrollArea>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7551, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Dashboard/components/salesStats.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react'\r\nimport useSWR from 'swr'\r\nimport axios from \"@/lib/axios\";\r\nimport { CartesianGrid, Line, LineChart, XAxis } from 'recharts'\r\nimport { CalendarIcon, List, ChevronDown, ChevronUp } from 'lucide-react'\r\nimport type { DateRange } from 'react-day-picker'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport { Calendar } from '@/components/ui/calendar'\r\nimport {\r\n  Card,\r\n  CardAction,\r\n  CardContent,\r\n  CardDescription,\r\n  CardFooter,\r\n  CardHeader,\r\n  CardTitle\r\n} from '@/components/ui/card'\r\nimport type { ChartConfig } from '@/components/ui/chart'\r\nimport { ChartContainer, ChartTooltip, ChartTooltipContent } from '@/components/ui/chart'\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\n\r\ntype Sale = {\r\n  created_at: string\r\n  total_purchase: number\r\n}\r\n\r\ntype ChartData = {\r\n  date: string\r\n  customer: number\r\n}\r\n\r\nconst chartConfig: ChartConfig = {\r\n  customer: {\r\n    label: 'Total',\r\n    color: 'var(--color-primary)'\r\n  }\r\n}\r\n\r\nconst fetcher = async (url: string) => {\r\n  const response = await axios.get(url);\r\n  return response.data?.data || []\r\n}\r\n\r\n// Manila offset in ms\r\nconst MANILA_OFFSET_MS = 8 * 60 * 60 * 1000\r\n\r\n// Return UTC ISO that corresponds to Manila 00:00:00.000 for the provided date (inclusive start).\r\n// Caller should pass a Date representing the selected local day (from calendar).\r\nfunction manilaDayStartUTCiso(d: Date) {\r\n  const manilaLocal = new Date(d.getTime() + MANILA_OFFSET_MS)\r\n  const y = manilaLocal.getUTCFullYear()\r\n  const m = manilaLocal.getUTCMonth()\r\n  const day = manilaLocal.getUTCDate()\r\n  const manilaMidnightUTCms = Date.UTC(y, m, day, 0, 0, 0) - MANILA_OFFSET_MS\r\n  return new Date(manilaMidnightUTCms).toISOString() // inclusive start\r\n}\r\n\r\n// Return UTC ISO for Manila next-day 00:00:00.000 (exclusive end).\r\n// Use this as `to` so backend can use created_at < to and include the whole last Manila day.\r\nfunction manilaNextDayStartUTCiso(d: Date) {\r\n  const manilaLocal = new Date(d.getTime() + MANILA_OFFSET_MS)\r\n  const y = manilaLocal.getUTCFullYear()\r\n  const m = manilaLocal.getUTCMonth()\r\n  const day = manilaLocal.getUTCDate()\r\n  const manilaMidnightUTCms = Date.UTC(y, m, day, 0, 0, 0) - MANILA_OFFSET_MS\r\n  const nextMidnight = manilaMidnightUTCms + 24 * 60 * 60 * 1000\r\n  return new Date(nextMidnight).toISOString() // exclusive end\r\n}\r\n\r\n// Convert an ISO created_at (UTC) to a Manila YYYY-MM-DD string\r\nfunction createdAtToManilaYmd(iso: string) {\r\n  const d = new Date(iso) // UTC time\r\n  const manila = new Date(d.getTime() + MANILA_OFFSET_MS)\r\n  const y = manila.getUTCFullYear()\r\n  const m = String(manila.getUTCMonth() + 1).padStart(2, '0')\r\n  const day = String(manila.getUTCDate()).padStart(2, '0')\r\n  return `${y}-${m}-${day}`\r\n}\r\n\r\n// iterate dates inclusive (local dates)\r\nfunction eachDayInclusive(from: Date, to: Date) {\r\n  const arr: Date[] = []\r\n  const cur = new Date(from.getFullYear(), from.getMonth(), from.getDate())\r\n  const end = new Date(to.getFullYear(), to.getMonth(), to.getDate())\r\n  while (cur <= end) {\r\n    arr.push(new Date(cur))\r\n    cur.setDate(cur.getDate() + 1)\r\n  }\r\n  return arr\r\n}\r\n\r\n// format YYYY-MM-DD from local Date\r\nfunction ymd(date: Date) {\r\n  const y = date.getFullYear()\r\n  const m = String(date.getMonth() + 1).padStart(2, '0')\r\n  const d = String(date.getDate()).padStart(2, '0')\r\n  return `${y}-${m}-${d}`\r\n}\r\n\r\n// parse YYYY-MM-DD into a local Date (avoid timezone shifts)\r\nfunction parseYmdToLocalDate(ymdStr: string) {\r\n  const [y, m, d] = ymdStr.split('-').map(Number)\r\n  return new Date(y, m - 1, d)\r\n}\r\n\r\nexport default function SalesStats() {\r\n  const today = new Date()\r\n  const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\r\n  const [range, setRange] = React.useState<DateRange | undefined>({\r\n    from: startOfMonth,\r\n    to: today\r\n  })\r\n  const [sortOrder, setSortOrder] = React.useState<'asc' | 'desc' | 'normal'>('normal')\r\n\r\n  // build URL with from/to when range selected (convert to Manila day boundaries -> UTC ISO)\r\n  // pass from = Manila 00:00 (inclusive), to = next Manila 00:00 (exclusive) so backend can use gte / lt\r\n  const salesUrl = React.useMemo(() => {\r\n    if (!range?.from || !range?.to) return '/sales'\r\n    const fromIso = manilaDayStartUTCiso(range.from)\r\n    const toIso = manilaNextDayStartUTCiso(range.to) // exclusive end: includes the whole `range.to` Manila day\r\n    return `/sales?from=${encodeURIComponent(fromIso)}&to=${encodeURIComponent(toIso)}`\r\n  }, [range?.from?.getTime(), range?.to?.getTime()])\r\n\r\n  // Keep previous data during revalidation to avoid flicker\r\n  const { data: sales = [], error, isLoading, isValidating } = useSWR<Sale[]>(\r\n    salesUrl,\r\n    fetcher,\r\n    { keepPreviousData: true, revalidateOnFocus: false }\r\n  )\r\n\r\n  // Group by Manila date (YYYY-MM-DD)\r\n  const groupedByDateMap = React.useMemo(() => {\r\n    const map = new Map<string, number>()\r\n    sales.forEach(sale => {\r\n      const key = createdAtToManilaYmd(sale.created_at)\r\n      map.set(key, (map.get(key) || 0) + (sale.total_purchase || 0))\r\n    })\r\n    return map\r\n  }, [sales])\r\n\r\n  // Build full date series based on selected range (or fallback to data date span)\r\n  const chartSeries = React.useMemo(() => {\r\n    let fromDate: Date\r\n    let toDate: Date\r\n    if (range?.from && range?.to) {\r\n      fromDate = new Date(range.from.getFullYear(), range.from.getMonth(), range.from.getDate())\r\n      toDate = new Date(range.to.getFullYear(), range.to.getMonth(), range.to.getDate())\r\n    } else if (sales.length > 0) {\r\n      const keys = Array.from(groupedByDateMap.keys()).sort()\r\n      const min = parseYmdToLocalDate(keys[0])\r\n      const max = parseYmdToLocalDate(keys[keys.length - 1])\r\n      fromDate = new Date(min.getFullYear(), min.getMonth(), min.getDate())\r\n      toDate = new Date(max.getFullYear(), max.getMonth(), max.getDate())\r\n    } else {\r\n      fromDate = new Date(today.getFullYear(), today.getMonth(), today.getDate())\r\n      toDate = fromDate\r\n    }\r\n\r\n    const days = eachDayInclusive(fromDate, toDate)\r\n    return days.map(d => {\r\n      const key = ymd(d) // YYYY-MM-DD (Manila/local day keys)\r\n      return {\r\n        date: key,\r\n        customer: groupedByDateMap.get(key) || 0\r\n      }\r\n    })\r\n  }, [range?.from?.getTime(), range?.to?.getTime(), sales, groupedByDateMap, today])\r\n\r\n  // --- NEW: compute chartDisplayData based on sortOrder ---\r\n  const chartDisplayData = React.useMemo(() => {\r\n    if (sortOrder === 'normal') return chartSeries\r\n    const arr = [...chartSeries]\r\n    if (sortOrder === 'asc') {\r\n      arr.sort((a, b) => a.customer - b.customer)\r\n    } else if (sortOrder === 'desc') {\r\n      arr.sort((a, b) => b.customer - a.customer)\r\n    }\r\n    return arr\r\n  }, [chartSeries, sortOrder])\r\n  // -------------------------------------------------------\r\n\r\n  // sortedDataForTable (affects table/summaries only)\r\n  const sortedDataForTable = React.useMemo(() => {\r\n    let arr = [...chartSeries]\r\n    if (sortOrder === 'asc') arr.sort((a, b) => a.customer - b.customer)\r\n    else if (sortOrder === 'desc') arr.sort((a, b) => b.customer - a.customer)\r\n    return arr\r\n  }, [chartSeries, sortOrder])\r\n\r\n  // total sums the filtered chartSeries values\r\n  const total = React.useMemo(\r\n    () => chartSeries.reduce((acc, curr) => acc + curr.customer, 0),\r\n    [chartSeries]\r\n  )\r\n\r\n  // Detect \"empty\" period: all points are zero\r\n  const isEmptyPeriod = React.useMemo(() => {\r\n    return chartSeries.length > 0 && chartSeries.every(pt => (pt.customer ?? 0) === 0)\r\n  }, [chartSeries])\r\n\r\n  const initialLoadingNoData = isLoading && sales.length === 0\r\n  const isUpdating = isValidating && sales.length > 0\r\n\r\n  if (error && !sales.length) return <div>Error loading sales data.</div>\r\n\r\n  return (\r\n    <Card className='@container/card w-full'>\r\n      <CardHeader className='flex flex-col border-b @md/card:grid'>\r\n        <CardTitle>Sales Chart</CardTitle>\r\n        <CardDescription>Filter total sales by date range</CardDescription>\r\n        <CardAction className='mt-2 @md/card:mt-0'>\r\n          <div className=\"flex gap-2 items-center mt-2\">\r\n            <Button\r\n              variant={sortOrder === 'desc' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSortOrder('desc')}\r\n              aria-label=\"Sort Descending\"\r\n            >\r\n              <ChevronDown size={16} />\r\n            </Button>\r\n            <Button\r\n              variant={sortOrder === 'normal' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSortOrder('normal')}\r\n              aria-label=\"Follow Order\"\r\n            >\r\n              <List size={16} />\r\n            </Button>\r\n            <Button\r\n              variant={sortOrder === 'asc' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setSortOrder('asc')}\r\n              aria-label=\"Sort Ascending\"\r\n            >\r\n              <ChevronUp size={16} />\r\n            </Button>\r\n            <Popover>\r\n              <PopoverTrigger asChild>\r\n                <Button variant='outline'>\r\n                  <CalendarIcon />\r\n                  {range?.from && range?.to\r\n                    ? `${range.from.toLocaleDateString()} - ${range.to.toLocaleDateString()}`\r\n                    : `${startOfMonth.toLocaleDateString()} - ${today.toLocaleDateString()}`}\r\n                </Button>\r\n              </PopoverTrigger>\r\n              <PopoverContent className='w-auto overflow-hidden p-0' align='end'>\r\n                <Calendar\r\n                  className='w-full'\r\n                  mode='range'\r\n                  defaultMonth={range?.from}\r\n                  selected={range}\r\n                  onSelect={setRange}\r\n                  fixedWeeks\r\n                  showOutsideDays\r\n                  disabled={{\r\n                    after: today\r\n                  }}\r\n                />\r\n              </PopoverContent>\r\n            </Popover>\r\n          </div>\r\n        </CardAction>\r\n      </CardHeader>\r\n\r\n      <CardContent className='px-4'>\r\n        {/* Chart area: keep size fixed h-89 */}\r\n        <div className=\"relative h-89 w-full\">\r\n          {/* Initial full-screen skeleton when first load and no previous data */}\r\n          {initialLoadingNoData && (\r\n            <div className=\"absolute inset-0 flex items-end px-4\">\r\n              <div className=\"flex w-full h-full items-end gap-3\">\r\n                {Array.from({ length: Math.max(6, chartSeries.length || 6) }).map((_, i) => {\r\n                  const heights = [28, 44, 60, 36, 52, 40]\r\n                  const pct = heights[i % heights.length]\r\n                  return (\r\n                    <div key={i} className=\"flex-1 flex items-end justify-center\">\r\n                      <div className=\"w-3/4\">\r\n                        <Skeleton className=\"rounded-t-md animate-pulse\" style={{ height: `${pct}%` }} />\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* If selected period has no sales (all zeros), show centered muted message */}\r\n          {!initialLoadingNoData && isEmptyPeriod && (\r\n            <div className=\"absolute inset-0 flex items-center justify-center\">\r\n              <div className=\"text-center text-sm text-gray-500\">\r\n                No sales found for the selected period\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Chart (render when not initial-loading and not empty-period). Keeps previous data during revalidation. */}\r\n          {!initialLoadingNoData && !isEmptyPeriod && (\r\n            <div className=\"absolute inset-0 w-full h-full\">\r\n              <ChartContainer config={chartConfig} className='aspect-auto h-89 w-full'>\r\n                <LineChart\r\n                  accessibilityLayer\r\n                  data={chartDisplayData} // <-- use sorted/normal display data\r\n                  margin={{ left: 12, right: 12 }}\r\n                >\r\n                  <CartesianGrid vertical={false} />\r\n                  <XAxis\r\n                    dataKey=\"date\"\r\n                    tickLine={false}\r\n                    axisLine={false}\r\n                    tickMargin={8}\r\n                    minTickGap={20}\r\n                    tickFormatter={value => {\r\n                      const date = parseYmdToLocalDate(String(value))\r\n                      return date.toLocaleDateString(undefined, {\r\n                        month: 'short', // or 'long' if you want full month\r\n                        day: 'numeric'\r\n                      })\r\n                    }}\r\n                  />\r\n                  <ChartTooltip\r\n                    content={\r\n                      <ChartTooltipContent\r\n                        className='w-[200px]'\r\n                        nameKey='customer'\r\n                        labelFormatter={value =>\r\n                          parseYmdToLocalDate(String(value)).toLocaleDateString(undefined, {\r\n                            month: 'short',\r\n                            day: 'numeric',\r\n                            year: 'numeric'\r\n                          })\r\n                        }\r\n                      />\r\n                    }\r\n                  />\r\n                  <Line\r\n                    dataKey=\"customer\"\r\n                    type=\"monotone\"\r\n                    stroke={`var(--color-customer)`}\r\n                    strokeWidth={2}\r\n                    dot={false}\r\n                  />\r\n                </LineChart>\r\n              </ChartContainer>\r\n            </div>\r\n          )}\r\n\r\n          {/* Overlay skeleton when revalidating (keeps previous chart visible underneath) */}\r\n          {!initialLoadingNoData && isUpdating && !isEmptyPeriod && (\r\n            <div\r\n              aria-hidden\r\n              className=\"absolute inset-0 flex items-end px-4 pointer-events-none transition-opacity duration-300 ease-in-out z-20\"\r\n            >\r\n              <div className=\"flex w-full h-full items-end gap-3\">\r\n                {Array.from({ length: Math.max(6, chartSeries.length || 6) }).map((_, i) => {\r\n                  const heights = [28, 44, 60, 36, 52, 40]\r\n                  const pct = heights[i % heights.length]\r\n                  return (\r\n                    <div key={i} className=\"flex-1 flex items-end justify-center\">\r\n                      <div className=\"w-3/4\">\r\n                        <Skeleton className=\"rounded-t-md animate-pulse\" style={{ height: `${pct}%` }} />\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n\r\n      <CardFooter className='border-t'>\r\n        <div className='text-sm'>\r\n          You had <span className='font-semibold'>₱ {total.toLocaleString()}</span> total sales for the selected period.\r\n        </div>\r\n      </CardFooter>\r\n    </Card>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8224, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Dashboard/components/productStats.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useMemo } from 'react'\r\nimport useSWR from 'swr'\r\nimport { CalendarIcon, ChevronDown, ChevronUp, History } from 'lucide-react'\r\nimport type { DateRange } from 'react-day-picker'\r\nimport { Bar, BarChart, CartesianGrid, XAxis } from 'recharts'\r\nimport axios from \"@/lib/axios\"\r\nimport { Button } from '@/components/ui/button'\r\nimport { Calendar } from '@/components/ui/calendar'\r\nimport {\r\n  Card,\r\n  CardAction,\r\n  CardContent,\r\n  CardDescription,\r\n  CardFooter,\r\n  CardHeader,\r\n  CardTitle\r\n} from '@/components/ui/card'\r\nimport type { ChartConfig } from '@/components/ui/chart'\r\nimport { ChartContainer, ChartTooltip, ChartTooltipContent } from '@/components/ui/chart'\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\"\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\n\r\ntype ProductSaleItem = {\r\n  product_name: string\r\n  total_sales: number\r\n  quantity: number\r\n  price: number\r\n  unit: string\r\n  last_purchase: string\r\n}\r\n\r\ntype ProductDetail = {\r\n  name: string\r\n  qty: number\r\n  price: number\r\n  total: number\r\n  unit: string\r\n  last_purchase: string\r\n}\r\n\r\ntype ChartData = ProductSaleItem\r\n\r\nconst chartConfig: ChartConfig = {\r\n  total_sales: {\r\n    label: 'Total Sales',\r\n    color: 'var(--color-primary)'\r\n  }\r\n}\r\n\r\nconst fetcher = async (url: string) => {\r\n  const response = await axios.get(url)\r\n  return response.data?.data || response.data || []\r\n}\r\n\r\nexport default function ProductStats() {\r\n  const today = new Date()\r\n  const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\r\n\r\n  const [range, setRange] = useState<DateRange | undefined>({\r\n    from: startOfMonth,\r\n    to: today\r\n  })\r\n  // Change the default sort order from 'desc' to 'recent':\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc' | 'recent'>('recent')\r\n  \r\n  // State declarations\r\n  const [open, setOpen] = useState(false)\r\n  const [selectedProduct, setSelectedProduct] = useState<string | null>(null)\r\n  const [productDetails, setProductDetails] = useState<ProductDetail[]>([])\r\n  const [loadingDetails, setLoadingDetails] = useState(false)\r\n  // Also change the table sort order default:\r\n  const [tableSortOrder, setTableSortOrder] = useState<'asc' | 'desc' | 'recent'>('recent')\r\n  const [productLimit, setProductLimit] = useState(15)\r\n\r\n  // FIXED: Use a different approach - fetch from multiple categories\r\n  const productSalesUrl = useMemo(() => {\r\n    const params = new URLSearchParams()\r\n    if (range?.from) params.set('from_date', range.from.toISOString())\r\n    if (range?.to) params.set('to_date', range.to.toISOString())\r\n    // We'll fetch from a specific category first to test\r\n    params.set('category_name', 'Lane 3') // Start with one category\r\n    return `/sales-items/products-by-category?${params.toString()}`\r\n  }, [range])\r\n\r\n  // Fetch product sales data\r\n  const { data: productSales = [], error, isLoading, isValidating } = useSWR(\r\n    productSalesUrl,\r\n    fetcher,\r\n    { keepPreviousData: true, revalidateOnFocus: false }\r\n  )\r\n\r\n  // Transform the data to match our expected format\r\n  const productSalesData = useMemo(() => {\r\n    if (productSales.length === 0) return []\r\n    \r\n    const productMap = new Map<string, ProductSaleItem>()\r\n    \r\n    productSales.forEach((item: any) => {\r\n      const productName = item.product_name || 'Unknown Product'\r\n      const existing = productMap.get(productName)\r\n      \r\n      if (existing) {\r\n        existing.total_sales += Number(item.total) || 0\r\n        existing.quantity += Number(item.qty) || 0\r\n        // Keep the most recent purchase date\r\n        if (new Date(item.last_purchase) > new Date(existing.last_purchase)) {\r\n          existing.last_purchase = item.last_purchase\r\n        }\r\n      } else {\r\n        productMap.set(productName, {\r\n          product_name: productName,\r\n          total_sales: Number(item.total) || 0,\r\n          quantity: Number(item.qty) || 0,\r\n          price: Number(item.price) || 0,\r\n          unit: item.unit || 'pcs',\r\n          last_purchase: item.last_purchase\r\n        })\r\n      }\r\n    })\r\n    \r\n    const result = Array.from(productMap.values())\r\n    console.log('Product sales data:', result)\r\n    return result\r\n  }, [productSales])\r\n\r\n  // Fetch products to get product names and units\r\n  const { data: allProducts = [] } = useSWR(\r\n    '/products?limit=all',\r\n    fetcher,\r\n    { keepPreviousData: true, revalidateOnFocus: false }\r\n  )\r\n\r\n  // Create a map of product_id to product info\r\n  const productMap = useMemo(() => {\r\n    const map = new Map<number, any>()\r\n    allProducts.forEach((product: any) => {\r\n      map.set(product.id, product)\r\n    })\r\n    return map\r\n  }, [allProducts])\r\n\r\n  // Fix the handleBarClick function:\r\n  const handleBarClick = async (data: any) => {\r\n    console.log('Clicked product:', data.product_name)\r\n    setSelectedProduct(data.product_name)\r\n    setOpen(true)\r\n    setLoadingDetails(true)\r\n\r\n    try {\r\n      // Filter the productSales data for this specific product\r\n      const productSalesItems = productSales.filter((item: any) => \r\n        item.product_name === data.product_name\r\n      )\r\n\r\n      console.log('Filtered product sales items:', productSalesItems)\r\n\r\n      const transformedDetails = productSalesItems.map((item: any) => ({\r\n        name: item.product_name,\r\n        qty: Number(item.qty) || 0,\r\n        price: Number(item.price) || 0,\r\n        total: Number(item.total) || 0,\r\n        unit: item.unit || 'pcs',\r\n        last_purchase: item.last_purchase\r\n      }))\r\n\r\n      console.log('Transformed product details:', transformedDetails)\r\n      setProductDetails(transformedDetails)\r\n    } catch (error: any) {\r\n      console.error('Error fetching product details:', error)\r\n      setProductDetails([])\r\n    } finally {\r\n      setLoadingDetails(false)\r\n    }\r\n  }\r\n\r\n  // Sort table data locally based on tableSortOrder\r\n  const sortedProductDetails = useMemo(() => {\r\n    switch (tableSortOrder) {\r\n      case 'asc':\r\n        return [...productDetails].sort((a, b) => (a.total || 0) - (b.total || 0))\r\n      case 'desc':\r\n        return [...productDetails].sort((a, b) => (b.total || 0) - (a.total || 0))\r\n      case 'recent':\r\n      default:\r\n        return [...productDetails].sort((a, b) => {\r\n          const ta = a.last_purchase ? new Date(a.last_purchase).getTime() : 0\r\n          const tb = b.last_purchase ? new Date(b.last_purchase).getTime() : 0\r\n          return tb - ta\r\n        })\r\n    }\r\n  }, [productDetails, tableSortOrder])\r\n\r\n  // Compute total of product details currently shown in modal\r\n  const productDetailsTotal = productDetails.reduce((acc, p) => acc + (Number(p.total) || 0), 0)\r\n\r\n  // Chart data with sorting\r\n  const chartData = useMemo(() => {\r\n    const arr = productSalesData.map(item => ({\r\n      product_name: item.product_name,\r\n      total_sales: item.total_sales,\r\n      quantity: item.quantity,\r\n      price: item.price,\r\n      unit: item.unit,\r\n      last_purchase: item.last_purchase\r\n    }))\r\n\r\n    // Debug log to see the actual data\r\n    console.log('Product chart data before sorting:', arr)\r\n    console.log('Total sales sum:', arr.reduce((acc, curr) => acc + curr.total_sales, 0))\r\n    \r\n    // Debug each product's total\r\n    arr.forEach(item => {\r\n      console.log(`Product: ${item.product_name}, Total Sales: ₱${item.total_sales.toLocaleString()}`)\r\n    })\r\n\r\n    // Sort first, then limit to the specified number of products\r\n    let sorted\r\n    switch (sortOrder) {\r\n      case 'asc': \r\n        sorted = [...arr].sort((a, b) => a.total_sales - b.total_sales)\r\n        break\r\n      case 'desc': \r\n        sorted = [...arr].sort((a, b) => b.total_sales - a.total_sales)\r\n        break\r\n      case 'recent': \r\n        sorted = [...arr].sort((a, b) => new Date(b.last_purchase).getTime() - new Date(a.last_purchase).getTime())\r\n        break\r\n      default: \r\n        sorted = [...arr].sort((a, b) => b.total_sales - a.total_sales)\r\n    }\r\n    \r\n    // Limit to the specified number of products\r\n    return sorted.slice(0, productLimit)\r\n  }, [productSalesData, sortOrder, productLimit]) // Add productLimit to dependencies\r\n\r\n  const total = useMemo(() => chartData.reduce((acc, curr) => acc + curr.total_sales, 0), [chartData])\r\n\r\n  // Initial empty state: show skeleton full-chart if first load and no data\r\n  const initialLoadingNoData = isLoading && productSalesData.length === 0\r\n  // Updating overlay while revalidating (keep previous chart visible)\r\n  const isUpdating = isValidating && productSalesData.length > 0\r\n\r\n  return (\r\n    <>\r\n      <Card className='@container/card w-full relative'>\r\n        <CardHeader className='flex flex-col border-b @md/card:grid'>\r\n          <CardTitle>Product Analytics</CardTitle>\r\n          <CardDescription>Showing highest selling products for this month.</CardDescription>\r\n          <CardAction className='mt-2 @md/card:mt-0'>\r\n            <div className=\"flex gap-2 items-center mt-2\">\r\n              {/* Add the input field here */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <label className=\"text-sm font-medium\">Show:</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"5\"\r\n                  max=\"50\"\r\n                  value={productLimit}\r\n                  onChange={(e) => setProductLimit(Number(e.target.value))}\r\n                  className=\"w-16 px-2 py-1 border rounded text-sm text-center\"\r\n                />\r\n                <span className=\"text-sm text-gray-600\">products</span>\r\n              </div>\r\n              \r\n              <Button onClick={() => setSortOrder('desc')} variant={sortOrder === 'desc' ? 'default' : 'outline'} size=\"sm\">\r\n                <ChevronDown size={16} />\r\n              </Button>\r\n              <Button onClick={() => setSortOrder('recent')} variant={sortOrder === 'recent' ? 'default' : 'outline'} size=\"sm\">\r\n                <History size={16} />\r\n              </Button>\r\n              <Button onClick={() => setSortOrder('asc')} variant={sortOrder === 'asc' ? 'default' : 'outline'} size=\"sm\">\r\n                <ChevronUp size={16} />\r\n              </Button>\r\n              <Popover>\r\n                <PopoverTrigger asChild>\r\n                  <Button variant='outline'>\r\n                    <CalendarIcon />\r\n                    {range?.from && range?.to\r\n                      ? `${range.from.toLocaleDateString()} - ${range.to.toLocaleDateString()}`\r\n                      : `${startOfMonth.toLocaleDateString()} - ${today.toLocaleDateString()}`}\r\n                  </Button>\r\n                </PopoverTrigger>\r\n                <PopoverContent className='w-auto p-0' align='end'>\r\n                  <Calendar mode='range' defaultMonth={range?.from} selected={range} onSelect={setRange} fixedWeeks showOutsideDays disabled={{ after: today }} />\r\n                </PopoverContent>\r\n              </Popover>\r\n            </div>\r\n          </CardAction>\r\n        </CardHeader>\r\n\r\n        <CardContent className='px-4'>\r\n          <div className=\"relative h-89 w-full\">\r\n            <div className=\"absolute inset-0 z-10 flex items-center justify-center\">\r\n              {chartData.length > 0 ? (\r\n                <div className=\"w-full h-full\">\r\n                  <ChartContainer config={chartConfig} className='aspect-auto h-89 w-full'>\r\n                    <BarChart data={chartData} margin={{ left: 12, right: 12 }}>\r\n                      <CartesianGrid vertical={false} />\r\n                      <XAxis \r\n                        dataKey='product_name' \r\n                        tickLine={false} \r\n                        axisLine={false} \r\n                        tickMargin={8} \r\n                        minTickGap={20}\r\n                        angle={-45}\r\n                        textAnchor=\"end\"\r\n                        height={100}\r\n                      />\r\n                      <ChartTooltip\r\n                        content={\r\n                          <ChartTooltipContent\r\n                            className='w-[200px]'\r\n                            nameKey='total_sales'\r\n                            labelFormatter={v => v}\r\n                            formatter={(value, name, props) => {\r\n                              console.log('Tooltip data:', { value, name, props })\r\n                              return [\r\n                                `₱ ${Number(value).toLocaleString()}`,\r\n                                ''\r\n                              ]\r\n                            }}\r\n                          />\r\n                        }\r\n                      />\r\n                      <Bar dataKey='total_sales' fill={`var(--color-total_sales)`} radius={4} onClick={handleBarClick} />\r\n                    </BarChart>\r\n                  </ChartContainer>\r\n                </div>\r\n              ) : (\r\n                <div className=\"w-full h-full flex items-center justify-center px-4\">\r\n                  {error ? (\r\n                    <div className=\"text-sm text-red-600\">Error loading product stats.</div>\r\n                  ) : (!isLoading && productSalesData.length === 0) ? (\r\n                    <div className=\"text-sm text-gray-600\">No data for the selected range.</div>\r\n                  ) : (\r\n                    <div className=\"w-full h-full\" />\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Skeleton overlay */}\r\n            <div\r\n              aria-hidden\r\n              className={`absolute inset-0 z-20 flex items-end px-4 pointer-events-none transition-opacity duration-300 ease-in-out ${(isUpdating || initialLoadingNoData) ? 'opacity-100' : 'opacity-0'\r\n                }`}\r\n            >\r\n              <div className=\"flex w-full h-full items-end gap-3\">\r\n                {Array.from({ length: Math.max(6, chartData.length || 6) }).map((_, i) => {\r\n                  const heights = [28, 44, 60, 36, 52, 40]\r\n                  const pct = heights[i % heights.length]\r\n                  return (\r\n                    <div key={i} className=\"flex-1 flex items-end justify-center\">\r\n                      <div className=\"w-3/4\">\r\n                        <Skeleton className=\"rounded-t-md animate-pulse\" style={{ height: `${pct}%` }} />\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n\r\n        <CardFooter className='border-t'>\r\n          <div className='text-sm'>\r\n            Total sales: <span className='font-semibold'>₱ {total.toLocaleString()}</span>\r\n          </div>\r\n        </CardFooter>\r\n      </Card>\r\n\r\n      {/* Modal with product details */}\r\n      <Dialog open={open} onOpenChange={setOpen}>\r\n        <DialogContent className=\"w-full max-w-5xl sm:max-w-4xl md:max-w-3xl lg:max-w-5xl xl:max-w-6xl\">\r\n          <DialogHeader className=\"flex flex-row items-center justify-between\">\r\n            <div>\r\n              <DialogTitle className=\"text-lg font-semibold items-center\">\r\n                {selectedProduct ? `${selectedProduct} — Total Amount: ₱ ${productDetailsTotal.toLocaleString()}` : `₱ ${productDetailsTotal.toLocaleString()}`}\r\n              </DialogTitle>\r\n              <div className=\"text-sm text-gray-600 mt-1\">\r\n                Total Quantity Sold: {productDetails.reduce((acc, p) => acc + p.qty, 0).toLocaleString()} {productDetails[0]?.unit || 'units'}\r\n              </div>\r\n            </div>\r\n            <div className=\"flex gap-2 pr-4\">\r\n              <Button\r\n                onClick={() => setTableSortOrder('desc')}\r\n                variant={tableSortOrder === 'desc' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <ChevronDown size={16} />\r\n              </Button>\r\n              <Button\r\n                onClick={() => setTableSortOrder('recent')}\r\n                variant={tableSortOrder === 'recent' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <History size={16} />\r\n              </Button>\r\n              <Button\r\n                onClick={() => setTableSortOrder('asc')}\r\n                variant={tableSortOrder === 'asc' ? 'default' : 'outline'}\r\n                size=\"icon\"\r\n                className=\"w-8 h-8\"\r\n              >\r\n                <ChevronUp size={16} />\r\n              </Button>\r\n            </div>\r\n          </DialogHeader>\r\n\r\n          <ScrollArea className=\"h-80 mt-4 rounded-md border bg-white\">\r\n            {loadingDetails && productDetails.length === 0 && (\r\n              <div className=\"p-4 text-center text-gray-600\">Loading product details…</div>\r\n            )}\r\n\r\n            {sortedProductDetails.length > 0 ? (\r\n              <>\r\n                {loadingDetails && (\r\n                  <div className=\"p-2 text-sm text-gray-600 border-b\">Updating details…</div>\r\n                )}\r\n                <table className=\"w-full text-sm border-collapse\">\r\n                  <thead className=\"bg-gray-100 sticky top-0\">\r\n                    <tr>\r\n                      <th className=\"p-2 border text-left font-semibold\">Product</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Quantity Sold</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Unit Price</th>\r\n                      <th className=\"p-2 border text-center font-semibold\">Total</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {sortedProductDetails.map((p, idx) => (\r\n                      <tr key={idx} className=\"hover:bg-gray-50 transition\">\r\n                        <td className=\"p-2 border font-medium\">{p.name}</td>\r\n                        <td className=\"p-2 border text-center font-semibold text-blue-600\">\r\n                          {p.qty.toLocaleString()} {p.unit}\r\n                        </td>\r\n                        <td className=\"p-2 border text-left\">₱ {p.price.toLocaleString()}</td>\r\n                        <td className=\"p-2 border text-left font-semibold\">₱ {p.total.toLocaleString()}</td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </>\r\n            ) : (\r\n              !loadingDetails && (\r\n                <p className=\"p-4 text-center text-gray-500\">No details found for this product.</p>\r\n              )\r\n            )}\r\n          </ScrollArea>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/Dashboard/dashboardScreen.tsx"],"sourcesContent":["import Stats from './components/stats';\r\nimport CategoryStats from './components/categoryStats';\r\nimport SalesStats from './components/salesStats';\r\nimport ProductStats from './components/productStats';\r\nexport default function DashboardScreen() {\r\n    return (\r\n        <div className=\"flex flex-col p-6 h-full gap-3\">\r\n            <div className=\"flex-[7%]\">\r\n                <h1 className=\"font-extrabold text-4xl\">Dashboard</h1>\r\n                <p>Welcome Back! Here's your business overview!</p>\r\n            </div>\r\n            <div className=\"flex-[20%]\"><Stats /></div>\r\n            <div className=\"flex-[78%] flex gap-3 flex-col\">\r\n                <div className=\"flex-[50%] mb-4\"><SalesStats /></div>\r\n                <div className=\"flex-[50%] mb-2\"><CategoryStats /></div>\r\n                <div className=\"flex-[50%] mb-2\"><ProductStats /></div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AACe,SAAS;IACpB,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAG,WAAU;kCAA0B;;;;;;kCACxC,6LAAC;kCAAE;;;;;;;;;;;;0BAEP,6LAAC;gBAAI,WAAU;0BAAa,cAAA,6LAAC,oLAAK;;;;;;;;;;0BAClC,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;kCAAkB,cAAA,6LAAC,yLAAU;;;;;;;;;;kCAC5C,6LAAC;wBAAI,WAAU;kCAAkB,cAAA,6LAAC,4LAAa;;;;;;;;;;kCAC/C,6LAAC;wBAAI,WAAU;kCAAkB,cAAA,6LAAC,2LAAY;;;;;;;;;;;;;;;;;;;;;;AAI9D;KAfwB","debugId":null}},
    {"offset": {"line": 9305, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/components/addProductModal.tsx"],"sourcesContent":["'use client'\r\nimport React, {\r\n  useCallback,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react'\r\nimport { CheckIcon, ChevronsUpDownIcon } from 'lucide-react'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n  Command,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandInput,\r\n  CommandItem,\r\n  CommandList,\r\n} from '@/components/ui/command'\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\r\nimport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { cn } from '@/lib/utils'\r\nimport Fuse from 'fuse.js'\r\nimport { useProducts } from '@/hooks/global/fetching/useProducts'\r\n\r\nconst FALLBACK_PRODUCTS = [\r\n  { value: 'widget-a', label: 'Widget A' },\r\n  { value: 'widget-b', label: 'Widget B' },\r\n  { value: 'gadget-x', label: 'Gadget X' },\r\n  { value: 'gadget-y', label: 'Gadget Y' },\r\n  { value: 'part-123', label: 'Part 123' },\r\n]\r\n\r\ntype Props = { onAdd: (p: { name: string; qty: number; unitPrice: number; productId?: string | number | null }) => void }\r\n\r\nexport default function AddProductModal({ onAdd }: Props) {\r\n  const [dialogOpen, setDialogOpen] = useState(false)\r\n  const [popOpen, setPopOpen] = useState(false)\r\n  const [query, setQuery] = useState('')\r\n  const [selected, setSelected] = useState<string>('') // product id or fallback value\r\n  const [qty, setQty] = useState<number>(1)\r\n  const [unitPrice, setUnitPrice] = useState<number | ''>('')\r\n  const qtyRef = useRef<HTMLInputElement | null>(null)\r\n\r\n  const triggerRef = useRef<HTMLButtonElement | null>(null)\r\n  const [triggerWidth, setTriggerWidth] = useState<number | null>(null)\r\n\r\n  const { products: apiProducts, loading, error } = useProducts()\r\n\r\n  // normalize product list for the command component\r\n  const productItems = useMemo(\r\n    () =>\r\n      apiProducts && apiProducts.length > 0\r\n        ? apiProducts.map((p) => ({ value: String(p.id), label: p.name ?? `#${p.id}` }))\r\n        : FALLBACK_PRODUCTS,\r\n    [apiProducts]\r\n  )\r\n\r\n  useEffect(() => {\r\n    if (dialogOpen && selected) {\r\n      setTimeout(() => qtyRef.current?.focus(), 60)\r\n    }\r\n  }, [dialogOpen, selected])\r\n\r\n  // measure trigger width so popover can match it\r\n  useLayoutEffect(() => {\r\n    const update = () => setTriggerWidth(triggerRef.current?.offsetWidth ?? null)\r\n    update()\r\n    window.addEventListener('resize', update)\r\n    return () => window.removeEventListener('resize', update)\r\n  }, [])\r\n\r\n  // when the popover opens ensure width is up-to-date\r\n  useEffect(() => {\r\n    if (popOpen) {\r\n      setTriggerWidth(triggerRef.current?.offsetWidth ?? null)\r\n    }\r\n  }, [popOpen, selected])\r\n\r\n  // robust, memoized filtering (normalizes unicode and checks both label and value)\r\n  const fuse = useMemo(() => {\r\n    return new Fuse(productItems, {\r\n      keys: ['label'],\r\n      threshold: 0.30, // adjust fuzziness if needed\r\n      ignoreLocation: true,\r\n      minMatchCharLength: 1,\r\n    })\r\n  }, [productItems])\r\n\r\n  const filtered = useMemo(() => {\r\n    const qRaw = query.trim()\r\n    if (!qRaw) return productItems\r\n\r\n    const tokens = qRaw\r\n      .toLowerCase()\r\n      .split(/\\s+/)\r\n      .filter(Boolean)\r\n\r\n    const strictMatches = productItems.filter((p) => {\r\n      const label = String(p.label ?? '').normalize('NFKC').toLowerCase()\r\n      return tokens.every((t) => label.includes(t))\r\n    })\r\n\r\n    if (strictMatches.length > 0) return strictMatches\r\n\r\n    // Fuse will only search label (product name)\r\n    return fuse.search(qRaw).map((r) => r.item)\r\n  }, [fuse, query, productItems])\r\n\r\n  // DEBUG: log what the modal sees so we can diagnose \"No product found\" even though network returned data\r\n  useEffect(() => {\r\n    try {\r\n      console.log('[AddProductModal] apiProducts.length=', apiProducts?.length ?? 0)\r\n      console.log('[AddProductModal] sample apiProducts=', (apiProducts ?? []).slice(0, 5))\r\n      console.log('[AddProductModal] productItems.length=', productItems.length)\r\n      console.log('[AddProductModal] sample productItems=', productItems.slice(0, 8))\r\n      console.log('[AddProductModal] query=', JSON.stringify(query), 'filtered.length=', filtered.length)\r\n      console.log('[AddProductModal] sample filtered=', filtered.slice(0, 8))\r\n    } catch (e) {\r\n      console.error('[AddProductModal] debug error', e)\r\n    }\r\n  }, [apiProducts, productItems, query, filtered])\r\n\r\n  const handleSubmit = useCallback(\r\n    (e: React.FormEvent) => {\r\n      e.preventDefault()\r\n      if (!selected || qty < 1 || unitPrice === '' || Number(unitPrice) < 0) return\r\n      const label = productItems.find((p) => p.value === selected)?.label ?? selected\r\n      // if selection corresponds to an API product, pass its id along\r\n      const apiId = apiProducts?.find((ap: any) => String(ap.id) === selected)?.id ?? null\r\n      if (typeof onAdd === 'function') {\r\n        onAdd({ name: label, qty, unitPrice: Number(unitPrice), productId: apiId })\r\n      } else {\r\n        try {\r\n          window.dispatchEvent(\r\n            new CustomEvent('stock:addProduct', {\r\n              detail: { name: label, qty, unitPrice: Number(unitPrice), productId: apiId },\r\n            })\r\n          )\r\n        } catch {\r\n          // noop\r\n        }\r\n      }\r\n\r\n      setSelected('')\r\n      setQty(1)\r\n      setUnitPrice('')\r\n      setQuery('')\r\n      setDialogOpen(false)\r\n    },\r\n    [selected, qty, unitPrice, productItems, onAdd]\r\n  )\r\n  useEffect(() => {\r\n    if (error) {\r\n      // Log the error coming from useProducts to the browser console\r\n      console.error('useProducts error:', error)\r\n    }\r\n  }, [error])\r\n  return (\r\n    <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button variant=\"outline\" className=\"h-8\">\r\n          Add\r\n        </Button>\r\n      </DialogTrigger>\r\n\r\n      <DialogContent className=\"sm:max-w-[425px]\">\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogHeader>\r\n            <DialogTitle>Add Product</DialogTitle>\r\n            <div className=\"text-sm text-muted-foreground\">Search and add a product with quantity and unit price.</div>\r\n          </DialogHeader>\r\n\r\n          <div className=\"grid gap-4 py-2\">\r\n            <div className=\"grid gap-2\">\r\n              <Label htmlFor=\"product-combobox\">Product</Label>\r\n\r\n              <Popover open={popOpen} onOpenChange={setPopOpen}>\r\n                <PopoverTrigger asChild>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    role=\"combobox\"\r\n                    aria-expanded={popOpen}\r\n                    className=\"w-full justify-between text-left overflow-hidden\"\r\n                    aria-label=\"Product combobox\"\r\n                    id=\"product-combobox\"\r\n                    ref={triggerRef}\r\n                    type=\"button\"\r\n                  >\r\n                    <span className=\"flex-1 min-w-0 truncate pr-2 text-left\">\r\n                      {selected ? productItems.find((p) => p.value === selected)?.label ?? selected : 'Select product...'}\r\n                    </span>\r\n                    <ChevronsUpDownIcon className=\"opacity-50\" />\r\n                  </Button>\r\n                </PopoverTrigger>\r\n\r\n                <PopoverContent\r\n                  className=\"p-3 min-w-[280px] max-w-[640px]\"\r\n                  align=\"start\"\r\n                  side=\"bottom\"\r\n                  style={triggerWidth ? { width: `${triggerWidth}px` } : undefined}\r\n                >\r\n                  <div>\r\n                    <Input\r\n                      placeholder=\"Search product...\"\r\n                      className=\"h-9 mb-2\"\r\n                      value={query}\r\n                      onChange={(e) => setQuery(e.target.value)}\r\n                      autoFocus\r\n                    />\r\n\r\n                    {loading ? (\r\n                      <div className=\"p-2 text-sm\">Loading products...</div>\r\n                    ) : filtered.length === 0 ? (\r\n                      <div className=\"p-2 text-sm text-muted-foreground\">\r\n                        {`No product found for \"${query}\". products=${productItems.length} filtered=${filtered.length}`}\r\n                      </div>\r\n                    ) : (\r\n                      <ul className=\"max-h-56 overflow-auto divide-y rounded-md bg-background\">\r\n                        {filtered.map((it) => (\r\n                          <li key={it.value}>\r\n                            <button\r\n                              type=\"button\"\r\n                              className=\"w-full text-left px-3 py-2 hover:bg-muted-foreground/5 flex items-center gap-3\"\r\n                              onClick={() => {\r\n                                setSelected(it.value)\r\n                                setPopOpen(false)\r\n                                setTimeout(() => qtyRef.current?.focus(), 60)\r\n                              }}\r\n                            >\r\n                              <span className=\"flex-1 truncate\">{String(it.label)}</span>\r\n\r\n                            </button>\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    )}\r\n                  </div>\r\n                </PopoverContent>\r\n              </Popover>\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label htmlFor=\"qty\">Quantity</Label>\r\n              <Input\r\n                id=\"qty\"\r\n                ref={qtyRef}\r\n                type=\"number\"\r\n                min={1}\r\n                value={String(qty)}\r\n                onChange={(e) => setQty(Math.max(1, Number(e.target.value) || 1))}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label htmlFor=\"unit-price\">Unit price (purchased)</Label>\r\n              <Input\r\n                id=\"unit-price\"\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                min={0}\r\n                value={unitPrice === '' ? '' : String(unitPrice)}\r\n                onChange={(e) => setUnitPrice(e.target.value === '' ? '' : Math.max(0, Number(e.target.value)))}\r\n                placeholder=\"0.00\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <DialogClose asChild>\r\n              <Button variant=\"outline\">Cancel</Button>\r\n            </DialogClose>\r\n            <Button type=\"submit\" disabled={!selected || qty < 1 || unitPrice === ''}>\r\n              Add\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9875, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/components/addStockModal.tsx"],"sourcesContent":["'use client'\r\nimport { useState, useEffect } from \"react\";\r\nimport { ChevronLeft as ChevronLeftIcon, Plus, X, Calendar as CalendarIcon } from \"lucide-react\";\r\nimport { useSWRConfig } from 'swr'\r\nimport axios from \"@/lib/axios\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogClose,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport {\r\n    Card,\r\n    CardAction,\r\n    CardContent,\r\n    CardDescription,\r\n    CardHeader,\r\n    CardTitle,\r\n} from \"@/components/ui/card\";\r\nimport AddProductModal from \"./addProductModal\";\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableFooter,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow\r\n} from '@/components/ui/table'\r\n\r\ntype ProductItem = { id: string; productId?: string | number | null; name: string; qty: number; unitPrice: number };\r\ntype StockPayload = { company: string; date: string; price: number; products: ProductItem[] };\r\ntype Props = { onSave?: (payload: StockPayload) => void };\r\n\r\nexport default function AddStockModal({ onSave }: Props) {\r\n    const [open, setOpen] = useState(false);\r\n    const [month, setMonth] = useState<Date | undefined>(new Date());\r\n    useEffect(() => {\r\n        const handler = (e: Event) => {\r\n            const ce = e as CustomEvent<{ name: string; qty: number; unitPrice: number }>;\r\n            if (ce?.detail) {\r\n                handleAddProduct(ce.detail)\r\n            }\r\n        }\r\n        window.addEventListener('stock:addProduct', handler as EventListener)\r\n        return () => window.removeEventListener('stock:addProduct', handler as EventListener)\r\n    }, [])\r\n\r\n    const [company, setCompany] = useState(\"\");\r\n    const [date, setDate] = useState<Date | undefined>(undefined);\r\n    const [price, setPrice] = useState<number | \"\">(\"\");\r\n    const [products, setProducts] = useState<ProductItem[]>([])\r\n    const [saving, setSaving] = useState(false);\r\n    const { mutate } = useSWRConfig()\r\n\r\n    const handleSave = async () => {\r\n        if (!company || products.length === 0) {\r\n            // minimal validation\r\n            alert('Company and at least one product are required.')\r\n            return\r\n        }\r\n\r\n        const payload = {\r\n            company_name: company,\r\n            date: date ? date.toISOString() : new Date().toISOString(),\r\n            total: Number(price) || 0,\r\n            items: products.map(p => ({\r\n                product_id: p.productId ?? null,\r\n                purchased_price: p.unitPrice ?? (Number(price) || 0),\r\n                quantity: p.qty\r\n            }))\r\n        }\r\n\r\n        try {\r\n            setSaving(true)\r\n            const endpoint = `/stock-transactions`;\r\n            const res = await axios.post(endpoint, payload);\r\n            const json = res.data;\r\n            if (res.status >= 400) throw new Error(json?.message || json?.error || 'Save failed')\r\n\r\n            // notify parent if needed\r\n            onSave?.({\r\n                company,\r\n                date: date ? date.toISOString() : new Date().toISOString(),\r\n                price: Number(price) || 0,\r\n                products,\r\n            })\r\n\r\n            // revalidate stock transactions SWR cache\r\n            mutate(endpoint)\r\n\r\n            // reset and close\r\n            setCompany(\"\")\r\n            setDate(undefined)\r\n            setPrice(\"\")\r\n            setProducts([])\r\n            setOpen(false)\r\n        } catch (err: any) {\r\n            console.error('save stock error', err)\r\n            alert(`Save failed: ${err?.message ?? err}`)\r\n        } finally {\r\n            setSaving(false)\r\n        }\r\n    };\r\n\r\n    // Merge same product by name: increase qty and update unitPrice to the newly provided one\r\n    const handleAddProduct = (p: { name: string; qty: number; unitPrice: number; productId?: string | number | null }) => {\r\n        setProducts(prev => {\r\n            // prefer matching by productId when available, otherwise fallback to name\r\n            const idx = prev.findIndex(x => (p.productId != null ? x.productId === p.productId : x.name === p.name))\r\n            if (idx !== -1) {\r\n                const updated = [...prev]\r\n                updated[idx] = {\r\n                    ...updated[idx],\r\n                    qty: updated[idx].qty + p.qty,\r\n                    unitPrice: p.unitPrice,\r\n                    productId: updated[idx].productId ?? p.productId\r\n                }\r\n                return updated\r\n            }\r\n            return [\r\n                ...prev,\r\n                { id: `${Date.now()}-${Math.random().toString(36).slice(2, 9)}`, productId: p.productId ?? null, name: p.name, qty: p.qty, unitPrice: p.unitPrice }\r\n            ]\r\n        })\r\n    };\r\n\r\n    const handleRemoveProduct = (id: string) => {\r\n        setProducts(prev => prev.filter(p => p.id !== id));\r\n    };\r\n\r\n    // Update a product field (qty or unitPrice)\r\n    const updateProductField = (id: string, field: 'qty' | 'unitPrice', value: string | number) => {\r\n        setProducts(prev =>\r\n            prev.map(p => {\r\n                if (p.id !== id) return p\r\n                const parsed = field === 'qty' ? Math.max(0, Math.floor(Number(value) || 0)) : Math.max(0, Number(value) || 0)\r\n                return { ...p, [field]: parsed }\r\n            })\r\n        )\r\n    }\r\n\r\n    const total = products.reduce((sum, p) => sum + p.qty * p.unitPrice, 0)\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                <Button className=\"h-full flex items-center gap-2\">\r\n                    <Plus size={16} />\r\n                    Add Stocks\r\n                </Button>\r\n            </DialogTrigger>\r\n\r\n            <DialogContent className=\" flex h-[calc(80vh-2rem)] min-w-[calc(80vw-2rem)] flex-col justify-between gap-0 p-0\">\r\n                <ScrollArea className=\"flex-1 overflow-hidden\">\r\n                    <DialogHeader className=\"contents space-y-0 text-left\">\r\n                        <DialogTitle className=\"px-6 pt-6\">Add Stock</DialogTitle>\r\n                        <DialogDescription asChild>\r\n                            <div className=\"pt-2 px-6\">\r\n                                <p className=\"text-sm text-muted-foreground\">Enter stock details and add products.</p>\r\n                            </div>\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n\r\n                    <div className=\"px-6 pt-2\">\r\n                        <div className=\"flex w-full gap-6\">\r\n                            {/* Left column - basic info */}\r\n                            <div className=\"flex-[40%] \">\r\n                                <div className=\"mt-2\">\r\n                                    <label className=\"text-sm block mb-1\">Company</label>\r\n                                    <Input value={company} onChange={(e) => setCompany(e.target.value)} placeholder=\"Company name\" />\r\n                                </div>\r\n\r\n                                <div className=\"mt-2\">\r\n                                    <label className=\"text-sm block mb-1\">Date</label>\r\n                                    <Popover>\r\n                                        <PopoverTrigger asChild>\r\n                                            <Button\r\n                                                variant=\"outline\"\r\n                                                className=\"w-full h-10 justify-between text-left px-3\"\r\n                                                type=\"button\"\r\n                                                aria-label=\"Choose date\"\r\n                                            >\r\n                                                <span className=\"truncate\">\r\n                                                    {date ? date.toLocaleDateString() : 'mm/dd/yyyy'}\r\n                                                </span>\r\n                                                <CalendarIcon className=\"ml-2 opacity-70\" />\r\n                                            </Button>\r\n                                        </PopoverTrigger>\r\n\r\n                                        <PopoverContent className=\"w-auto p-2\">\r\n                                            <Card className=\"w-[290px]\">\r\n                                                <CardHeader className=\"flex items-start gap-2\">\r\n                                                    <div>\r\n                                                        <CardDescription className=\"text-xs text-muted-foreground\">\r\n                                                            <CardTitle className=\"text-sm\">Choose date</CardTitle>\r\n                                                            Select a date for this stock entry\r\n                                                        </CardDescription>\r\n                                                    </div>\r\n                                                    <CardAction>\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"outline\"\r\n                                                            onClick={() => {\r\n                                                                const now = new Date()\r\n                                                                setMonth(now)\r\n                                                                setDate(now)\r\n                                                            }}\r\n                                                        >\r\n                                                            Today\r\n                                                        </Button>\r\n                                                    </CardAction>\r\n                                                </CardHeader>\r\n                                                <CardContent className=\"p-2\">\r\n                                                    <Calendar\r\n                                                        mode=\"single\"\r\n                                                        month={month}\r\n                                                        onMonthChange={setMonth}\r\n                                                        selected={date}\r\n                                                        onSelect={setDate}\r\n                                                        className=\"bg-transparent p-0 rounded-md\"\r\n                                                    />\r\n                                                </CardContent>\r\n                                            </Card>\r\n                                        </PopoverContent>\r\n                                    </Popover>\r\n                                </div>\r\n\r\n                                <div className=\"mt-2\">\r\n                                    <label className=\"text-sm block mb-1\">Price</label>\r\n                                    <Input\r\n                                        type=\"number\"\r\n                                        step=\"0.01\"\r\n                                        value={price === \"\" ? \"\" : String(price)}\r\n                                        onChange={(e) => setPrice(e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n                                        placeholder=\"0.00\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Right column - products */}\r\n                            <div className=\"flex flex-col h-full flex-[60%]\">\r\n                                <div className=\"flex items-center justify-between mb-3\">\r\n                                    <h3 className=\"font-medium\">Products</h3>\r\n                                    <AddProductModal onAdd={handleAddProduct} />\r\n                                </div>\r\n\r\n                                <div className='[&>div]:max-h-[400px] [&>div]:rounded-sm [&>div]:border'>\r\n                                    <div className=\"overflow-x-auto\">\r\n                                        <Table className=\"table-fixed w-full\">\r\n                                            <TableHeader>\r\n                                                <TableRow className=\"bg-background sticky top-0\">\r\n                                                    <TableHead className=\"w-[35%]\">Product</TableHead>\r\n                                                    <TableHead className=\"w-[10%] text-center\">Quantity</TableHead>\r\n                                                    <TableHead className=\"w-[10%] text-center\">Unit Price</TableHead>\r\n\r\n                                                    <TableHead className=\"w-[8%]\" />\r\n                                                </TableRow>\r\n                                            </TableHeader>\r\n\r\n                                            <TableBody>\r\n                                                {products.length === 0 ? (\r\n                                                    <TableRow>\r\n                                                        <TableCell colSpan={4}>\r\n                                                            <div className=\"w-full h-24 flex items-center justify-center text-sm text-muted-foreground\">\r\n                                                                No products added.\r\n                                                            </div>\r\n                                                        </TableCell>\r\n                                                    </TableRow>\r\n                                                ) : (\r\n                                                    products.map(p => (\r\n                                                        <TableRow key={p.id}>\r\n                                                            {/* Product column: prevent flex expansion and allow wrapping */}\r\n                                                            <TableCell className=\"min-w-0 break-words whitespace-normal pr-4\">\r\n                                                                <div className=\"font-medium\">{p.name}</div>\r\n                                                            </TableCell>\r\n\r\n                                                            {/* Quantity: compact centered input so it won't push layout */}\r\n                                                            <TableCell className=\"text-center align-middle\">\r\n                                                                <Input\r\n                                                                    type=\"number\"\r\n                                                                    min={0}\r\n                                                                    value={String(p.qty)}\r\n                                                                    onChange={(e) => updateProductField(p.id, 'qty', e.target.value)}\r\n                                                                    onBlur={(e) => updateProductField(p.id, 'qty', e.target.value)}\r\n                                                                    className=\"focus-visible:ring-ring h-8 w-20 border-0 bg-transparent p-1 text-center focus-visible:ring-1 mx-auto\"\r\n                                                                    aria-label={`qty-${p.id}`}\r\n                                                                />\r\n                                                            </TableCell>\r\n\r\n                                                            {/* Unit Price: compact centered input */}\r\n                                                            <TableCell className=\"text-center align-middle\">\r\n                                                                <Input\r\n                                                                    type=\"number\"\r\n                                                                    step=\"0.01\"\r\n                                                                    min={0}\r\n                                                                    value={String(p.unitPrice)}\r\n                                                                    onChange={(e) => updateProductField(p.id, 'unitPrice', e.target.value)}\r\n                                                                    onBlur={(e) => updateProductField(p.id, 'unitPrice', e.target.value)}\r\n                                                                    className=\"focus-visible:ring-ring h-8 w-24 border-0 bg-transparent p-1 text-center focus-visible:ring-1 mx-auto\"\r\n                                                                    aria-label={`unit-${p.id}`}\r\n                                                                />\r\n                                                            </TableCell>\r\n\r\n                                                            {/* Delete button in small column */}\r\n                                                            <TableCell className=\"text-center align-middle\">\r\n                                                                <Button variant=\"ghost\" size=\"sm\" onClick={() => handleRemoveProduct(p.id)} aria-label=\"Remove product\">\r\n                                                                    <X className=\"h-4 w-4\" />\r\n                                                                </Button>\r\n                                                            </TableCell>\r\n                                                        </TableRow>\r\n                                                    ))\r\n                                                )}\r\n                                            </TableBody>\r\n\r\n                                        </Table>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </ScrollArea>\r\n\r\n                <DialogFooter className=\"px-6 pb-6 sm:justify-end\">\r\n                    <DialogClose asChild>\r\n                        <Button variant=\"outline\" onClick={() => setOpen(false)} disabled={saving}>\r\n                            <ChevronLeftIcon />\r\n                            Back\r\n                        </Button>\r\n                    </DialogClose>\r\n\r\n                    <Button onClick={handleSave} disabled={saving}>\r\n                        {saving ? 'Saving...' : 'Save'}\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10624, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/components/stockHead.tsx"],"sourcesContent":["import { Button } from \"@/components/ui/button\";\r\nimport { Plus } from \"lucide-react\";\r\nimport AddStockModal from \"./addStockModal\";\r\n\r\nexport default function StockMovementHead() {\r\n    return (\r\n        <div className=\"flex justify-between items-center h-full\">\r\n            <h1 className=\"text-3xl font-bold\">Stock Movements</h1>\r\n            <div className=\"flex gap-3\">\r\n                <AddStockModal />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEe,SAAS;IACpB,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAG,WAAU;0BAAqB;;;;;;0BACnC,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC,iMAAa;;;;;;;;;;;;;;;;AAI9B;KATwB","debugId":null}},
    {"offset": {"line": 10673, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/stocks/useStockTransactions.ts"],"sourcesContent":["import useSWR from \"swr\";\r\nimport axios from \"@/lib/axios\";\r\n\r\nexport type StockTransaction = { id: number | string; company_name: string; date: string; total?: number };\r\n\r\nconst fetcher = async (url: string) => {\r\n  const res = await axios.get(url);\r\n  return (res.data?.data ?? []) as StockTransaction[];\r\n};\r\n\r\nexport default function useStockTransactions() {\r\n  const { data, error, isValidating } = useSWR<StockTransaction[], Error>(\"/stock-transactions\", fetcher, {\r\n    revalidateOnFocus: false,\r\n  });\r\n  return { data, loading: !error && !data && isValidating, error: error ? error.message : null };\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAIA,MAAM,UAAU,OAAO;QAEb;IADR,MAAM,MAAM,MAAM,iIAAK,CAAC,GAAG,CAAC;QACpB;IAAR,OAAQ,CAAA,kBAAA,YAAA,IAAI,IAAI,cAAR,gCAAA,UAAU,IAAI,cAAd,4BAAA,iBAAkB,EAAE;AAC9B;AAEe,SAAS;;IACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,GAAG,IAAA,4KAAM,EAA4B,uBAAuB,SAAS;QACtG,mBAAmB;IACrB;IACA,OAAO;QAAE;QAAM,SAAS,CAAC,SAAS,CAAC,QAAQ;QAAc,OAAO,QAAQ,MAAM,OAAO,GAAG;IAAK;AAC/F;GALwB;;QACgB,4KAAM","debugId":null}},
    {"offset": {"line": 10711, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/components/stockTable.tsx"],"sourcesContent":["// ...existing code...\r\n'use client'\r\n\r\nimport { useState } from 'react'\r\nimport axios from \"@/lib/axios\";\r\nimport type { ColumnDef, ColumnFiltersState, SortingState, VisibilityState } from '@tanstack/react-table'\r\nimport {\r\n    flexRender,\r\n    getCoreRowModel,\r\n    getFilteredRowModel,\r\n    getPaginationRowModel,\r\n    getSortedRowModel,\r\n    useReactTable\r\n} from '@tanstack/react-table'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport { Checkbox } from '@/components/ui/checkbox'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table'\r\n\r\nimport { cn } from '@/lib/utils'\r\nimport useStockTransactions, { StockTransaction } from '@/hooks/stocks/useStockTransactions'\r\n\r\n/* ------------------ NEW IMPORTS ------------------ */\r\nimport { Eye, ChevronLeft as ChevronLeftIcon } from 'lucide-react'\r\nimport {\r\n    Dialog,\r\n    DialogClose,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger\r\n} from '@/components/ui/dialog'\r\nimport { ScrollArea } from '@/components/ui/scroll-area'\r\nimport React from 'react'\r\n/* ------------------------------------------------- */\r\n\r\n\r\nexport type StockItem = {\r\n    id: string\r\n    company: string\r\n    date: string // ISO date string\r\n    price: number\r\n}\r\n\r\nexport const columns: ColumnDef<StockTransaction>[] = [\r\n    {\r\n        accessorKey: 'company_name',\r\n        header: 'Company Name',\r\n        cell: ({ row }) => <div className='font-medium'>{row.getValue('company_name')}</div>\r\n    },\r\n    {\r\n        accessorKey: 'date',\r\n        header: 'Date',\r\n        cell: ({ row }) => {\r\n            const raw = row.getValue('date') as string\r\n            const formatted = raw ? new Date(raw).toLocaleDateString() : ''\r\n            return <div className='text-sm text-muted-foreground'>{formatted}</div>\r\n        }\r\n    },\r\n    {\r\n        accessorKey: 'total',\r\n        header: () => <div className='text-right'>Total</div>,\r\n        cell: ({ row }) => {\r\n            const price = parseFloat(String(row.getValue('total') ?? 0))\r\n            const formatted = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(price)\r\n            return <div className='text-right font-medium'>{formatted}</div>\r\n        }\r\n    },\r\n\r\n    {\r\n        id: 'actions',\r\n        header: '',\r\n        cell: ({ row }) => {\r\n            const company = String(row.getValue('company_name') ?? '')\r\n            const rawDate = String(row.getValue('date') ?? '')\r\n            const formattedDate = rawDate ? new Date(rawDate).toLocaleDateString() : ''\r\n            const total = parseFloat(String(row.getValue('total') ?? 0))\r\n            const formattedTotal = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(total)\r\n\r\n            // transaction id from original row\r\n            const txId = (row.original as any)?.id\r\n\r\n            const TransactionDetailsDialog: React.FC<{ id: number | string }> = ({ id }) => {\r\n                const [open, setOpen] = React.useState(false)\r\n                const [items, setItems] = React.useState<any[] | null>(null)\r\n                const [loadingItems, setLoadingItems] = React.useState(false)\r\n                const [loadError, setLoadError] = React.useState<string | null>(null)\r\n\r\n                React.useEffect(() => {\r\n                    if (!open) return\r\n                    let mounted = true\r\n                    const load = async () => {\r\n                        setLoadingItems(true)\r\n                        setLoadError(null)\r\n                        try {\r\n                            const endpoint = `/stock-transactions/${id}`;\r\n                            const res = await axios.get(endpoint);\r\n                            const json = res.data;\r\n                            if (res.status >= 400) throw new Error(json?.message || json?.error || 'Failed to load')\r\n                            // backend now returns items with joined product object and product_name normalization\r\n                            const fetched = json?.items ?? json?.data?.items ?? []\r\n                            if (mounted) setItems(Array.isArray(fetched) ? fetched : [])\r\n                        } catch (err: any) {\r\n                            console.error('load transaction items error', err)\r\n                            if (mounted) setLoadError(err?.message ?? String(err))\r\n                        } finally {\r\n                            if (mounted) setLoadingItems(false)\r\n                        }\r\n                    }\r\n                    load()\r\n                    return () => { mounted = false }\r\n                }, [open, id])\r\n\r\n                // fallback to original row items if remote not available yet\r\n                const origItems = (row.original as any)?.items ?? (row.original as any)?.products ?? []\r\n                const shownItems = items ?? (Array.isArray(origItems) ? origItems : [])\r\n\r\n                return (\r\n                    <Dialog open={open} onOpenChange={setOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"sm\" aria-label=\"View details\">\r\n                                <Eye className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </DialogTrigger>\r\n\r\n                        <DialogContent className=\"flex max-h-[min(640px,84vh)] flex-col gap-0 p-0 sm:max-w-lg\">\r\n                            <DialogHeader className=\"contents space-y-0 text-left\">\r\n                                <ScrollArea className=\"flex max-h-full flex-col overflow-hidden\">\r\n                                    <DialogTitle className=\"px-6 pt-6 text-lg md:text-xl font-semibold text-foreground\">Transaction Details</DialogTitle>\r\n                                    <DialogDescription asChild>\r\n                                        <div className=\"p-6\">\r\n                                            <div className=\"space-y-4\">\r\n                                                <div className=\"flex flex-col gap-2\">\r\n                                                    <div className=\"flex items-baseline gap-3\">\r\n                                                        <span className=\"text-sm text-muted-foreground\">Company:</span>\r\n                                                        <span className=\"text-base font-medium text-foreground\">{company}</span>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-baseline gap-3\">\r\n                                                        <span className=\"text-sm text-muted-foreground\">Date:</span>\r\n                                                        <span className=\"text-sm text-foreground\">{formattedDate}</span>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-baseline gap-3\">\r\n                                                        <span className=\"text-sm text-muted-foreground\">Total:</span>\r\n                                                        <span className=\"text-base font-semibold text-foreground\">{formattedTotal}</span>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"mt-3\">\r\n                                                    <h4 className=\"text-sm font-medium text-muted-foreground\">Products</h4>\r\n\r\n                                                    {loadingItems ? (\r\n                                                        <div className=\"text-sm text-muted-foreground mt-3\">Loading products…</div>\r\n                                                    ) : loadError ? (\r\n                                                        <div className=\"text-sm text-destructive mt-3\">Failed to load products: {loadError}</div>\r\n                                                    ) : !shownItems || shownItems.length === 0 ? (\r\n                                                        <div className=\"text-sm text-muted-foreground mt-3\">No products available for this transaction.</div>\r\n                                                    ) : (\r\n                                                        <div className=\"mt-3 overflow-auto rounded-sm border\">\r\n                                                            <table className=\"w-full text-sm\">\r\n                                                                <thead>\r\n                                                                    <tr className=\"bg-muted/5\">\r\n                                                                        <th className=\"px-4 py-3 text-left text-xs text-muted-foreground\">Product</th>\r\n                                                                        <th className=\"px-4 py-3 text-right text-xs text-muted-foreground\">Qty</th>\r\n                                                                        <th className=\"px-4 py-3 text-right text-xs text-muted-foreground\">Unit</th>\r\n                                                                        <th className=\"px-4 py-3 text-right text-xs text-muted-foreground\">Subtotal</th>\r\n                                                                    </tr>\r\n                                                                </thead>\r\n                                                                <tbody>\r\n                                                                    {shownItems.map((it: any, i: number) => {\r\n                                                                        const name =\r\n                                                                            it.product?.name ??\r\n                                                                            it.product_name ??\r\n                                                                            it.name ??\r\n                                                                            (it.product_id ? `#${it.product_id}` : `Item ${i + 1}`)\r\n                                                                        const qty = Number(it.quantity ?? it.qty ?? 0)\r\n                                                                        const unit = Number(it.purchased_price ?? it.unit_price ?? it.price ?? 0)\r\n                                                                        const subtotal = qty * unit\r\n                                                                        const formattedUnit = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(unit)\r\n                                                                        const formattedSubtotal = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(subtotal)\r\n\r\n                                                                        return (\r\n                                                                            <tr key={i} className=\"border-t last:border-b\">\r\n                                                                                <td className=\"px-4 py-3 align-top text-sm text-foreground max-w-[260px] break-words whitespace-normal\">{name}</td>\r\n                                                                                <td className=\"px-4 py-3 align-top text-sm text-right text-foreground\">{qty}</td>\r\n                                                                                <td className=\"px-4 py-3 align-top text-sm text-right text-foreground\">{formattedUnit}</td>\r\n                                                                                <td className=\"px-4 py-3 align-top text-sm text-right font-medium text-foreground\">{formattedSubtotal}</td>\r\n                                                                            </tr>\r\n                                                                        )\r\n                                                                    })}\r\n                                                                </tbody>\r\n                                                            </table>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </DialogDescription>\r\n                                </ScrollArea>\r\n                            </DialogHeader>\r\n\r\n                            <DialogFooter className=\"flex-row items-center justify-end border-t px-6 py-4\">\r\n                                <DialogClose asChild>\r\n                                    <Button variant=\"outline\" size=\"sm\">\r\n                                        <ChevronLeftIcon />\r\n                                        Back\r\n                                    </Button>\r\n                                </DialogClose>\r\n                            </DialogFooter>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                )\r\n            }\r\n\r\n            return (\r\n                <div className=\"flex justify-end\">\r\n                    <TransactionDetailsDialog id={txId} />\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n]\r\n\r\nconst StockMovementTable = () => {\r\n    const { data, loading, error } = useStockTransactions()\r\n    const rowsData = data ?? []\r\n    const [sorting, setSorting] = useState<SortingState>([])\r\n    const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([])\r\n    const [columnVisibility, setColumnVisibility] = useState<VisibilityState>({})\r\n    const [rowSelection, setRowSelection] = useState({})\r\n    const [globalFilter, setGlobalFilter] = useState('')\r\n\r\n    const table = useReactTable({\r\n        data: rowsData,\r\n        columns,\r\n        onSortingChange: setSorting,\r\n        onColumnFiltersChange: setColumnFilters,\r\n        getCoreRowModel: getCoreRowModel(),\r\n        getPaginationRowModel: getPaginationRowModel(),\r\n        getSortedRowModel: getSortedRowModel(),\r\n        getFilteredRowModel: getFilteredRowModel(),\r\n        onColumnVisibilityChange: setColumnVisibility,\r\n        onRowSelectionChange: setRowSelection,\r\n        onGlobalFilterChange: setGlobalFilter,\r\n        globalFilterFn: 'includesString',\r\n        state: {\r\n            sorting,\r\n            columnFilters,\r\n            columnVisibility,\r\n            rowSelection,\r\n            globalFilter\r\n        }\r\n    })\r\n\r\n\r\n    return (\r\n        <div className='w-full h-full'>\r\n            <div className='flex justify-between gap-2 pb-4 max-sm:flex-col sm:items-center'>\r\n                <div className='flex items-center space-x-2'>\r\n                    <Input\r\n                        placeholder='Search all columns...'\r\n                        value={globalFilter ?? ''}\r\n                        onChange={event => setGlobalFilter(String(event.target.value))}\r\n                        className='max-w-sm'\r\n                    />\r\n                </div>\r\n                <div className='flex items-center space-x-2'>\r\n                    <div className='text-muted-foreground text-sm'>\r\n                        {table.getSelectedRowModel().rows.length > 0 && (\r\n                            <span className='mr-2'>\r\n                                {table.getSelectedRowModel().rows.length} of {table.getFilteredRowModel().rows.length} row(s) selected\r\n                            </span>\r\n                        )}\r\n                        {loading && <span className=\"ml-2\">Loading...</span>}\r\n                        {error && <span className=\"ml-2 text-destructive\">Error: {error}</span>}\r\n                    </div>\r\n                    {/* Refresh button removed since SWR handles revalidation; call mutate() if you want manual refresh */}\r\n                </div>\r\n            </div>\r\n            <div className='rounded-md border'>\r\n                <Table>\r\n                    <TableHeader>\r\n                        {table.getHeaderGroups().map(headerGroup => (\r\n                            <TableRow key={headerGroup.id}>\r\n                                {headerGroup.headers.map(header => {\r\n                                    return (\r\n                                        <TableHead key={header.id}>\r\n                                            {header.isPlaceholder ? null : flexRender(header.column.columnDef.header, header.getContext())}\r\n                                        </TableHead>\r\n                                    )\r\n                                })}\r\n                            </TableRow>\r\n                        ))}\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                        {table.getRowModel().rows?.length ? (\r\n                            table.getRowModel().rows.map(row => (\r\n                                <TableRow key={row.id} data-state={row.getIsSelected() && 'selected'}>\r\n                                    {row.getVisibleCells().map(cell => (\r\n                                        <TableCell key={cell.id}>{flexRender(cell.column.columnDef.cell, cell.getContext())}</TableCell>\r\n                                    ))}\r\n                                </TableRow>\r\n                            ))\r\n                        ) : (\r\n                            <TableRow>\r\n                                <TableCell colSpan={columns.length} className='h-24 text-center'>\r\n                                    No results.\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        )}\r\n                    </TableBody>\r\n                </Table>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default StockMovementTable\r\n// ...existing"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 11470, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/components/cardTable.tsx"],"sourcesContent":["import {\r\n  Card,\r\n  CardAction,\r\n  CardContent,\r\n  CardDescription,\r\n  CardFooter,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/card\"\r\n\r\nimport StockMovementTable from \"./stockTable\";\r\nexport default function CardTable() {\r\n    return (\r\n        <Card className=\"h-full border\">\r\n            <CardContent>\r\n                <StockMovementTable />\r\n            </CardContent>\r\n        </Card>\r\n    )\r\n}"],"names":[],"mappings":";;;;;AAAA;AAUA;;;;AACe,SAAS;IACpB,qBACI,6LAAC,2IAAI;QAAC,WAAU;kBACZ,cAAA,6LAAC,kJAAW;sBACR,cAAA,6LAAC,8LAAkB;;;;;;;;;;;;;;;AAInC;KARwB","debugId":null}},
    {"offset": {"line": 11510, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/_pages/StockMovements/stockMScreen.tsx"],"sourcesContent":["import StockMovementHead from \"./components/stockHead\";\r\n\r\nimport CardTable from \"./components/cardTable\";\r\nexport default function StockMovementScreen() {\r\n    return (\r\n        <div className=\"flex flex-col gap-4 p-8 w-full h-full\">\r\n            <div className=\"h-full flex-[10%]\">\r\n                <StockMovementHead />\r\n            </div>\r\n            <div className=\" h-full flex-[90%]\">\r\n                <CardTable />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AACe,SAAS;IACpB,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC,6LAAiB;;;;;;;;;;0BAEtB,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC,6LAAS;;;;;;;;;;;;;;;;AAI1B;KAXwB","debugId":null}},
    {"offset": {"line": 11565, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/app/dashboard/%5Bsite%5D/DashboardClient.tsx"],"sourcesContent":["// src/app/dashboard/[site]/DashboardClient.tsx\r\n\"use client\";\r\n\r\nimport MainDashboard from \"../_pages/POS/pos-screen\";\r\nimport ProductsPage from \"../_pages/Products/productsScreen\";\r\nimport DashboardScreen from \"../_pages/Dashboard/dashboardScreen\";\r\nimport StockMovementScreen from \"../_pages/StockMovements/stockMScreen\";\r\n\r\nexport default function DashboardClient({ site }: { site: string }) {\r\n  switch (site) {\r\n    case \"main\":\r\n      return <MainDashboard />;\r\n    case \"db\":\r\n      return <DashboardScreen />;\r\n    case \"products\":\r\n      return <ProductsPage />;\r\n    case \"stock\":\r\n      return <StockMovementScreen />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,+CAA+C;;;;;;AAG/C;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS,gBAAgB,KAA0B;QAA1B,EAAE,IAAI,EAAoB,GAA1B;IACtC,OAAQ;QACN,KAAK;YACH,qBAAO,6LAAC,wKAAa;;;;;QACvB,KAAK;YACH,qBAAO,6LAAC,gLAAe;;;;;QACzB,KAAK;YACH,qBAAO,6LAAC,8KAAY;;;;;QACtB,KAAK;YACH,qBAAO,6LAAC,kLAAmB;;;;;QAC7B;YACE,OAAO;IACX;AACF;KAbwB","debugId":null}}]
}