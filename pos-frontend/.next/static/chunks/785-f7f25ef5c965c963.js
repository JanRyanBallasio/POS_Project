"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[785],{3998:(e,t,r)=>{r.d(t,{$:()=>i,r:()=>l});var a=r(95155);r(12115);var s=r(32467),n=r(83101),o=r(64269);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function i(e){let{className:t,variant:r,size:n,asChild:i=!1,...c}=e,d=i?s.DX:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,o.cn)(l({variant:r,size:n,className:t})),...c})}},12466:(e,t,r)=>{r.d(t,{A:()=>c,t:()=>s});var a=r(95125);let s=r(95704).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",n=a.A.create({baseURL:s,withCredentials:!0});console.debug("[api] axios baseURL =",s);let o=!1,l=[],i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.forEach(r=>{let{resolve:a,reject:s,config:o}=r;if(e)return s(e);t&&o&&o.headers&&(o.headers.Authorization="Bearer ".concat(t)),a(n(o))}),l=[]};n.interceptors.request.use(e=>{try{if((e.url||"").toString().includes("/auth/"))return e;let t=localStorage.getItem("accessToken");t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t))}catch(e){}return e}),n.interceptors.response.use(e=>e,async e=>{let t=e.config;if(!t)return Promise.reject(e);if(e.response&&401===e.response.status&&!t._retry){if(o)return new Promise((e,r)=>{l.push({resolve:e,reject:r,config:t})});t._retry=!0,o=!0;try{let e=await n.post("/auth/refresh"),r=e.data&&e.data.accessToken||null;if(r)try{localStorage.setItem("accessToken",r)}catch(e){}return i(null,r),n(t)}catch(e){i(e,null);try{localStorage.removeItem("accessToken"),localStorage.removeItem("user")}catch(e){}return Promise.reject(e)}finally{o=!1}}return Promise.reject(e)});let c=n},13312:(e,t,r)=>{r.d(t,{V:()=>o});var a=r(20063),s=r(12115),n=r(12466);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/dashboard/main",t=(0,a.useRouter)();(0,s.useEffect)(()=>{if(function(){try{return localStorage.getItem("accessToken")}catch(e){return null}}()||(!function(){try{let e=localStorage.getItem("user");return e?JSON.parse(e):null}catch(e){return null}}()?null:localStorage.getItem("accessToken")))return void t.replace(e);(document.cookie.includes("refreshToken")||localStorage.getItem("user"))&&(async()=>{try{var r;let a=null==(r=(await n.A.post("/auth/refresh")).data)?void 0:r.accessToken;a&&(localStorage.setItem("accessToken",a),t.replace(e))}catch(e){console.debug("No valid refresh token found, staying on auth page")}})()},[t,e])}},20508:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},39083:(e,t,r)=>{r.d(t,{D:()=>n,L:()=>o});var a=r(12466);async function s(e){var t;let r=null!=(t=null==e?void 0:e.data)?t:{};if((null==e?void 0:e.status)>=400)throw Error((null==r?void 0:r.message)||(null==r?void 0:r.error)||"Request failed");return r}async function n(e){let t={name:e.fullname,username:e.username,password:e.password};return s(await a.A.post("/auth/register",t))}async function o(e){return s(await a.A.post("/auth/login",e))}},52785:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var a=r(95155),s=r(52619),n=r.n(s),o=r(3998),l=r(12115),i=r(57828),c=r(70532),d=r(15239),u=r(20508),g=r(55867),h=r(13312),p=r(65142),f=r(76444),m=r(20063),v=r(39083);function x(){(0,h.V)();let[e,t]=(0,l.useState)(!1),r=(0,l.useId)(),s=(0,m.useRouter)(),[x,b]=(0,l.useState)(""),[y,w]=(0,l.useState)(""),[k,j]=(0,l.useState)(!1),N=async e=>{if(e.preventDefault(),!x||!y)return void alert("Enter username and password");j(!0);try{let e=await (0,v.L)({username:x,password:y});console.debug("[login] response",e),console.debug("[login] FULL response:",JSON.stringify(e,null,2)),(null==e?void 0:e.accessToken)?(localStorage.setItem("accessToken",e.accessToken),console.debug("[login] accessToken saved:",e.accessToken)):console.error("[login] No accessToken in response:",e),(null==e?void 0:e.data)?(localStorage.setItem("user",JSON.stringify(e.data)),console.debug("[login] user data saved")):console.error("[login] No user data in response:",e);try{await s.push("/dashboard/main"),console.debug("[login] router.push complete")}catch(e){console.warn("[login] router.push failed, falling back to full navigation",e),window.location.href="/dashboard/main"}}catch(e){console.error("[login] Error:",e),alert(e.message||"Login failed")}finally{j(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,a.jsxs)("div",{className:"w-full max-w-sm flex flex-col items-center gap-6 pb-[60px] px-2",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(d.default,{src:"/img/logo1.png",alt:"App logo",width:150,height:150}),(0,a.jsx)("p",{className:"font-bold text-2xl",children:"Login"})]}),(0,a.jsxs)("form",{className:"w-full space-y-4",onSubmit:N,children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(f.J,{htmlFor:"".concat(r,"-username"),className:"text-sm",children:"Username"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsxs)("div",{className:"text-muted-foreground pointer-events-none absolute inset-y-0 left-0 flex items-center ps-3",children:[(0,a.jsx)(u.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"sr-only",children:"User"})]}),(0,a.jsx)(p.p,{id:"".concat(r,"-username"),type:"text",placeholder:"Username",className:"peer ps-9",value:x,onChange:e=>b(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(f.J,{htmlFor:"".concat(r,"-password"),className:"text-sm",children:"Password"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsxs)("div",{className:"text-muted-foreground pointer-events-none absolute inset-y-0 left-0 flex items-center ps-3",children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Password"})]}),(0,a.jsx)(p.p,{id:"".concat(r,"-password"),type:e?"text":"password",placeholder:"Password",className:"peer ps-9",value:y,onChange:e=>w(e.target.value)}),(0,a.jsxs)(o.$,{variant:"ghost",size:"icon",onClick:()=>t(e=>!e),className:"text-muted-foreground absolute inset-y-0 right-0 rounded-s-none hover:bg-transparent",type:"button",children:[e?(0,a.jsx)(i.A,{}):(0,a.jsx)(c.A,{}),(0,a.jsx)("span",{className:"sr-only",children:e?"Hide password":"Show password"})]})]})]}),(0,a.jsx)(o.$,{className:"w-full bg-black text-white rounded-md",type:"submit",disabled:k,children:k?"Please wait...":"Login"})]}),(0,a.jsxs)("div",{className:"text-center text-sm mt-2",children:["Don't have an account?"," ",(0,a.jsx)(n(),{href:"/register",className:"underline underline-offset-4",children:"Sign up"})]})]})})}},55867:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(71847).A)("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]])},57828:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(71847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},64269:(e,t,r)=>{r.d(t,{cn:()=>n});var a=r(2821),s=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},65142:(e,t,r)=>{r.d(t,{p:()=>n});var a=r(95155);r(12115);var s=r(64269);function n(e){let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},70532:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(71847).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},76444:(e,t,r)=>{r.d(t,{J:()=>o});var a=r(95155);r(12115);var s=r(10489),n=r(64269);function o(e){let{className:t,...r}=e;return(0,a.jsx)(s.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}}}]);