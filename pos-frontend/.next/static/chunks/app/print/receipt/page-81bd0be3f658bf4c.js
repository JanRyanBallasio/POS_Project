(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[145],{11288:(e,n,t)=>{Promise.resolve().then(t.bind(t,53673))},53673:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>c});var a=t(95155),i=t(12115);function s(e){var n,t;let{store:i,customer:s,date:r,items:l,cartTotal:o,amount:c,change:d,points:p}=e,h=r||new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"});return(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",background:"#f5f5f5"},children:(0,a.jsxs)("div",{id:"receipt-root",style:{width:"80mm",background:"#fff",color:"#000",padding:"10px",boxSizing:"border-box",fontFamily:"'Courier New', monospace",fontSize:"12px",lineHeight:1.2},children:[(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n@page {\n  size: 80mm auto;\n  margin: 0;\n}\n* {\n  -webkit-print-color-adjust: exact;\n  print-color-adjust: exact;\n}\n.no-print {\n  display: inline-flex;\n}\n@media print {\n  html, body {\n    margin: 0 !important;\n    padding: 0 !important;\n    width: 80mm !important;\n  }\n  .no-print {\n    display: none !important;\n  }\n}\n.separator {\n  border-top: 1px dashed #000;\n  margin: 6px 0;\n  height: 1px;\n}\n.table {\n  width: 100%;\n  border-collapse: collapse;\n}\n.table th, .table td {\n  padding: 2px 0;\n  text-align: left;\n  font-size: 11px;\n  white-space: nowrap;\n}\n.right { text-align: right; }\n.center { text-align: center; }\n.header { text-align: center; font-weight: bold; margin-bottom: 6px; font-size: 14px; }\n.footer { margin-top: 12px; text-align: center; font-weight: bold; }\n.summary { margin: 8px 0; }\n.summary-line { display: flex; justify-content: space-between; margin: 2px 0; }\n.actions {\n  position: sticky;\n  bottom: 0;\n  margin-top: 10px;\n  display: flex;\n  gap: 8px;\n}\n.actions button {\n  flex: 1;\n  height: 36px;\n  font-size: 14px;\n}\n"}}),(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)("div",{children:null!=(n=null==i?void 0:i.name)?n:"YZY STORE"}),(0,a.jsx)("div",{children:null!=(t=null==i?void 0:i.address1)?t:"Eastern Slide, Tuding"}),(null==i?void 0:i.address2)?(0,a.jsx)("div",{children:i.address2}):null]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("span",{children:"Customer:"}),(0,a.jsx)("span",{children:(null==s?void 0:s.name)||"N/A"})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("span",{children:"Date:"}),(0,a.jsx)("span",{children:h})]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"#"}),(0,a.jsx)("th",{children:"Description"}),(0,a.jsx)("th",{className:"right",children:"Qty"}),(0,a.jsx)("th",{className:"right",children:"Price"}),(0,a.jsx)("th",{className:"right",children:"Amount"})]})}),(0,a.jsx)("tbody",{children:l.map((e,n)=>{let t="number"==typeof e.price?e.price:e.amount/Math.max(1,e.qty),i=e.desc.length>20?"".concat(e.desc.slice(0,17),"..."):e.desc;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:n+1}),(0,a.jsx)("td",{children:i}),(0,a.jsx)("td",{className:"right",children:e.qty}),(0,a.jsxs)("td",{className:"right",children:["P",t.toFixed(2)]}),(0,a.jsxs)("td",{className:"right",children:["P",e.amount.toFixed(2)]})]},n)})})]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("div",{className:"summary",children:[(0,a.jsxs)("div",{className:"summary-line",children:[(0,a.jsx)("span",{children:"Total:"}),(0,a.jsxs)("span",{children:["P",o.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"summary-line",children:[(0,a.jsx)("span",{children:"Amount:"}),(0,a.jsxs)("span",{children:["P",c.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"summary-line",children:[(0,a.jsx)("span",{children:"Change:"}),(0,a.jsxs)("span",{children:["P",d.toFixed(2)]})]})]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("div",{className:"summary-line",children:[(0,a.jsx)("span",{children:"Customer Points:"}),(0,a.jsx)("span",{children:null!=p?p:0})]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("div",{className:"footer",children:[(0,a.jsx)("div",{children:"CUSTOMER COPY - NOT AN OFFICIAL RECEIPT"}),(0,a.jsx)("div",{children:"THANK YOU - GATANG KA MANEN!"})]}),(0,a.jsx)("div",{className:"separator"}),(0,a.jsxs)("div",{className:"actions no-print",children:[(0,a.jsx)("button",{onClick:()=>window.print(),children:"Print"}),(0,a.jsx)("button",{onClick:()=>window.close(),children:"Close"})]})]})})}"function"==typeof SuppressedError&&SuppressedError;async function r(e,n={},t){return window.__TAURI_INTERNALS__.invoke(e,n,t)}function l(e,n){let t=String(e);return t.length>=n?t.slice(0,n):" ".repeat(n-t.length)+t}function o(e){var n,t;let a=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"}),i="";return i+="\x1b@",i+="\x1bt\0",i+="\x1ba\x01",i+="\x1bE\x01",i+="YZY STORE\n",i+="Eastern Slide, Tuding\n",i+="\x1bE\0",i+="\x1ba\0",i+="--------------------------------\n",i+="Customer: ".concat((null==(n=e.customer)?void 0:n.name)||"N/A","\n"),i+="Date: ".concat(a,"\n"),i+="--------------------------------\n",i+="# Description        Qty Price Amount\n",i+="--------------------------------\n",e.items.forEach((e,n)=>{let t=e.desc.length>15?e.desc.substring(0,12)+"...":e.desc,a=l(e.qty,3),s="number"==typeof e.price?e.price:e.qty>0?e.amount/e.qty:0,r=l("P".concat(s.toFixed(2)),6),o=l("P".concat(e.amount.toFixed(2)),7);i+="".concat(l(n+1,2)," ").concat(function(e,n){let t=String(e);return t.length>=15?t.slice(0,15):t+" ".repeat(n-t.length)}(t,15)," ").concat(a," ").concat(r," ").concat(o,"\n")}),i+="--------------------------------\n",i+="Total:                    P".concat(e.cartTotal.toFixed(2),"\n"),i+="Amount:                   P".concat(e.amount.toFixed(2),"\n"),i+="Change:                   P".concat(e.change.toFixed(2),"\n"),i+="--------------------------------\n",i+="Customer Points: ".concat(null!=(t=e.points)?t:0,"\n"),i+="--------------------------------\n\n",i+="\x1ba\x01",i+="CUSTOMER COPY - NOT AN OFFICIAL RECEIPT\n\n",i+="THANK YOU - GATANG KA MANEN!\n",i+="\x1ba\0",i+="--------------------------------\n\n",i+="\x1bd\x03",i+="\x1dV\0"}function c(){var e,n,t,l,c;let[d,p]=(0,i.useState)(null),[h,m]=(0,i.useState)([]),[x,u]=(0,i.useState)(null),g=(0,i.useMemo)(()=>new URLSearchParams(window.location.search).get("id")||"",[]);return((0,i.useEffect)(()=>{if(g)try{let e="print:".concat(g),n=localStorage.getItem(e);if(n){let t=JSON.parse(n);p(t);let a=async n=>{if((n.ctrlKey||n.metaKey)&&"p"===n.key.toLowerCase()){n.preventDefault(),n.stopPropagation();try{let n=o(t),a=localStorage.getItem("print:defaultPrinter")||null;await r("print_receipt_direct",{receiptData:n,itemCount:t.items.length,printerName:a});try{localStorage.removeItem(e)}catch(e){}window.close()}catch(e){alert((null==e?void 0:e.message)||String(e))}}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)}}catch(e){console.error("Failed to load print data:",e)}},[g]),(0,i.useEffect)(()=>{(async()=>{try{let e=await r("list_printers").catch(()=>[]);m(Array.isArray(e)?e:[]);let n=localStorage.getItem("print:defaultPrinter")||"";if(n&&e&&e.includes(n))u(n);else{let e=await r("get_default_printer_name").catch(()=>"");u(e||null)}}catch(e){}})()},[]),g&&d)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s,{store:{name:null!=(l=null==(e=d.store)?void 0:e.name)?l:"YZY STORE",address1:null!=(c=null==(n=d.store)?void 0:n.address1)?c:"Eastern Slide, Tuding",address2:null==(t=d.store)?void 0:t.address2},customer:d.customer,date:void 0,items:d.items,cartTotal:d.cartTotal,amount:d.amount,change:d.change,points:d.points}),(0,a.jsxs)("div",{className:"no-print",style:{display:"flex",gap:8,justifyContent:"center",marginTop:8,alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsxs)("select",{value:null!=x?x:"",onChange:e=>u(e.target.value||null),style:{height:32,minWidth:260},children:[(0,a.jsx)("option",{value:"",children:"Default printer"}),h.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsx)("button",{onClick:()=>{x&&localStorage.setItem("print:defaultPrinter",x)},children:"Set as default"}),(0,a.jsx)("button",{onClick:async()=>{try{let e=o(d);await r("print_receipt_direct",{receiptData:e,itemCount:d.items.length,printerName:null!=x?x:null});try{localStorage.removeItem("print:".concat(g))}catch(e){}window.close()}catch(e){alert((null==e?void 0:e.message)||String(e))}},children:"Print (Thermal, ESC/POS)"}),(0,a.jsx)("button",{onClick:()=>window.print(),children:"System Print (A4/Graphic)"}),(0,a.jsx)("button",{onClick:()=>window.close(),children:"Close"})]})]}):(0,a.jsx)("div",{style:{padding:16,fontFamily:"sans-serif"},children:(0,a.jsx)("p",{children:"Loading receipt..."})})}new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap}},e=>{e.O(0,[441,255,358],()=>e(e.s=11288)),_N_E=e.O()}]);