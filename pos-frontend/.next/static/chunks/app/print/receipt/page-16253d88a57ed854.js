(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[145],{11288:(e,n,t)=>{Promise.resolve().then(t.bind(t,89969))},68267:(e,n,t)=>{"use strict";var i;t.d(n,{FW:()=>o,$c:()=>s,lA:()=>r,yw:()=>a}),"function"==typeof SuppressedError&&SuppressedError;let s="__TAURI_TO_IPC_KEY__";function a(e,n=!1){return window.__TAURI_INTERNALS__.transformCallback(e,n)}async function r(e,n={},t){return window.__TAURI_INTERNALS__.invoke(e,n,t)}new WeakMap,new WeakMap,new WeakMap,new WeakMap;class o{get rid(){var e,n=this,t=i,s="f";!1;if("function"==typeof t?n!==t||!e:!t.has(n))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?e:"a"===s?e.call(n):e?e.value:t.get(n)}constructor(e){i.set(this,void 0),function(e,n,t,i,s){!1;if("a"===i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof n?e!==n||!s:!n.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?s.call(e,t):s?s.value=t:n.set(e,t)}(this,i,e,"f")}async close(){return r("plugin:resources|close",{rid:this.rid})}}i=new WeakMap},89969:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var i=t(95155),s=t(12115);function a(e){var n,t;let{store:s,customer:a,date:r,items:o,cartTotal:l,amount:c,change:d,points:p}=e,h=r||new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"});return(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",background:"#f5f5f5"},children:(0,i.jsxs)("div",{id:"receipt-root",style:{width:"80mm",background:"#fff",color:"#000",padding:"10px",boxSizing:"border-box",fontFamily:"'Courier New', monospace",fontSize:"12px",lineHeight:1.2},children:[(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n@page {\n  size: 80mm auto;\n  margin: 0;\n}\n* {\n  -webkit-print-color-adjust: exact;\n  print-color-adjust: exact;\n}\n.no-print {\n  display: inline-flex;\n}\n@media print {\n  html, body {\n    margin: 0 !important;\n    padding: 0 !important;\n    width: 80mm !important;\n  }\n  .no-print {\n    display: none !important;\n  }\n}\n.separator {\n  border-top: 1px dashed #000;\n  margin: 6px 0;\n  height: 1px;\n}\n.table {\n  width: 100%;\n  border-collapse: collapse;\n}\n.table th, .table td {\n  padding: 2px 0;\n  text-align: left;\n  font-size: 11px;\n  white-space: nowrap;\n}\n.right { text-align: right; }\n.center { text-align: center; }\n.header { text-align: center; font-weight: bold; margin-bottom: 6px; font-size: 14px; }\n.footer { margin-top: 12px; text-align: center; font-weight: bold; }\n.summary { margin: 8px 0; }\n.summary-line { display: flex; justify-content: space-between; margin: 2px 0; }\n.actions {\n  position: sticky;\n  bottom: 0;\n  margin-top: 10px;\n  display: flex;\n  gap: 8px;\n}\n.actions button {\n  flex: 1;\n  height: 36px;\n  font-size: 14px;\n}\n"}}),(0,i.jsxs)("div",{className:"header",children:[(0,i.jsx)("div",{children:null!=(n=null==s?void 0:s.name)?n:"YZY STORE"}),(0,i.jsx)("div",{children:null!=(t=null==s?void 0:s.address1)?t:"Eastern Slide, Tuding"}),(null==s?void 0:s.address2)?(0,i.jsx)("div",{children:s.address2}):null]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("span",{children:"Customer:"}),(0,i.jsx)("span",{children:(null==a?void 0:a.name)||"N/A"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("span",{children:"Date:"}),(0,i.jsx)("span",{children:h})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"#"}),(0,i.jsx)("th",{children:"Description"}),(0,i.jsx)("th",{className:"right",children:"Qty"}),(0,i.jsx)("th",{className:"right",children:"Price"}),(0,i.jsx)("th",{className:"right",children:"Amount"})]})}),(0,i.jsx)("tbody",{children:o.map((e,n)=>{let t="number"==typeof e.price?e.price:e.amount/Math.max(1,e.qty),s=e.desc.length>20?"".concat(e.desc.slice(0,17),"..."):e.desc;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:n+1}),(0,i.jsx)("td",{children:s}),(0,i.jsx)("td",{className:"right",children:e.qty}),(0,i.jsxs)("td",{className:"right",children:["P",t.toFixed(2)]}),(0,i.jsxs)("td",{className:"right",children:["P",e.amount.toFixed(2)]})]},n)})})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{className:"summary",children:[(0,i.jsxs)("div",{className:"summary-line",children:[(0,i.jsx)("span",{children:"Total:"}),(0,i.jsxs)("span",{children:["P",l.toFixed(2)]})]}),(0,i.jsxs)("div",{className:"summary-line",children:[(0,i.jsx)("span",{children:"Amount:"}),(0,i.jsxs)("span",{children:["P",c.toFixed(2)]})]}),(0,i.jsxs)("div",{className:"summary-line",children:[(0,i.jsx)("span",{children:"Change:"}),(0,i.jsxs)("span",{children:["P",d.toFixed(2)]})]})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{className:"summary-line",children:[(0,i.jsx)("span",{children:"Customer Points:"}),(0,i.jsx)("span",{children:null!=p?p:0})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{className:"footer",children:[(0,i.jsx)("div",{children:"CUSTOMER COPY - NOT AN OFFICIAL RECEIPT"}),(0,i.jsx)("div",{children:"THANK YOU - GATANG KA MANEN!"})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{className:"actions no-print",children:[(0,i.jsx)("button",{onClick:()=>window.print(),children:"Print"}),(0,i.jsx)("button",{onClick:()=>window.close(),children:"Close"})]})]})})}var r=t(68267);function o(e,n){let t=String(e);return t.length>=n?t.slice(0,n):" ".repeat(n-t.length)+t}function l(){var e,n,t,l,c;let[d,p]=(0,s.useState)(null),h=(0,s.useMemo)(()=>new URLSearchParams(window.location.search).get("id")||"",[]);return((0,s.useEffect)(()=>{if(h)try{let e="print:".concat(h),n=localStorage.getItem(e);if(n){let t=JSON.parse(n);p(t);let i=setTimeout(()=>{try{window.print()}catch(e){}},250),s=()=>{try{localStorage.removeItem(e)}catch(e){}setTimeout(()=>window.close(),150)};return window.addEventListener("afterprint",s,{once:!0}),()=>{clearTimeout(i),window.removeEventListener("afterprint",s)}}}catch(e){console.error("Failed to load print data:",e)}},[h]),h&&d)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a,{store:{name:null!=(l=null==(e=d.store)?void 0:e.name)?l:"YZY STORE",address1:null!=(c=null==(n=d.store)?void 0:n.address1)?c:"Eastern Slide, Tuding",address2:null==(t=d.store)?void 0:t.address2},customer:d.customer,date:void 0,items:d.items,cartTotal:d.cartTotal,amount:d.amount,change:d.change,points:d.points}),(0,i.jsxs)("div",{className:"no-print",style:{display:"flex",gap:8,justifyContent:"center",marginTop:8},children:[(0,i.jsx)("button",{onClick:()=>window.print(),children:"Print"}),(0,i.jsx)("button",{onClick:async()=>{try{let e=function(e){var n,t;let i=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"}),s="";return s+="\x1b@",s+="\x1ba\x01",s+="\x1bE\x01",s+="YZY STORE\n",s+="Eastern Slide, Tuding\n",s+="\x1bE\0",s+="\x1ba\0",s+="--------------------------------\n",s+="Customer: ".concat((null==(n=e.customer)?void 0:n.name)||"N/A","\n"),s+="Date: ".concat(i,"\n"),s+="--------------------------------\n",s+="# Description        Qty Price Amount\n",s+="--------------------------------\n",e.items.forEach((e,n)=>{let t=e.desc.length>15?e.desc.substring(0,12)+"...":e.desc,i=o(e.qty,3),a="number"==typeof e.price?e.price:e.qty>0?e.amount/e.qty:0,r=o("P".concat(a.toFixed(2)),6),l=o("P".concat(e.amount.toFixed(2)),7);s+="".concat(o(n+1,2)," ").concat(function(e,n){let t=String(e);return t.length>=15?t.slice(0,15):t+" ".repeat(n-t.length)}(t,15)," ").concat(i," ").concat(r," ").concat(l,"\n")}),s+="--------------------------------\n",s+="Total:                    P".concat(e.cartTotal.toFixed(2),"\n"),s+="Amount:                   P".concat(e.amount.toFixed(2),"\n"),s+="Change:                   P".concat(e.change.toFixed(2),"\n"),s+="--------------------------------\n",s+="Customer Points: ".concat(null!=(t=e.points)?t:0,"\n"),s+="--------------------------------\n\n",s+="\x1ba\x01",s+="CUSTOMER COPY - NOT AN OFFICIAL RECEIPT\n\n",s+="THANK YOU - GATANG KA MANEN!\n",s+="\x1ba\0",s+="--------------------------------\n\n",s+="\x1bd\x03",s+="\x1dV\0"}(d);await (0,r.lA)("print_receipt_direct",{receiptData:e,itemCount:d.items.length,printerName:null}),window.close()}catch(e){alert((null==e?void 0:e.message)||String(e))}},children:"Print via ESC/POS"}),(0,i.jsx)("button",{onClick:()=>window.close(),children:"Close"})]})]}):(0,i.jsx)("div",{style:{padding:16,fontFamily:"sans-serif"},children:(0,i.jsx)("p",{children:"Loading receipt..."})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=11288)),_N_E=e.O()}]);