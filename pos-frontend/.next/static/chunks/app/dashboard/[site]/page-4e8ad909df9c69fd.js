(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{12306:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tw});var s=a(95155),r=a(12115),l=a(78121);let n=(0,r.createContext)(void 0),i=e=>{let{children:t}=e,[a,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(null),h=async e=>{try{u(!0),c(null);let t=await l.G.getByBarcode(e);t?i(e=>{if(e.find(e=>e.product.barcode===t.barcode))return e.map(e=>e.product.barcode===t.barcode?{...e,quantity:e.quantity+1}:e);{let a={product:t,quantity:1,id:Date.now().toString()};return[...e,a]}}):c("Product not found: ".concat(e))}catch(e){c(e instanceof Error?e.message:"Error scanning barcode")}finally{u(!1)}},f=(0,r.useMemo)(()=>a.reduce((e,t)=>e+t.product.price*t.quantity,0),[a]);return(0,s.jsx)(n.Provider,{value:{cart:a,cartTotal:f,scanError:o,isScanning:d,scanAndAddToCart:h,refocusScanner:()=>{setTimeout(()=>{(null==x?void 0:x.current)&&x.current.focus()},100)},setScannerRef:e=>{m(e)},updateCartItemQuantity:(e,t)=>{i(a=>a.map(a=>a.id===e?{...a,quantity:t}:a))},clearCart:()=>i([])},children:t})},o=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e},c=e=>{let{cart:t,updateCartItemQuantity:a}=o();(0,r.useEffect)(()=>{let s=s=>{if(e){if("+"===s.key){let s=t.find(t=>t.id===e);s&&a(s.id,s.quantity+1)}if("-"===s.key){let s=t.find(t=>t.id===e);s&&s.quantity>1&&a(s.id,s.quantity-1)}}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[e,t,a])};var d=a(59434);function u(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,d.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,d.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,d.cn)("leading-none font-semibold",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,d.cn)("text-muted-foreground text-sm",t),...a})}function f(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-action",className:(0,d.cn)("col-start-2 row-span-2 row-start-1 self-start justify-self-end",t),...a})}function p(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,d.cn)("px-6",t),...a})}function g(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,d.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}var j=a(30285),v=a(62523),b=a(85057);function y(e){let{amount:t,setAmount:a,cartTotal:r,refocusScanner:l,onNext:n,cartIsEmpty:i=!1}=e,o=e=>{if("C"===e)a("");else if("⌫"===e)a(t.slice(0,-1));else{if("."===e&&t.includes("."))return;a(t+e)}l()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.J,{className:"text-lg mb-2 font-medium",children:"Cash"}),(0,s.jsx)(v.p,{className:"h-20 !text-5xl text-right font-medium mb-6 border-2 border-gray-300 shadow-sm placeholder:text-5xl placeholder:font-medium placeholder:text-gray-400",value:t,onChange:e=>{a(e.target.value),setTimeout(l,3e3)},placeholder:"0.00",onBlur:l,onClick:e=>e.stopPropagation(),disabled:i}),(0,s.jsxs)("div",{className:"flex-1 grid grid-cols-3 gap-2 bg-gray-50 p-3 rounded-lg",children:[[7,8,9,4,5,6,1,2,3].map(e=>(0,s.jsx)(j.$,{onClick:()=>o(e.toString()),variant:"outline",className:"h-16 text-2xl font-medium",disabled:i,children:e},e)),(0,s.jsx)(j.$,{onClick:()=>o("."),variant:"outline",className:"h-16 text-2xl font-medium",disabled:i,children:"."}),(0,s.jsx)(j.$,{onClick:()=>o("0"),variant:"outline",className:"h-16 text-2xl font-medium",disabled:i,children:"0"}),(0,s.jsx)(j.$,{onClick:()=>o("⌫"),variant:"outline",className:"h-16 text-2xl font-medium",disabled:i,children:"⌫"}),(0,s.jsx)(j.$,{onClick:()=>o("C"),variant:"outline",className:"h-16 text-2xl font-medium col-span-3",disabled:i,children:"Clear"})]}),(0,s.jsx)("div",{className:"px-4 pb-4 pt-4",children:(0,s.jsx)(j.$,{className:"w-full h-14 text-xl font-medium",onClick:n,disabled:i||!t||parseFloat(t)<r,children:"Next"})})]})}var N=a(71007),w=a(84616);function S(e){let{customerQuery:t,setCustomerQuery:a,filteredCustomers:l,selectedCustomer:n,selectCustomer:i,clearCustomer:o,onAddCustomer:c}=e,d=(0,r.useId)();return(0,s.jsxs)("div",{className:"w-full mb-4",children:[(0,s.jsx)(b.J,{htmlFor:d,className:"mb-2 block",children:"Customer Name"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-400",children:(0,s.jsx)(N.A,{className:"w-4 h-4"})}),(0,s.jsx)(v.p,{id:d,className:"pl-9",placeholder:"Search Name",value:n?n.name:t,onChange:e=>{a(e.target.value),o()},autoComplete:"off"}),t&&!n&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 right-0 bg-white border rounded shadow max-h-40 overflow-y-auto",children:[0===l.length&&(0,s.jsx)("div",{className:"p-2 text-gray-500 text-center",children:"No results"}),l.map(e=>(0,s.jsxs)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer flex justify-between",onClick:()=>{i(e),a(e.name)},children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:[e.points," pts"]})]},e.id))]})]}),(0,s.jsxs)(j.$,{type:"button",onClick:c,className:"ml-2",children:[(0,s.jsx)(w.A,{className:"w-4 h-4 mr-1"})," Add"]})]})]})}function C(e){let{amount:t,cartTotal:a,change:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"py-5 border-t border-b",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xl mb-3",children:[(0,s.jsx)("span",{children:"Amount Paid:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₱ ",parseFloat(t).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xl mb-3",children:[(0,s.jsx)("span",{children:"Total:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₱ ",a.toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-3xl font-bold pt-5",children:[(0,s.jsx)("span",{children:"Change:"}),(0,s.jsxs)("span",{children:["₱ ",r.toFixed(2)]})]})]})}function k(e){let{selectedCustomer:t,cartTotal:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Transaction Successful!"}),(0,s.jsx)("p",{className:"mb-8",children:"Thank you for your purchase."})]})}var _=a(54165);function A(e){let{open:t,onOpenChange:a,onCustomerAdded:l}=e,[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),x=async()=>{c(!0),u(null);try{let e=await fetch("".concat("http://13.211.162.106:5000/api","/customers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n})}),t=await e.json();if(!t.success)throw Error(t.message||"Failed to add customer");i(""),a(!1),l(t.data)}catch(e){u(e.message||"Failed to add customer")}finally{c(!1)}};return(0,s.jsx)(_.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(_.Cf,{children:[(0,s.jsx)(_.c7,{children:(0,s.jsx)(_.L3,{children:"Add Customer"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 my-2",children:[(0,s.jsx)(b.J,{htmlFor:"customer-name",children:"Name"}),(0,s.jsx)(v.p,{id:"customer-name",value:n,onChange:e=>i(e.target.value),placeholder:"Enter customer name",disabled:o}),d&&(0,s.jsx)("span",{className:"text-red-500 text-sm",children:d})]}),(0,s.jsxs)(_.Es,{children:[(0,s.jsx)(j.$,{variant:"outline",onClick:()=>a(!1),disabled:o,children:"Cancel"}),(0,s.jsx)(j.$,{onClick:x,disabled:o||!n.trim(),children:o?"Adding...":"Add"})]})]})})}var z=a(28890);let L=z.vv.create({page:{backgroundColor:"#fff",color:"#262626",fontFamily:"Roboto",fontSize:12,padding:12},header:{textAlign:"center",marginBottom:4},pharmacy:{fontSize:18,fontWeight:"bold",marginBottom:2},address:{fontSize:10,marginBottom:6},divider:{borderBottomWidth:1.5,borderBottomColor:"#000",borderStyle:"dashed",marginVertical:8},row:{flexDirection:"row",justifyContent:"space-between",marginBottom:2},bold:{fontWeight:"bold"},tableHeader:{flexDirection:"row",borderBottomWidth:1.5,borderBottomColor:"#000",borderStyle:"dashed",marginBottom:2,fontWeight:"bold",paddingTop:4,paddingBottom:4},colDesc:{width:"45%"},colQty:{width:"20%",textAlign:"center"},colAmount:{width:"35%",textAlign:"right"},totalRow:{flexDirection:"row",justifyContent:"flex-end",marginTop:8,fontWeight:"bold",fontSize:13},footer:{textAlign:"center",marginTop:8,fontSize:10},solution:{textAlign:"center",marginTop:8,fontSize:10,fontWeight:"bold"}});z.KQ.register({family:"Roboto",src:"/fonts/Roboto/Roboto-VariableFont_wdth,wght.ttf"});let E=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"});function D(e){let{cartTotal:t,amount:a,change:r,customer:l,items:n}=e,i=280+20*n.length;return(0,s.jsx)(z.yo,{children:(0,s.jsxs)(z.YW,{size:[227,i],style:L.page,children:[(0,s.jsxs)(z.Ss,{style:L.header,children:[(0,s.jsx)(z.EY,{style:L.pharmacy,children:"STORE DA"}),(0,s.jsx)(z.EY,{style:L.address,children:"Itoy Igid"})]}),(0,s.jsx)(z.Ss,{style:L.divider}),(0,s.jsxs)(z.Ss,{style:L.row,children:[(0,s.jsx)(z.EY,{style:L.bold,children:"Customer:"}),(0,s.jsx)(z.EY,{children:(null==l?void 0:l.name)||"N/A"})]}),(0,s.jsx)(z.Ss,{style:L.row,children:(0,s.jsxs)(z.EY,{children:[(0,s.jsx)(z.EY,{style:L.bold,children:"Date:"})," ",E]})}),(0,s.jsx)(z.Ss,{style:L.divider}),(0,s.jsxs)(z.Ss,{style:L.tableHeader,children:[(0,s.jsx)(z.EY,{style:L.colDesc,children:"Description"}),(0,s.jsx)(z.EY,{style:L.colQty,children:"Qty"}),(0,s.jsx)(z.EY,{style:L.colAmount,children:"Amount"})]}),n.map((e,t)=>(0,s.jsxs)(z.Ss,{style:L.row,children:[(0,s.jsx)(z.EY,{style:L.colDesc,children:e.desc}),(0,s.jsx)(z.EY,{style:L.colQty,children:e.qty}),(0,s.jsx)(z.EY,{style:L.colAmount,children:e.amount.toFixed(2)})]},t)),(0,s.jsx)(z.Ss,{style:L.divider}),(0,s.jsxs)(z.Ss,{style:L.totalRow,children:[(0,s.jsx)(z.EY,{children:"Total: "}),(0,s.jsxs)(z.EY,{style:{fontWeight:"bold",marginLeft:8},children:["₱",t.toFixed(2)]})]}),(0,s.jsxs)(z.Ss,{style:L.row,children:[(0,s.jsx)(z.EY,{children:"Amount:"}),(0,s.jsxs)(z.EY,{children:["₱",parseFloat(a||"0").toFixed(2)]})]}),(0,s.jsxs)(z.Ss,{style:L.row,children:[(0,s.jsx)(z.EY,{children:"Change:"}),(0,s.jsxs)(z.EY,{children:["₱",r.toFixed(2)]})]}),(0,s.jsx)(z.Ss,{style:L.divider}),(0,s.jsx)(z.EY,{style:L.solution,children:"GATANG KA MANNEN!"})]})})}function F(e){let{step:t,setStep:a}=e,{cart:l,cartTotal:n,refocusScanner:i,clearCart:c}=o(),[d,x]=(0,r.useState)(""),[m,h]=(0,r.useState)(0),[f,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h((parseFloat(d)||0)-n)},[d,n]);let{customerQuery:b,setCustomerQuery:N,filteredCustomers:w,selectedCustomer:_,selectCustomer:L,clearCustomer:E,fetchCustomers:F,allCustomers:q,setAllCustomers:P}=function(){let[e,t]=(0,r.useState)(""),[a,s]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[i,o]=(0,r.useState)(null),c=async()=>{try{let e=await fetch("".concat("http://13.211.162.106:5000/api","/customers")),t=await e.json();t.success&&Array.isArray(t.data)?s(t.data):s([])}catch(e){s([])}};return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://13.211.162.106:5000/api","/customers")),t=await e.json();t.success&&Array.isArray(t.data)?s(t.data):s([])}catch(e){s([])}})()},[]),(0,r.useEffect)(()=>{n(a.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))},[e,a]),(0,r.useEffect)(()=>{c()},[]),{customerQuery:e,setCustomerQuery:t,filteredCustomers:l,selectedCustomer:i,selectCustomer:e=>{o(e),t(e.name)},clearCustomer:()=>o(null),fetchCustomers:c,allCustomers:a,setAllCustomers:s}}(),T=async()=>{let e=await (0,z.x8)((0,s.jsx)(D,{cartTotal:n,amount:d,change:m,customer:_,items:l.map(e=>({desc:e.product.name,qty:e.quantity,amount:e.product.price*e.quantity}))})).toBlob(),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="receipt-".concat(Date.now(),".pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},R=async()=>{await fetch("http://13.211.162.106:5000/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:(null==_?void 0:_.id)||null,total_purchase:n,items:l.map(e=>({product_id:e.product.id,quantity:e.quantity,price:e.product.price}))})}),a(1),x(""),E(),h(0),i(),c()};return(0,s.jsx)(u,{className:"h-full flex flex-col",onClick:()=>i(),children:(0,s.jsxs)(p,{className:"flex-1 flex flex-col p-4 pb-0",children:[(0,s.jsx)("h1",{className:"text-xl font-medium",children:"Total"}),(0,s.jsx)("div",{className:"w-full py-3 mb-2",children:(0,s.jsxs)("div",{className:"flex justify-between text-5xl font-medium",children:[(0,s.jsx)("h1",{children:"₱"}),(0,s.jsx)("h1",{children:n.toFixed(2)})]})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[1===t&&(0,s.jsx)(y,{amount:d,setAmount:x,cartTotal:n,refocusScanner:i,onNext:()=>{let e=parseFloat(d)||0;e>=n?(h(e-n),a(2)):alert("Insufficient amount")},cartIsEmpty:0===l.length}),2===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{amount:d,cartTotal:n,change:m}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)(S,{customerQuery:b,setCustomerQuery:N,filteredCustomers:w,selectedCustomer:_,selectCustomer:L,clearCustomer:E,onAddCustomer:()=>v(!0)}),(0,s.jsx)(A,{open:f,onOpenChange:v,onCustomerAdded:e=>{P(t=>[...t,e]),L(e),N(e.name)}}),(0,s.jsxs)(g,{className:"px-4 pb-4 pt-4 flex flex-col gap-3",children:[(0,s.jsx)(j.$,{className:"w-full h-14 text-xl font-medium",variant:"outline",onClick:()=>a(1),children:"Back"}),(0,s.jsx)(j.$,{className:"w-full h-14 text-xl font-medium",onClick:()=>a(3),children:"Finish Transaction"})]})]}),3===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k,{selectedCustomer:_,cartTotal:n}),(0,s.jsxs)(g,{className:"px-4 pb-4 pt-4 flex flex-col gap-2",children:[(0,s.jsx)(j.$,{className:"w-full h-14 text-xl font-medium",onClick:T,children:"Print Receipt"}),(0,s.jsx)(j.$,{className:"w-full h-14 text-xl font-medium",variant:"outline",onClick:R,children:"Close"})]})]})]})]})})}var q=a(56460);let P=e=>{let[t,a]=(0,r.useState)(""),s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{s.current&&s.current.focus()},[]),{barcodeInput:t,inputRef:s,handleBarcodeChange:t=>{let s=t.target.value;if(a(s),s.includes("\n")||s.includes("\r")){let t=s.replace(/[\n\r]/g,"").trim();t&&(e(t),a(""))}},handleKeyPress:s=>{"Enter"===s.key&&(s.preventDefault(),t.trim()&&(e(t.trim()),a("")))},refocusScanner:()=>{setTimeout(()=>{s.current&&s.current.focus()},100)}}},T=e=>{let[t,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(!1),n=(0,r.useMemo)(()=>t.trim().length<2?[]:e.filter(e=>{var a;return e.name.toLowerCase().includes(t.toLowerCase())||(null==(a=e.barcode)?void 0:a.includes(t))}),[e,t]);return{searchQuery:t,searchResults:n,showSearchResults:s,handleSearchChange:e=>{a(e),l(e.trim().length>=2)},clearSearch:()=>{a(""),l(!1)}}};function R(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,d.cn)("w-full caption-bottom text-sm",t),...a})})}function $(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,d.cn)("[&_tr]:border-b",t),...a})}function M(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,d.cn)("[&_tr:last-child]:border-0",t),...a})}function O(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,d.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function B(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,d.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function Y(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,d.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function K(e){let{cart:t,selectedRowId:a,selectRow:r,updateCartItemQuantity:l,disabled:n=!1}=e;return 0===t.length?(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center w-full h-full",children:(0,s.jsx)("span",{className:"text-center text-gray-500",children:"\uD83D\uDED2 Scan items to add to cart"})}):(0,s.jsxs)(R,{children:[(0,s.jsx)($,{children:(0,s.jsxs)(O,{children:[(0,s.jsx)(B,{className:"text-lg font-semibold",children:"Barcode"}),(0,s.jsx)(B,{className:"text-lg font-semibold",children:"Name"}),(0,s.jsx)(B,{className:"text-lg font-semibold",children:"Price"}),(0,s.jsx)(B,{className:"text-lg font-semibold",children:"Quantity"}),(0,s.jsx)(B,{className:"text-lg font-semibold",children:"Discount"})]})}),(0,s.jsx)(M,{children:t.map(e=>(0,s.jsxs)(O,{className:"hover:bg-gray-50 cursor-pointer ".concat(a===e.id?"bg-gray-100":""),onClick:()=>r(e.id),children:[(0,s.jsx)(Y,{className:"font-medium",children:e.product.barcode||"N/A"}),(0,s.jsx)(Y,{children:e.product.name}),(0,s.jsxs)(Y,{children:["₱ ",e.product.price.toFixed(2)]}),(0,s.jsx)(Y,{children:(0,s.jsx)(v.p,{type:"number",min:1,value:e.quantity,className:"w-16",onClick:e=>e.stopPropagation(),onChange:t=>{let a=Math.max(1,Number(t.target.value));l(e.id,a)},disabled:n})}),(0,s.jsx)(Y,{children:"₱ 0.00"})]},e.id))})]})}var I=a(47924);function Q(e){let{searchQuery:t,searchResults:a,showSearchResults:r,handleSearchChange:l,handleSearchSelect:n,refocusScanner:i,disabled:o=!1}=e;return(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsxs)("div",{className:"relative flex items-center",children:[(0,s.jsx)(I.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)(v.p,{className:"pl-9 w-full",placeholder:"Search by product name or barcode...",value:t,onChange:e=>l(e.target.value),onClick:e=>e.stopPropagation(),onBlur:i,disabled:o})]}),r&&a.length>0&&(0,s.jsx)("div",{className:"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 max-h-60 overflow-y-auto",children:a.map(e=>(0,s.jsx)("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b last:border-b-0",onClick:()=>n(e),children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Barcode: ",e.barcode]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"font-medium",children:["₱ ",e.price.toFixed(2)]})})]})},e.id))}),r&&0===a.length&&t.length>=2&&(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 p-3 text-center text-gray-500",children:['No products found matching "',t,'"']})]})}function W(e){let{inputRef:t,barcodeInput:a,handleBarcodeChange:r,handleKeyPress:l,disabled:n=!1}=e;return(0,s.jsx)(v.p,{ref:t,className:"opacity-0 absolute -top-1000",value:a,onChange:r,onKeyPress:l,placeholder:"Scanner input...",disabled:n})}var H=a(88076),G=a(90010),U=a(16453);function J(e){let{step:t}=e,{selectedRowId:a,selectRow:l}=function(){let[e,t]=(0,r.useState)(null);return{selectedRowId:e,selectRow:e=>t(e),clearSelection:()=>t(null)}}(),{products:n}=(0,q.Q)(),{cart:i,updateCartItemQuantity:d,scanAndAddToCart:x,setScannerRef:m,refocusScanner:h}=o(),{barcodeInput:f,inputRef:g,handleBarcodeChange:j,handleKeyPress:v}=P(function(e){n.find(t=>t.barcode===e)?(x(e),h()):(L(e),A(!0))}),{setOpen:b,setBarcode:y}=(0,H.c)();c(a);let{searchQuery:N,searchResults:w,showSearchResults:S,handleSearchChange:C,clearSearch:k}=T(n),[_,A]=(0,r.useState)(!1),[z,L]=(0,r.useState)(null);return(0,r.useEffect)(()=>{m(g)},[m,g]),(0,r.useEffect)(()=>{(2===t||3===t)&&(null==g?void 0:g.current)&&g.current.blur()},[t]),(0,s.jsxs)("div",{className:"relative w-full h-full",children:[(0,s.jsx)(u,{className:"w-full h-full flex flex-col",onClick:()=>h(),children:(0,s.jsxs)(p,{className:"p-6 flex-1 flex flex-col min-h-0",children:[(0,s.jsx)(W,{inputRef:g,barcodeInput:f,handleBarcodeChange:j,handleKeyPress:v,disabled:2===t||3===t}),(0,s.jsx)(Q,{searchQuery:N,searchResults:w,showSearchResults:S,handleSearchChange:C,handleSearchSelect:e=>{x(e.barcode||""),k(),h()},clearSearch:k,refocusScanner:h,disabled:2===t||3===t}),(0,s.jsx)("div",{className:"rounded-md border flex-1 flex flex-col min-h-0 overflow-auto relative",children:(0,s.jsx)(K,{cart:i,selectedRowId:a,selectRow:l,updateCartItemQuantity:d,disabled:2===t||3===t})})]})}),(0,s.jsx)(U.default,{}),(0,s.jsx)(G.Lt,{open:_,onOpenChange:A,children:(0,s.jsxs)(G.EO,{children:[(0,s.jsxs)(G.wd,{children:[(0,s.jsx)(G.r7,{children:"Product Not Registered"}),(0,s.jsxs)(G.$v,{children:["The scanned product (",(0,s.jsx)("span",{className:"font-bold",children:z}),") is not registered. Would you like to register it?"]})]}),(0,s.jsxs)(G.ck,{children:[(0,s.jsx)(G.Zr,{onClick:()=>A(!1),children:"Cancel"}),(0,s.jsx)(G.Rx,{onClick:()=>z&&void(A(!1),y(z),b(!0)),children:"Register Product"})]})]})})]})}function V(){let[e,t]=(0,r.useState)(1);return(0,s.jsx)(i,{children:(0,s.jsx)("div",{className:"flex flex-col w-full h-full py-4 px-4",children:(0,s.jsxs)("div",{className:"flex gap-2 h-full",children:[(0,s.jsx)("div",{className:"flex-[70%]",children:(0,s.jsx)(J,{step:e})}),(0,s.jsx)("div",{className:"flex flex-col flex-[30%] gap-2",children:(0,s.jsx)(F,{step:e,setStep:t})})]})})})}function Z(){let{setOpen:e}=(0,H.c)();return(0,s.jsxs)("div",{className:"flex justify-between items-center h-full",children:[(0,s.jsx)("div",{className:"text-4xl font-bold",children:(0,s.jsx)("h1",{children:"Products"})}),(0,s.jsxs)(j.$,{className:"flex items-center justify-center gap-2 p-6",onClick:()=>e(!0),children:[(0,s.jsx)(w.A,{className:"text-white w-5 h-5 !w-5 !h-5"}),"Add Product"]})]})}var X=a(34953);let ee=()=>l.G.getAll();function et(){let{data:e=[],isLoading:t}=(0,X.Ay)("/api/products",ee,{revalidateOnFocus:!1}),a=e.filter(e=>e&&"number"==typeof e.quantity&&"number"==typeof e.price),r=a.length,l=a.filter(e=>e.quantity<5&&e.quantity>0).length,n=a.filter(e=>0===e.quantity).length,i=a.reduce((e,t)=>e+t.price*t.quantity,0),o=[{title:"Total Products",content:t?"...":r},{title:"Low Stock Items",content:t?"...":l},{title:"Out of Stock",content:t?"...":n},{title:"Total Value",content:t?"...":"₱ ".concat(i.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))}];return(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4 w-full h-full",children:o.map((e,t)=>(0,s.jsx)(u,{children:(0,s.jsxs)(p,{className:"flex flex-col justify-center items-start h-full",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold pb-4",children:e.title}),(0,s.jsx)("p",{className:"text-2xl font-bold ",children:e.content})]})},t))})}var ea=a(44838),es=a(93081),er=a(66474),el=a(5196),en=a(47863);function ei(e){let{...t}=e;return(0,s.jsx)(es.bL,{"data-slot":"select",...t})}function eo(e){let{...t}=e;return(0,s.jsx)(es.WT,{"data-slot":"select-value",...t})}function ec(e){let{className:t,size:a="default",children:r,...l}=e;return(0,s.jsxs)(es.l9,{"data-slot":"select-trigger","data-size":a,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[r,(0,s.jsx)(es.In,{asChild:!0,children:(0,s.jsx)(er.A,{className:"size-4 opacity-50"})})]})}function ed(e){let{className:t,children:a,position:r="popper",...l}=e;return(0,s.jsx)(es.ZL,{children:(0,s.jsxs)(es.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[(0,s.jsx)(ex,{}),(0,s.jsx)(es.LM,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(em,{})]})})}function eu(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(es.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(es.VF,{children:(0,s.jsx)(el.A,{className:"size-4"})})}),(0,s.jsx)(es.p4,{children:a})]})}function ex(e){let{className:t,...a}=e;return(0,s.jsx)(es.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(en.A,{className:"size-4"})})}function em(e){let{className:t,...a}=e;return(0,s.jsx)(es.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(er.A,{className:"size-4"})})}var eh=a(66932),ef=a(3405);function ep(e){let{selectedCategory:t,setSelectedCategory:a,selectedProducts:r,setSelectedProducts:l}=e,{categories:n,loading:i,error:o}=(0,ef.C)();return(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"relative flex items-center w-[700px]",children:[(0,s.jsx)(I.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)(v.p,{className:"pl-9 w-full",placeholder:"Search by product name or barcode...",onClick:e=>e.stopPropagation()})]}),(0,s.jsx)("div",{className:"class"}),(0,s.jsxs)(ea.rI,{children:[(0,s.jsx)(ea.ty,{asChild:!0,children:(0,s.jsxs)(j.$,{variant:"outline",children:[(0,s.jsx)(eh.A,{}),"Filter"]})}),(0,s.jsxs)(ea.SQ,{className:"w-[300px] mr-18",children:[(0,s.jsx)(ea.lp,{children:"Filter"}),(0,s.jsx)(ea.mB,{}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h1",{className:"text-sm font-medium",children:"Category"}),(0,s.jsxs)(ei,{value:t,onValueChange:a,children:[(0,s.jsx)(ec,{className:"w-full mt-2",children:(0,s.jsx)(eo,{placeholder:"Category"})}),(0,s.jsxs)(ed,{children:[(0,s.jsx)(eu,{value:"all",children:"All Categories"}),i&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"Loading categories..."}),o&&(0,s.jsx)("div",{className:"p-2 text-red-500",children:o}),!i&&!o&&n.map(e=>(0,s.jsx)(eu,{value:String(e.id),children:e.name},e.id))]})]})]}),(0,s.jsx)(ea.mB,{}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h1",{className:"text-sm font-medium",children:"Status"}),(0,s.jsxs)(ei,{value:r,onValueChange:l,children:[(0,s.jsx)(ec,{className:"w-full mt-2",children:(0,s.jsx)(eo,{placeholder:"Status"})}),(0,s.jsxs)(ed,{children:[(0,s.jsx)(eu,{value:"all",children:"All Stock"}),(0,s.jsx)(eu,{value:"in stock",children:"In Stock"}),(0,s.jsx)(eu,{value:"low stock",children:"Low Stock"}),(0,s.jsx)(eu,{value:"out of stock",children:"Out of Stock"})]})]})]}),(0,s.jsx)(ea.mB,{}),(0,s.jsx)("div",{className:"flex justify-between w-full p-2 font-thin ",children:(0,s.jsx)(j.$,{className:"font-normal bg-white text-black border",variant:"ghost",onClick:()=>{a("all"),l("all")},children:"Reset All"})})]})]})]})}var eg=a(19667),ej=a(36268),ev=a(11032);function eb(e){let{columns:t,data:a,page:l,pageSize:n,onFilteredCountChange:i}=e,[o,c]=(0,r.useState)([]),d=(0,ej.N4)({data:a,columns:t,state:{sorting:o},onSortingChange:c,getCoreRowModel:(0,ev.HT)(),getSortedRowModel:(0,ev.h5)()});(0,r.useEffect)(()=>{i&&i(d.getRowModel().rows.length)},[d,i]);let u=d.getRowModel().rows.slice(l*n,(l+1)*n);return(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(R,{children:[(0,s.jsx)($,{children:d.getHeaderGroups().map(e=>(0,s.jsx)(O,{children:e.headers.map(e=>(0,s.jsx)(B,{children:e.isPlaceholder?null:(0,ej.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(M,{children:u.length?u.map(e=>(0,s.jsx)(O,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(Y,{children:(0,ej.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(O,{children:(0,s.jsx)(Y,{colSpan:t.length,className:"h-24 text-center",children:"No results."})})})]})})}var ey=a(21492),eN=a(89917),ew=a(62525),eS=a(99708);let eC=(0,a(74466).F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ek(e){let{className:t,variant:a,asChild:r=!1,...l}=e,n=r?eS.DX:"span";return(0,s.jsx)(n,{"data-slot":"badge",className:(0,d.cn)(eC({variant:a}),t),...l})}let e_=[{accessorKey:"productName",header:e=>{let{column:t}=e;return(0,s.jsxs)("button",{className:"flex items-center gap-2 font-medium focus:outline-none",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Product",(0,s.jsx)(ey.A,{className:"ml-1 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex items-center font-medium",children:t.getValue("productName")})}},{accessorKey:"barcode",header:"Barcode"},{accessorKey:"category",header:"Category"},{accessorKey:"currentStock",header:e=>{let{column:t}=e;return(0,s.jsxs)("button",{className:"flex items-center gap-2 font-medium focus:outline-none",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Current Stock",(0,s.jsx)(ey.A,{className:"ml-1 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex items-center font-medium",children:t.getValue("currentStock")})}},{accessorKey:"productPrice",header:"Price"},{accessorKey:"status",header:"Status",cell:e=>{let{row:t}=e,a=t.original.status,r="default";return"out of stock"===a?r="destructive":"low stock"===a?r="secondary":"in stock"===a&&(r="default"),(0,s.jsx)(ek,{variant:r,className:"in stock"===a?"bg-green-300 text-black":"low stock"===a?"bg-yellow-500 text-black":"out of stock"===a?"bg-red-500 text-white":"",children:a.replace(/^\w/,e=>e.toUpperCase())})}},{id:"actions",header:()=>(0,s.jsx)("div",{className:"text-center font-medium",children:"Actions"}),cell:()=>(0,s.jsxs)("div",{className:"flex gap-5 justify-center",children:[(0,s.jsx)(j.$,{variant:"outline",size:"icon",children:(0,s.jsx)(eN.A,{className:"w-4 h-4"})}),(0,s.jsx)(j.$,{variant:"outline",size:"icon",children:(0,s.jsx)(ew.A,{className:"w-4 h-4"})})]}),enableSorting:!1,enableHiding:!1}];var eA=a(42355),ez=a(13052),eL=a(5623);function eE(e){let{className:t,...a}=e;return(0,s.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,d.cn)("mx-auto flex w-full justify-center",t),...a})}function eD(e){let{className:t,...a}=e;return(0,s.jsx)("ul",{"data-slot":"pagination-content",className:(0,d.cn)("flex flex-row items-center gap-1",t),...a})}function eF(e){let{...t}=e;return(0,s.jsx)("li",{"data-slot":"pagination-item",...t})}function eq(e){let{className:t,isActive:a,size:r="icon",...l}=e;return(0,s.jsx)("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:(0,d.cn)((0,j.r)({variant:a?"outline":"ghost",size:r}),t),...l})}function eP(e){let{className:t,...a}=e;return(0,s.jsxs)(eq,{"aria-label":"Go to previous page",size:"default",className:(0,d.cn)("gap-1 px-2.5 sm:pl-2.5",t),...a,children:[(0,s.jsx)(eA.A,{}),(0,s.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function eT(e){let{className:t,...a}=e;return(0,s.jsxs)(eq,{"aria-label":"Go to next page",size:"default",className:(0,d.cn)("gap-1 px-2.5 sm:pr-2.5",t),...a,children:[(0,s.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,s.jsx)(ez.A,{})]})}function eR(e){let{className:t,...a}=e;return(0,s.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,d.cn)("flex size-9 items-center justify-center",t),...a,children:[(0,s.jsx)(eL.A,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"More pages"})]})}function e$(e){let{page:t,pageCount:a,setPage:r,pageSize:l,onPageSizeChange:n}=e;return(0,s.jsxs)(eE,{className:"mt-2 flex items-center gap-4",children:[(0,s.jsxs)(eD,{children:[(0,s.jsx)(eF,{children:(0,s.jsx)(eP,{href:"#",onClick:e=>{e.preventDefault(),r(Math.max(t-1,0))},"aria-disabled":0===t})}),Array.from({length:a},(e,a)=>(0,s.jsx)(eF,{children:(0,s.jsx)(eq,{href:"#",isActive:a===t,onClick:e=>{e.preventDefault(),r(a)},children:a+1})},a)),a>5&&(0,s.jsx)(eF,{children:(0,s.jsx)(eR,{})}),(0,s.jsx)(eF,{children:(0,s.jsx)(eT,{href:"#",onClick:e=>{e.preventDefault(),r(Math.min(t+1,a-1))},"aria-disabled":t===a-1})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{htmlFor:"page-size",className:"text-sm",children:"Rows per page:"}),(0,s.jsx)("input",{id:"page-size",type:"number",min:1,max:100,value:l,onChange:e=>n(Number(e.target.value)),className:"border rounded px-2 py-1 w-16 text-sm"})]})]})}var eM=a(56671);let eO=()=>l.G.getAll();function eB(e){var t;let{selectedCategory:a,selectedStatus:n,onProductDeleted:i}=e,{data:o=[],isLoading:c,error:d}=(0,X.Ay)("/api/products",eO,{revalidateOnFocus:!1}),[u,x]=(0,r.useState)(0),[m,h]=(0,r.useState)(6),[f,p]=(0,r.useState)(null),[g,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[S,C]=(0,r.useState)(null),[k,A]=(0,r.useState)(!1),{categories:z,loading:L,error:E}=(0,ef.C)(),[D,F]=(0,r.useState)(""),[q,P]=(0,r.useState)({name:"",barcode:"",category_id:"",price:0,quantity:0}),T=o.find(e=>String(e.id)===String(f));(0,r.useEffect)(()=>{if(g&&T){var e,t,a,s,r;P({name:null!=(e=T.name)?e:"",barcode:null!=(t=T.barcode)?t:"",category_id:String(null!=(a=T.category_id)?a:""),price:null!=(s=T.price)?s:0,quantity:null!=(r=T.quantity)?r:0})}},[g,f]);let R="all"===a?o:o.filter(e=>String(e.category_id)===a);n&&"all"!==n&&(R=R.filter(e=>{let t;return(0===e.quantity?"out of stock":e.quantity<5?"low stock":"in stock")===n}));let $=(null!=R?R:[]).map(e=>(function(e,t){var a;let s;s=0===e.quantity?"out of stock":e.quantity<5?"low stock":"in stock";let r=t.find(t=>String(t.id)===String(e.category_id));return{id:String(e.id),productName:e.name,barcode:null!=(a=e.barcode)?a:"",category:r?r.name:"Category ".concat(e.category_id),currentStock:e.quantity,productPrice:e.price,status:s}})(e,z)),M=Math.max(1,Math.ceil($.length/m)),O=e=>{p(e.id),y(!0),w(!1)},B=e=>{C(e),A(!0)},Y=async()=>{if(w(!1),!T)return void(0,eM.oR)("Product data not loaded",{description:"Please try again."});try{await l.G.update(T.id,{name:q.name,barcode:q.barcode,category_id:Number(q.category_id),price:Number(q.price),quantity:Number(q.quantity)}),(0,eM.oR)("Product updated",{description:"".concat(q.name," has been updated.")}),y(!1),(0,eg.j)("/api/products")}catch(e){(0,eM.oR)("Failed to update product",{description:(null==e?void 0:e.message)||"An error occurred."})}},K=async()=>{if(S)try{await l.G.delete(S.id),(0,eM.oR)("Product deleted",{description:"".concat(S.name," has been deleted.")}),A(!1),C(null),(0,eg.j)("/api/products"),i&&i(S.id)}catch(e){(0,eM.oR)("Failed to delete product",{description:(null==e?void 0:e.message)||"An error occurred."})}};return(0,s.jsxs)("div",{className:"w-full mt-4 relative",children:[(0,s.jsx)(eb,{columns:e_.map(e=>"actions"===e.id?{...e,cell:e=>{let{row:t}=e;return(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(j.$,{variant:"outline",size:"icon",onClick:()=>O(t.original),disabled:c,children:(0,s.jsx)(eN.A,{className:"w-4 h-4"})}),(0,s.jsx)(j.$,{variant:"outline",size:"icon",onClick:()=>B(t.original),children:(0,s.jsx)(ew.A,{className:"w-4 h-4"})})]})}}:e),data:$,page:u,pageSize:m}),(0,s.jsx)("div",{className:"mt-7",children:(0,s.jsx)(e$,{page:u,pageCount:M,setPage:x,pageSize:m,onPageSizeChange:e=>{h(e),x(0)}})}),(0,s.jsx)(_.lG,{open:g,onOpenChange:y,children:(0,s.jsx)(_.Cf,{children:T?N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.L3,{children:"Confirm Update"}),(0,s.jsx)(_.rr,{children:"This will update the product details."}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,s.jsx)("h2",{className:"font-bold text-lg mb-2",children:"Are you absolutely sure?"}),(0,s.jsx)("p",{className:"mb-6 text-gray-500",children:"This will update the product details."}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(j.$,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),(0,s.jsx)(j.$,{onClick:Y,children:"Continue"})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(_.c7,{children:[(0,s.jsx)(_.L3,{children:"Product"}),(0,s.jsx)(_.rr,{children:"Fill in the details below to update the product."})]}),(0,s.jsxs)("div",{className:"flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(b.J,{htmlFor:"edit-name",children:"Product Name"}),(0,s.jsx)(v.p,{id:"edit-name",name:"name",value:q.name,onChange:e=>P(t=>({...t,name:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 mt-4",children:[(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(b.J,{htmlFor:"edit-barcode",children:"Barcode"}),(0,s.jsx)(v.p,{id:"edit-barcode",name:"barcode",value:q.barcode,onChange:e=>P(t=>({...t,barcode:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(b.J,{htmlFor:"edit-category",children:"Category"}),(0,s.jsxs)(ea.rI,{children:[(0,s.jsx)(ea.ty,{asChild:!0,children:(0,s.jsx)(v.p,{id:"edit-category",readOnly:!0,value:(null==(t=z.find(e=>String(e.id)===String(q.category_id)))?void 0:t.name)||"",placeholder:"Select category",className:"cursor-pointer"})}),(0,s.jsxs)(ea.SQ,{className:"w-64",children:[(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(v.p,{placeholder:"Search category...",value:D,onChange:e=>F(e.target.value),className:"mb-2"})}),L&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"Loading..."}),E&&(0,s.jsx)("div",{className:"p-2 text-red-500",children:E}),!L&&!E&&(0,s.jsxs)(s.Fragment,{children:[z.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())).map(e=>(0,s.jsx)(ea._2,{onClick:()=>{P(t=>({...t,category_id:String(e.id)})),F("")},children:e.name},e.id)),0===z.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())).length&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"No categories found."})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 my-4",children:[(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(b.J,{htmlFor:"edit-price",children:"Price"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500 pointer-events-none",children:"₱"}),(0,s.jsx)(v.p,{id:"edit-price",name:"price",type:"number",value:0===q.price?"":String(q.price),onChange:e=>P(t=>({...t,price:""===e.target.value?0:Number(e.target.value)})),className:"pl-8"})]})]}),(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(b.J,{htmlFor:"edit-quantity",children:"Quantity"}),(0,s.jsx)(v.p,{id:"edit-quantity",name:"quantity",type:"number",value:0===q.quantity?"":String(q.quantity),onChange:e=>P(t=>({...t,quantity:""===e.target.value?0:Number(e.target.value)}))})]})]}),(0,s.jsxs)(_.Es,{children:[(0,s.jsx)(_.HM,{asChild:!0,children:(0,s.jsx)(j.$,{variant:"outline",onClick:()=>y(!1),children:"Cancel"})}),(0,s.jsx)(j.$,{onClick:()=>w(!0),children:"Update Product"})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.L3,{children:"Loading"}),(0,s.jsx)(_.rr,{children:"Loading product data..."}),(0,s.jsx)("div",{className:"p-4 text-center",children:"Loading..."})]})})}),(0,s.jsx)(_.lG,{open:k,onOpenChange:A,children:(0,s.jsxs)(_.Cf,{children:[(0,s.jsxs)(_.c7,{children:[(0,s.jsx)(_.L3,{children:"Are you absolutely sure?"}),(0,s.jsx)(_.rr,{children:"This action cannot be undone. This will permanently delete the product and remove it from your database."})]}),(0,s.jsxs)(_.Es,{children:[(0,s.jsx)(j.$,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,s.jsx)(j.$,{variant:"destructive",onClick:K,disabled:!S,children:"Continue"})]})]})})]})}function eY(e){let{products:t,onProductDeleted:a}=e,[l,n]=(0,r.useState)("all"),[i,o]=(0,r.useState)("all"),[c,d]=(0,r.useState)("");return(0,s.jsxs)(u,{className:"h-full w-full",children:[(0,s.jsx)(x,{children:(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Product Catalog"})}),(0,s.jsxs)(p,{children:[(0,s.jsx)(ep,{selectedCategory:l,setSelectedCategory:n,selectedProducts:i,setSelectedProducts:o}),(0,s.jsx)(eB,{selectedCategory:l,selectedStatus:i,onProductDeleted:a})]})]})}function eK(){let{products:e,refetch:t}=(0,q.Q)(),[a,l]=(0,r.useState)(e);return(0,r.useEffect)(()=>{l(e)},[e]),(0,s.jsxs)("div",{className:"flex flex-col gap-4 h-full p-8",children:[(0,s.jsx)("div",{className:"flex-[7%]",children:(0,s.jsx)(Z,{})}),(0,s.jsx)("div",{className:"flex-[18%]",children:(0,s.jsx)(et,{})}),(0,s.jsx)("div",{className:"flex-[75%]",children:(0,s.jsx)(eY,{products:a,onProductDeleted:e=>{l(t=>t.filter(t=>t.id!==e))}})})]})}var eI=a(55868),eQ=a(37108),eW=a(27809),eH=a(23464);let eG=()=>{let[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[l,n]=(0,r.useState)(null),i=async()=>{try{s(!0),n(null);let e=await eH.A.get("http://13.211.162.106:5000/api/sales-items");t(e.data.data)}catch(e){n(e instanceof Error?e.message:"Unknown error")}finally{s(!1)}};return(0,r.useEffect)(()=>{i()},[]),{saleItems:e,loading:a,error:l,refetch:i}},eU=()=>{let[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[l,n]=(0,r.useState)(null),i=async()=>{try{s(!0),n(null);let e=await eH.A.get("http://13.211.162.106:5000/api/sales");t(e.data.data)}catch(e){n(e instanceof Error?e.message:"Unknown error")}finally{s(!1)}};return(0,r.useEffect)(()=>{i()},[]),{sales:e,loading:a,error:l,refetch:i}};function eJ(){let{saleItems:e,loading:t}=eG(),{products:a,loading:r}=(0,q.Q)(),{sales:l,loading:n}=eU(),i=e=>("string"==typeof e?new Date(e):e).toISOString().slice(0,10),o=i(new Date),c=l.filter(e=>i(e.created_at)===o),d=c.reduce((e,t)=>e+t.total_purchase,0),h=c.length;a.length;let f=e.filter(e=>i(e.created_at)===o).reduce((e,t)=>e+t.quantity,0),g=[{title:"Today's Sales",content:n?"...":"₱ ".concat(d.toLocaleString()),icon:(0,s.jsx)(eI.A,{size:20})},{title:"Items Sold Today",content:t?"...":f.toLocaleString(),icon:(0,s.jsx)(eQ.A,{size:20})},{title:"Today's Transactions",content:n?"...":h.toLocaleString(),icon:(0,s.jsx)(eW.A,{size:20})}];return(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4 w-full h-full",children:g.map((e,t)=>(0,s.jsxs)(u,{className:"gap-0 flex justify-center",children:[(0,s.jsxs)(x,{className:"mb-4 flex flex-row justify-between items-center",children:[(0,s.jsx)(m,{className:"text-md font-semibold",children:e.title}),(0,s.jsx)("div",{className:"opacity-60",children:e.icon})]}),(0,s.jsx)(p,{children:(0,s.jsx)("div",{className:"text-3xl font-bold mb-6",children:e.content})})]},t))})}var eV=a(15968),eZ=a(69074),eX=a(3401),e0=a(94754),e1=a(96025),e2=a(58227),e5=a(15933),e4=a(50713),e6=a(28406);function e3(){let e=(0,e5._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return e3=function(){return e},e}function e8(){let e=(0,e5._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return e8=function(){return e},e}function e7(e){let{className:t,classNames:a,showOutsideDays:r=!0,captionLayout:l="label",buttonVariant:n="ghost",formatters:i,components:o,...c}=e,u=(0,e4.a)();return(0,s.jsx)(e6.h,{showOutsideDays:r,className:(0,d.cn)("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw(e3()),String.raw(e8()),t),captionLayout:l,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...i},classNames:{root:(0,d.cn)("w-fit",u.root),months:(0,d.cn)("flex gap-4 flex-col md:flex-row relative",u.months),month:(0,d.cn)("flex flex-col w-full gap-4",u.month),nav:(0,d.cn)("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",u.nav),button_previous:(0,d.cn)((0,j.r)({variant:n}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_previous),button_next:(0,d.cn)((0,j.r)({variant:n}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_next),month_caption:(0,d.cn)("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",u.month_caption),dropdowns:(0,d.cn)("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",u.dropdowns),dropdown_root:(0,d.cn)("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",u.dropdown_root),dropdown:(0,d.cn)("absolute bg-popover inset-0 opacity-0",u.dropdown),caption_label:(0,d.cn)("select-none font-medium","label"===l?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",u.caption_label),table:"w-full border-collapse",weekdays:(0,d.cn)("flex",u.weekdays),weekday:(0,d.cn)("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",u.weekday),week:(0,d.cn)("flex w-full mt-2",u.week),week_number_header:(0,d.cn)("select-none w-(--cell-size)",u.week_number_header),week_number:(0,d.cn)("text-[0.8rem] select-none text-muted-foreground",u.week_number),day:(0,d.cn)("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",u.day),range_start:(0,d.cn)("rounded-l-md bg-accent",u.range_start),range_middle:(0,d.cn)("rounded-none",u.range_middle),range_end:(0,d.cn)("rounded-r-md bg-accent",u.range_end),today:(0,d.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",u.today),outside:(0,d.cn)("text-muted-foreground aria-selected:text-muted-foreground",u.outside),disabled:(0,d.cn)("text-muted-foreground opacity-50",u.disabled),hidden:(0,d.cn)("invisible",u.hidden),...a},components:{Root:e=>{let{className:t,rootRef:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"calendar",ref:a,className:(0,d.cn)(t),...r})},Chevron:e=>{let{className:t,orientation:a,...r}=e;return"left"===a?(0,s.jsx)(eA.A,{className:(0,d.cn)("size-4",t),...r}):"right"===a?(0,s.jsx)(ez.A,{className:(0,d.cn)("size-4",t),...r}):(0,s.jsx)(er.A,{className:(0,d.cn)("size-4",t),...r})},DayButton:e9,WeekNumber:e=>{let{children:t,...a}=e;return(0,s.jsx)("td",{...a,children:(0,s.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:t})})},...o},...c})}function e9(e){let{className:t,day:a,modifiers:l,...n}=e,i=(0,e4.a)(),o=r.useRef(null);return r.useEffect(()=>{var e;l.focused&&(null==(e=o.current)||e.focus())},[l.focused]),(0,s.jsx)(j.$,{ref:o,variant:"ghost",size:"icon","data-day":a.date.toLocaleDateString(),"data-selected-single":l.selected&&!l.range_start&&!l.range_end&&!l.range_middle,"data-range-start":l.range_start,"data-range-end":l.range_end,"data-range-middle":l.range_middle,className:(0,d.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",i.day,t),...n})}var te=a(83540),tt=a(94517),ta=a(24026);let ts={light:"",dark:".dark"},tr=r.createContext(null);function tl(e){let{id:t,className:a,children:l,config:n,...i}=e,o=r.useId(),c="chart-".concat(t||o.replace(/:/g,""));return(0,s.jsx)(tr.Provider,{value:{config:n},children:(0,s.jsxs)("div",{"data-slot":"chart","data-chart":c,className:(0,d.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",a),...i,children:[(0,s.jsx)(tn,{id:c,config:n}),(0,s.jsx)(te.u,{children:l})]})})}let tn=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(ts).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,l=(null==(t=r.theme)?void 0:t[a])||r.color;return l?"  --color-".concat(s,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},ti=tt.m;function to(e){let{active:t,payload:a,className:l,indicator:n="dot",hideLabel:i=!1,hideIndicator:o=!1,label:c,labelFormatter:u,labelClassName:x,formatter:m,color:h,nameKey:f,labelKey:p}=e,{config:g}=function(){let e=r.useContext(tr);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),j=r.useMemo(()=>{var e;if(i||!(null==a?void 0:a.length))return null;let[t]=a,r="".concat(p||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),l=tc(g,t,r),n=p||"string"!=typeof c?null==l?void 0:l.label:(null==(e=g[c])?void 0:e.label)||c;return u?(0,s.jsx)("div",{className:(0,d.cn)("font-medium",x),children:u(n,a)}):n?(0,s.jsx)("div",{className:(0,d.cn)("font-medium",x),children:n}):null},[c,u,a,i,x,g,p]);if(!t||!(null==a?void 0:a.length))return null;let v=1===a.length&&"dot"!==n;return(0,s.jsxs)("div",{className:(0,d.cn)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",l),children:[v?null:j,(0,s.jsx)("div",{className:"grid gap-1.5",children:a.map((e,t)=>{let a="".concat(f||e.name||e.dataKey||"value"),r=tc(g,e,a),l=h||e.payload.fill||e.color;return(0,s.jsx)("div",{className:(0,d.cn)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===n&&"items-center"),children:m&&(null==e?void 0:e.value)!==void 0&&e.name?m(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!o&&(0,s.jsx)("div",{className:(0,d.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":v&&"dashed"===n}),style:{"--color-bg":l,"--color-border":l}}),(0,s.jsxs)("div",{className:(0,d.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[v?j:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function tc(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}ta.s;var td=a(20547);function tu(e){let{...t}=e;return(0,s.jsx)(td.bL,{"data-slot":"popover",...t})}function tx(e){let{...t}=e;return(0,s.jsx)(td.l9,{"data-slot":"popover-trigger",...t})}function tm(e){let{className:t,align:a="center",sideOffset:r=4,...l}=e;return(0,s.jsx)(td.ZL,{children:(0,s.jsx)(td.UC,{"data-slot":"popover-content",align:a,sideOffset:r,className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}let th={quantity:{label:"Quantity Sold",color:"var(--color-primary)"}},tf=async e=>{let t=await fetch(e);return(await t.json()).data};function tp(){let e="http://13.211.162.106:5000/api",{data:t=[],error:a,isLoading:l}=(0,X.Ay)("".concat(e,"/sales-items"),tf),{data:n=[],error:i,isLoading:o}=(0,X.Ay)("".concat(e,"/products"),tf),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),1),[v,b]=(0,r.useState)({from:d,to:c}),[y,N]=(0,r.useState)("normal"),w=(0,r.useMemo)(()=>{let e={};return n.forEach(t=>{e[t.id]=t.name}),e},[n]),S=(e,t)=>e.setHours(0,0,0,0)>=t.setHours(0,0,0,0),C=(e,t)=>e.setHours(0,0,0,0)<=t.setHours(0,0,0,0),k=(0,r.useMemo)(()=>{let e={};t.forEach(t=>{let a=new Date(t.created_at);(!(null==v?void 0:v.from)||S(a,v.from))&&(!(null==v?void 0:v.to)||C(a,v.to))&&(e[t.product_id]=(e[t.product_id]||0)+t.quantity)});let a=Object.entries(e).map(e=>{let[t,a]=e;return{product:w[Number(t)]||"Product ".concat(t),quantity:a}});return"asc"===y?a=a.sort((e,t)=>e.quantity-t.quantity):"desc"===y&&(a=a.sort((e,t)=>t.quantity-e.quantity)),a},[t,v,w,y]),_=(0,r.useMemo)(()=>k.reduce((e,t)=>e+t.quantity,0),[k]);return l||o?(0,s.jsx)("div",{children:"Loading..."}):a||i?(0,s.jsx)("div",{children:"Error loading product stats."}):(0,s.jsxs)(u,{className:"@container/card w-full",children:[(0,s.jsxs)(x,{className:"flex flex-col border-b @md/card:grid",children:[(0,s.jsx)(m,{children:"Product Analytics"}),(0,s.jsx)(h,{children:"Showing most sold products for this month."}),(0,s.jsx)(f,{className:"mt-2 @md/card:mt-0",children:(0,s.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,s.jsx)(j.$,{variant:"desc"===y?"default":"outline",size:"sm",onClick:()=>N("desc"),"aria-label":"Sort Descending",children:(0,s.jsx)(er.A,{size:16})}),(0,s.jsx)(j.$,{variant:"normal"===y?"default":"outline",size:"sm",onClick:()=>N("normal"),"aria-label":"Follow Order",children:(0,s.jsx)(eV.A,{size:16})}),(0,s.jsx)(j.$,{variant:"asc"===y?"default":"outline",size:"sm",onClick:()=>N("asc"),"aria-label":"Sort Ascending",children:(0,s.jsx)(en.A,{size:16})}),(0,s.jsxs)(tu,{children:[(0,s.jsx)(tx,{asChild:!0,children:(0,s.jsxs)(j.$,{variant:"outline",children:[(0,s.jsx)(eZ.A,{}),(null==v?void 0:v.from)&&(null==v?void 0:v.to)?"".concat(v.from.toLocaleDateString()," - ").concat(v.to.toLocaleDateString()):"".concat(d.toLocaleDateString()," - ").concat(c.toLocaleDateString())]})}),(0,s.jsx)(tm,{className:"w-auto overflow-hidden p-0",align:"end",children:(0,s.jsx)(e7,{className:"w-full",mode:"range",defaultMonth:null==v?void 0:v.from,selected:v,onSelect:b,fixedWeeks:!0,showOutsideDays:!0,disabled:{after:c}})})]})]})})]}),(0,s.jsx)(p,{className:"px-4",children:(0,s.jsx)(tl,{config:th,className:"aspect-auto h-89 w-full",children:(0,s.jsxs)(eX.E,{accessibilityLayer:!0,data:k,margin:{left:12,right:12},children:[(0,s.jsx)(e0.d,{vertical:!1}),(0,s.jsx)(e1.W,{dataKey:"product",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:20}),(0,s.jsx)(ti,{content:(0,s.jsx)(to,{className:"w-[150px]",nameKey:"quantity",labelFormatter:e=>e})}),(0,s.jsx)(e2.y,{dataKey:"quantity",fill:"var(--color-quantity)",radius:4})]})})}),(0,s.jsx)(g,{className:"border-t",children:(0,s.jsxs)("div",{className:"text-sm",children:["Total sold: ",(0,s.jsx)("span",{className:"font-semibold",children:_.toLocaleString()})]})})]})}var tg=a(93504),tj=a(21374);let tv={customer:{label:"Total",color:"var(--color-primary)"}},tb=async e=>{let t=await fetch(e);return(await t.json()).data};function ty(){let{data:e=[],error:t,isLoading:a}=(0,X.Ay)("".concat("http://13.211.162.106:5000/api","/sales"),tb),l=new Date,n=new Date(l.getFullYear(),l.getMonth(),1),[i,o]=r.useState({from:n,to:l}),[c,d]=r.useState("normal"),v=(e,t)=>e.setHours(0,0,0,0)>=t.setHours(0,0,0,0),b=(e,t)=>e.setHours(0,0,0,0)<=t.setHours(0,0,0,0),y=r.useMemo(()=>{let t={};return e.forEach(e=>{var a;let s=e.created_at.slice(0,10);t[s]=(t[s]||0)+(null!=(a=e.total_purchase)?a:0)}),Object.entries(t).map(e=>{let[t,a]=e;return{date:t,customer:a}})},[e]),N=r.useMemo(()=>(null==i?void 0:i.from)||(null==i?void 0:i.to)?y.filter(e=>{let t=new Date(e.date);return(!i.from||v(t,i.from))&&(!i.to||b(t,i.to))}):y,[i,y]),w=r.useMemo(()=>{let e=[...N];return"asc"===c?e.sort((e,t)=>e.customer-t.customer):"desc"===c&&e.sort((e,t)=>t.customer-e.customer),e},[N,c]),S=r.useMemo(()=>w.reduce((e,t)=>e+t.customer,0),[w]);return a?(0,s.jsx)("div",{children:"Loading..."}):t?(0,s.jsx)("div",{children:"Error loading sales data."}):(0,s.jsxs)(u,{className:"@container/card w-full",children:[(0,s.jsxs)(x,{className:"flex flex-col border-b @md/card:grid",children:[(0,s.jsx)(m,{children:"Sales Chart"}),(0,s.jsx)(h,{children:"Filter total sales by date range"}),(0,s.jsx)(f,{className:"mt-2 @md/card:mt-0",children:(0,s.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,s.jsx)(j.$,{variant:"desc"===c?"default":"outline",size:"sm",onClick:()=>d("desc"),"aria-label":"Sort Descending",children:(0,s.jsx)(er.A,{size:16})}),(0,s.jsx)(j.$,{variant:"normal"===c?"default":"outline",size:"sm",onClick:()=>d("normal"),"aria-label":"Follow Order",children:(0,s.jsx)(eV.A,{size:16})}),(0,s.jsx)(j.$,{variant:"asc"===c?"default":"outline",size:"sm",onClick:()=>d("asc"),"aria-label":"Sort Ascending",children:(0,s.jsx)(en.A,{size:16})}),(0,s.jsxs)(tu,{children:[(0,s.jsx)(tx,{asChild:!0,children:(0,s.jsxs)(j.$,{variant:"outline",children:[(0,s.jsx)(eZ.A,{}),(null==i?void 0:i.from)&&(null==i?void 0:i.to)?"".concat(i.from.toLocaleDateString()," - ").concat(i.to.toLocaleDateString()):"".concat(n.toLocaleDateString()," - ").concat(l.toLocaleDateString())]})}),(0,s.jsx)(tm,{className:"w-auto overflow-hidden p-0",align:"end",children:(0,s.jsx)(e7,{className:"w-full",mode:"range",defaultMonth:null==i?void 0:i.from,selected:i,onSelect:o,fixedWeeks:!0,showOutsideDays:!0,disabled:{after:l}})})]})]})})]}),(0,s.jsx)(p,{className:"px-4",children:(0,s.jsx)(tl,{config:tv,className:"aspect-auto h-89 w-full",children:(0,s.jsxs)(tg.b,{accessibilityLayer:!0,data:w,margin:{left:12,right:12},children:[(0,s.jsx)(e0.d,{vertical:!1}),(0,s.jsx)(e1.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:20,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{day:"numeric"})}),(0,s.jsx)(ti,{content:(0,s.jsx)(to,{className:"w-[150px]",nameKey:"customer",labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}),(0,s.jsx)(tj.N,{dataKey:"customer",type:"monotone",stroke:"var(--color-customer)",strokeWidth:2,dot:!1})]})})}),(0,s.jsx)(g,{className:"border-t",children:(0,s.jsxs)("div",{className:"text-sm",children:["You had ",(0,s.jsxs)("span",{className:"font-semibold",children:["₱ ",S.toLocaleString()]})," total sales for the selected period."]})})]})}function tN(){return(0,s.jsxs)("div",{className:"flex flex-col p-6 h-full gap-3",children:[(0,s.jsxs)("div",{className:"flex-[7%]",children:[(0,s.jsx)("h1",{className:"font-extrabold text-4xl",children:"Dashboard"}),(0,s.jsx)("p",{children:"Welcome Back! Here's your business overview!"})]}),(0,s.jsx)("div",{className:"flex-[20%]",children:(0,s.jsx)(eJ,{})}),(0,s.jsxs)("div",{className:"flex-[78%] flex 2xl:flex-row gap-3 flex-col",children:[(0,s.jsx)("div",{className:"flex-[50%]",children:(0,s.jsx)(tp,{})}),(0,s.jsx)("div",{className:"flex-[50%]",children:(0,s.jsx)(ty,{})})]})]})}function tw(e){let{params:t}=e,{site:a}=(0,r.use)(t);switch(a){case"main":return(0,s.jsx)(tN,{});case"pos":return(0,s.jsx)(V,{});case"products":return(0,s.jsx)(eK,{});default:return(0,s.jsx)("div",{children:a})}}},50477:()=>{},68529:(e,t,a)=>{Promise.resolve().then(a.bind(a,12306))}},e=>{var t=t=>e(e.s=t);e.O(0,[247,788,746,792,252,220,453,441,684,358],()=>t(68529)),_N_E=e.O()}]);