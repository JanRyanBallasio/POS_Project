(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{50477:()=>{},59776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tb});var s=a(95155),r=a(12115),l=a(36764);let n=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,r.useState)([]),[i,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),h=async e=>{try{u(!0),c(null);let t=await l.G.getByBarcode(e);t?o(e=>{if(e.find(e=>e.product.barcode===t.barcode))return e.map(e=>e.product.barcode===t.barcode?{...e,quantity:e.quantity+1}:e);{let a={product:t,quantity:1,id:Date.now().toString()};return[...e,a]}}):c("Product not found: ".concat(e))}catch(e){c(e instanceof Error?e.message:"Error scanning barcode")}finally{u(!1)}},f=(0,r.useMemo)(()=>a.reduce((e,t)=>e+t.product.price*t.quantity,0),[a]);return(0,s.jsx)(n.Provider,{value:{cart:a,cartTotal:f,scanError:i,isScanning:d,scanAndAddToCart:h,refocusScanner:()=>{setTimeout(()=>{(null==m?void 0:m.current)&&m.current.focus()},100)},setScannerRef:e=>{x(e)},updateCartItemQuantity:(e,t)=>{o(a=>a.map(a=>a.id===e?{...a,quantity:t}:a))},updateCartItemPrice:(e,t)=>{o(a=>a.map(a=>a.id===e?{...a,product:{...a.product,price:t}}:a))},deleteCartItem:e=>{o(t=>t.filter(t=>t.id!==e))},clearCart:()=>o([])},children:t})},i=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e};var c=a(64269);function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function u(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",t),...a})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-action",className:(0,c.cn)("col-start-2 row-span-2 row-start-1 self-start justify-self-end",t),...a})}function f(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",t),...a})}function g(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,c.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}var p=a(3998),j=a(65142),v=a(76444);function b(e){let{amount:t,setAmount:a,cartTotal:r,refocusScanner:l,onNext:n,cartIsEmpty:o=!1}=e,i=e=>{if("C"===e)a("");else if("⌫"===e)a(t.slice(0,-1));else{if("."===e&&t.includes("."))return;a(t+e)}l()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.J,{className:"text-lg mb-2 font-medium",children:"Cash"}),(0,s.jsx)(j.p,{className:"h-20 !text-5xl text-right font-medium mb-6 border-2 border-gray-300 shadow-sm placeholder:text-5xl placeholder:font-medium placeholder:text-gray-400",value:t,onChange:e=>{a(e.target.value),setTimeout(l,3e3)},placeholder:"0.00",onBlur:l,onClick:e=>e.stopPropagation(),disabled:o}),(0,s.jsxs)("div",{className:"flex-1 grid grid-cols-3 gap-2 bg-gray-50 p-3 rounded-lg",children:[[7,8,9,4,5,6,1,2,3].map(e=>(0,s.jsx)(p.$,{onClick:()=>i(e.toString()),variant:"outline",className:"h-16 text-2xl font-medium",disabled:o,children:e},e)),(0,s.jsx)(p.$,{onClick:()=>i("."),variant:"outline",className:"h-16 text-2xl font-medium",disabled:o,children:"."}),(0,s.jsx)(p.$,{onClick:()=>i("0"),variant:"outline",className:"h-16 text-2xl font-medium",disabled:o,children:"0"}),(0,s.jsx)(p.$,{onClick:()=>i("⌫"),variant:"outline",className:"h-16 text-2xl font-medium",disabled:o,children:"⌫"}),(0,s.jsx)(p.$,{onClick:()=>i("C"),variant:"outline",className:"h-16 text-2xl font-medium col-span-3",disabled:o,children:"Clear"})]}),(0,s.jsx)("div",{className:"px-4 pb-4 pt-4",children:(0,s.jsx)(p.$,{className:"w-full h-14 text-xl font-medium",onClick:n,disabled:o||!t||parseFloat(t)<r,children:"Next"})})]})}var y=a(20508),N=a(6191);function w(e){let{customerQuery:t,setCustomerQuery:a,filteredCustomers:l,selectedCustomer:n,selectCustomer:o,clearCustomer:i,onAddCustomer:c}=e,d=(0,r.useId)();return(0,s.jsxs)("div",{className:"w-full mb-4",children:[(0,s.jsx)(v.J,{htmlFor:d,className:"mb-2 block",children:"Customer Name"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-400",children:(0,s.jsx)(y.A,{className:"w-4 h-4"})}),(0,s.jsx)(j.p,{id:d,className:"pl-9",placeholder:"Search Name",value:n?n.name:t,onChange:e=>{a(e.target.value),i()},autoComplete:"off"}),t&&!n&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 right-0 bg-white border rounded shadow max-h-40 overflow-y-auto",children:[0===l.length&&(0,s.jsx)("div",{className:"p-2 text-gray-500 text-center",children:"No results"}),l.map(e=>(0,s.jsxs)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer flex justify-between",onClick:()=>{o(e),a(e.name)},children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:[e.points," pts"]})]},e.id))]})]}),(0,s.jsxs)(p.$,{type:"button",onClick:c,className:"ml-2",children:[(0,s.jsx)(N.A,{className:"w-4 h-4 mr-1"})," Add"]})]})]})}function C(e){let{amount:t,cartTotal:a,change:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"py-5 border-t border-b",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xl mb-3",children:[(0,s.jsx)("span",{children:"Amount Paid:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₱ ",parseFloat(t).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xl mb-3",children:[(0,s.jsx)("span",{children:"Total:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₱ ",a.toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-3xl font-bold pt-5",children:[(0,s.jsx)("span",{children:"Change:"}),(0,s.jsxs)("span",{children:["₱ ",r.toFixed(2)]})]})]})}function S(e){let{selectedCustomer:t,cartTotal:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Transaction Successful!"}),(0,s.jsx)("p",{className:"mb-8",children:"Thank you for your purchase."})]})}var k=a(51834);function _(e){let{open:t,onOpenChange:a,onCustomerAdded:l}=e,[n,o]=(0,r.useState)(""),[i,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),m=async()=>{c(!0),u(null);try{let e=await fetch("".concat("http://localhost:5000/api","/customers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n})}),t=await e.json();if(!t.success)throw Error(t.message||"Failed to add customer");o(""),a(!1),l(t.data)}catch(e){u(e.message||"Failed to add customer")}finally{c(!1)}};return(0,s.jsx)(k.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(k.Cf,{children:[(0,s.jsx)(k.c7,{children:(0,s.jsx)(k.L3,{children:"Add Customer"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 my-2",children:[(0,s.jsx)(v.J,{htmlFor:"customer-name",children:"Name"}),(0,s.jsx)(j.p,{id:"customer-name",value:n,onChange:e=>o(e.target.value),placeholder:"Enter customer name",disabled:i}),d&&(0,s.jsx)("span",{className:"text-red-500 text-sm",children:d})]}),(0,s.jsxs)(k.Es,{children:[(0,s.jsx)(p.$,{variant:"outline",onClick:()=>a(!1),disabled:i,children:"Cancel"}),(0,s.jsx)(p.$,{onClick:m,disabled:i||!n.trim(),children:i?"Adding...":"Add"})]})]})})}var A=a(20931);let z=A.vv.create({page:{backgroundColor:"#fff",color:"#262626",fontFamily:"Roboto",fontSize:12,padding:12},header:{textAlign:"center",marginBottom:4},pharmacy:{fontSize:18,fontWeight:"bold",marginBottom:2},address:{fontSize:10,marginBottom:6},divider:{borderBottomWidth:1.5,borderBottomColor:"#000",borderStyle:"dashed",marginVertical:8},row:{flexDirection:"row",justifyContent:"space-between",marginBottom:2},bold:{fontWeight:"bold"},tableHeader:{flexDirection:"row",borderBottomWidth:1.5,borderBottomColor:"#000",borderStyle:"dashed",marginBottom:2,fontWeight:"bold",paddingTop:4,paddingBottom:4},colDesc:{width:"45%"},colQty:{width:"20%",textAlign:"center"},colAmount:{width:"35%",textAlign:"right"},totalRow:{flexDirection:"row",justifyContent:"flex-end",marginTop:8,fontWeight:"bold",fontSize:13},footer:{textAlign:"center",marginTop:8,fontSize:10},solution:{textAlign:"center",marginTop:8,fontSize:10,fontWeight:"bold"}});A.KQ.register({family:"Roboto",src:"/fonts/Roboto/Roboto-VariableFont_wdth,wght.ttf"});let L=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"2-digit"});function E(e){let{cartTotal:t,amount:a,change:r,customer:l,items:n}=e,o=280+20*n.length;return(0,s.jsx)(A.yo,{children:(0,s.jsxs)(A.YW,{size:[227,o],style:z.page,children:[(0,s.jsxs)(A.Ss,{style:z.header,children:[(0,s.jsx)(A.EY,{style:z.pharmacy,children:"STORE DA"}),(0,s.jsx)(A.EY,{style:z.address,children:"Itoy Igid"})]}),(0,s.jsx)(A.Ss,{style:z.divider}),(0,s.jsxs)(A.Ss,{style:z.row,children:[(0,s.jsx)(A.EY,{style:z.bold,children:"Customer:"}),(0,s.jsx)(A.EY,{children:(null==l?void 0:l.name)||"N/A"})]}),(0,s.jsx)(A.Ss,{style:z.row,children:(0,s.jsxs)(A.EY,{children:[(0,s.jsx)(A.EY,{style:z.bold,children:"Date:"})," ",L]})}),(0,s.jsx)(A.Ss,{style:z.divider}),(0,s.jsxs)(A.Ss,{style:z.tableHeader,children:[(0,s.jsx)(A.EY,{style:z.colDesc,children:"Description"}),(0,s.jsx)(A.EY,{style:z.colQty,children:"Qty"}),(0,s.jsx)(A.EY,{style:z.colAmount,children:"Amount"})]}),n.map((e,t)=>(0,s.jsxs)(A.Ss,{style:z.row,children:[(0,s.jsx)(A.EY,{style:z.colDesc,children:e.desc}),(0,s.jsx)(A.EY,{style:z.colQty,children:e.qty}),(0,s.jsx)(A.EY,{style:z.colAmount,children:e.amount.toFixed(2)})]},t)),(0,s.jsx)(A.Ss,{style:z.divider}),(0,s.jsxs)(A.Ss,{style:z.totalRow,children:[(0,s.jsx)(A.EY,{children:"Total: "}),(0,s.jsxs)(A.EY,{style:{fontWeight:"bold",marginLeft:8},children:["₱",t.toFixed(2)]})]}),(0,s.jsxs)(A.Ss,{style:z.row,children:[(0,s.jsx)(A.EY,{children:"Amount:"}),(0,s.jsxs)(A.EY,{children:["₱",parseFloat(a||"0").toFixed(2)]})]}),(0,s.jsxs)(A.Ss,{style:z.row,children:[(0,s.jsx)(A.EY,{children:"Change:"}),(0,s.jsxs)(A.EY,{children:["₱",r.toFixed(2)]})]}),(0,s.jsx)(A.Ss,{style:z.divider}),(0,s.jsx)(A.EY,{style:z.solution,children:"GATANG KA MANNEN!"})]})})}function D(e){let{step:t,setStep:a}=e,{cart:l,cartTotal:n,refocusScanner:o,clearCart:c}=i(),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(0),[j,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h((parseFloat(u)||0)-n)},[u,n]);let{customerQuery:y,setCustomerQuery:N,filteredCustomers:k,selectedCustomer:z,selectCustomer:L,clearCustomer:D,fetchCustomers:F,allCustomers:P,setAllCustomers:q}=function(){let[e,t]=(0,r.useState)(""),[a,s]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[o,i]=(0,r.useState)(null),c=async()=>{try{let e=await fetch("".concat("http://localhost:5000/api","/customers")),t=await e.json();t.success&&Array.isArray(t.data)?s(t.data):s([])}catch(e){s([])}};return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("http://localhost:5000/api","/customers")),t=await e.json();t.success&&Array.isArray(t.data)?s(t.data):s([])}catch(e){s([])}})()},[]),(0,r.useEffect)(()=>{n(a.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))},[e,a]),(0,r.useEffect)(()=>{c()},[]),{customerQuery:e,setCustomerQuery:t,filteredCustomers:l,selectedCustomer:o,selectCustomer:e=>{i(e),t(e.name)},clearCustomer:()=>i(null),fetchCustomers:c,allCustomers:a,setAllCustomers:s}}(),T=async()=>{let e=await (0,A.x8)((0,s.jsx)(E,{cartTotal:n,amount:u,change:x,customer:z,items:l.map(e=>({desc:e.product.name,qty:e.quantity,amount:e.product.price*e.quantity}))})).toBlob(),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="receipt-".concat(Date.now(),".pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},$=async()=>{await fetch("http://localhost:5000/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:(null==z?void 0:z.id)||null,total_purchase:n,items:l.map(e=>({product_id:e.product.id,quantity:e.quantity,price:e.product.price}))})}),a(1),m(""),D(),h(0),o(),c()};return(0,s.jsx)(d,{className:"h-full flex flex-col",onClick:()=>o(),children:(0,s.jsxs)(f,{className:"flex-1 flex flex-col p-4 pb-0",children:[(0,s.jsx)("h1",{className:"text-xl font-medium",children:"Total"}),(0,s.jsx)("div",{className:"w-full py-3 mb-2",children:(0,s.jsxs)("div",{className:"flex justify-between text-5xl font-medium",children:[(0,s.jsx)("h1",{children:"₱"}),(0,s.jsx)("h1",{children:n.toFixed(2)})]})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[1===t&&(0,s.jsx)(b,{amount:u,setAmount:m,cartTotal:n,refocusScanner:o,onNext:()=>{let e=parseFloat(u)||0;e>=n?(h(e-n),a(2)):alert("Insufficient amount")},cartIsEmpty:0===l.length}),2===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{amount:u,cartTotal:n,change:x}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)(w,{customerQuery:y,setCustomerQuery:N,filteredCustomers:k,selectedCustomer:z,selectCustomer:L,clearCustomer:D,onAddCustomer:()=>v(!0)}),(0,s.jsx)(_,{open:j,onOpenChange:v,onCustomerAdded:e=>{q(t=>[...t,e]),L(e),N(e.name)}}),(0,s.jsxs)(g,{className:"px-4 pb-4 pt-4 flex flex-col gap-3",children:[(0,s.jsx)(p.$,{className:"w-full h-14 text-xl font-medium",variant:"outline",onClick:()=>a(1),children:"Back"}),(0,s.jsx)(p.$,{className:"w-full h-14 text-xl font-medium",onClick:()=>a(3),children:"Finish Transaction"})]})]}),3===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{selectedCustomer:z,cartTotal:n}),(0,s.jsxs)(g,{className:"px-4 pb-4 pt-4 flex flex-col gap-2",children:[(0,s.jsx)(p.$,{className:"w-full h-14 text-xl font-medium",onClick:T,children:"Print Receipt"}),(0,s.jsx)(p.$,{className:"w-full h-14 text-xl font-medium",variant:"outline",onClick:$,children:"Close"})]})]})]})]})})}var F=a(67931);function P(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,c.cn)("w-full caption-bottom text-sm",t),...a})})}function q(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,c.cn)("[&_tr]:border-b",t),...a})}function T(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,c.cn)("[&_tr:last-child]:border-0",t),...a})}function $(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,c.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function R(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,c.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function M(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,c.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function O(e){let{cart:t,selectedRowId:a,selectRow:r,updateCartItemQuantity:l,updateCartItemPrice:n,deleteCartItem:o,disabled:i=!1}=e;return 0===t.length?(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center w-full h-full",children:(0,s.jsx)("span",{className:"text-center text-gray-500",children:"\uD83D\uDED2 Scan items to add to cart"})}):(0,s.jsxs)(P,{children:[(0,s.jsx)(q,{children:(0,s.jsxs)($,{children:[(0,s.jsx)(R,{className:"text-lg font-semibold",children:"Barcode"}),(0,s.jsx)(R,{className:"text-lg font-semibold",children:"Name"}),(0,s.jsx)(R,{className:"text-lg font-semibold",children:"Price"}),(0,s.jsx)(R,{className:"text-lg font-semibold",children:"Quantity"}),(0,s.jsx)(R,{className:"text-lg font-semibold",children:"Actions"})]})}),(0,s.jsx)(T,{children:t.map(e=>(0,s.jsxs)($,{className:"hover:bg-gray-50 cursor-pointer ".concat(a===e.id?"bg-gray-100":""),onClick:()=>r(e.id),children:[(0,s.jsx)(M,{className:"font-medium",children:e.product.barcode||"N/A"}),(0,s.jsx)(M,{children:e.product.name}),(0,s.jsx)(M,{children:(0,s.jsx)(j.p,{type:"number",min:0,step:"0.01",value:String(e.product.price),className:"w-28",onClick:e=>e.stopPropagation(),onChange:t=>{let a=Number(t.target.value),s=Number.isFinite(a)?Math.max(0,a):0;n(e.id,s)},disabled:i})}),(0,s.jsx)(M,{children:(0,s.jsx)(j.p,{type:"number",min:1,value:e.quantity,className:"w-16",onClick:e=>e.stopPropagation(),onChange:t=>{let a=Math.max(1,Number(t.target.value));l(e.id,a)},disabled:i})}),(0,s.jsx)(M,{children:(0,s.jsx)("button",{type:"button",className:"text-sm text-red-600 hover:underline disabled:opacity-50",onClick:t=>{t.stopPropagation(),o(e.id)},disabled:i,children:"Delete"})})]},e.id))})]})}var B=a(86651);function I(e){let{searchQuery:t,searchResults:a,showSearchResults:r,handleSearchChange:l,handleSearchSelect:n,refocusScanner:o,disabled:i=!1}=e;return(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsxs)("div",{className:"relative flex items-center",children:[(0,s.jsx)(B.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)(j.p,{className:"pl-9 w-full",placeholder:"Search by product name or barcode...",value:t,onChange:e=>l(e.target.value),onClick:e=>e.stopPropagation(),onBlur:o,disabled:i})]}),r&&a.length>0&&(0,s.jsx)("div",{className:"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 max-h-60 overflow-y-auto",children:a.map(e=>(0,s.jsx)("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b last:border-b-0",onClick:()=>n(e),children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Barcode: ",e.barcode]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"font-medium",children:["₱ ",e.price.toFixed(2)]})})]})},e.id))}),r&&0===a.length&&t.length>=2&&(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 bg-white border rounded-md shadow-lg z-10 p-3 text-center text-gray-500",children:['No products found matching "',t,'"']})]})}function Y(e){let{inputRef:t,barcodeInput:a,handleBarcodeChange:r,handleKeyPress:l,disabled:n=!1}=e;return(0,s.jsx)(j.p,{ref:t,className:"opacity-0 absolute -top-1000",value:a,onChange:r,onKeyPress:l,placeholder:"Scanner input...",disabled:n})}var K=a(47943),W=a(98053),Q=a(84441);function G(e){let{step:t}=e,{selectedRowId:a,selectRow:l}=function(){let[e,t]=(0,r.useState)(null);return{selectedRowId:e,selectRow:e=>t(e),clearSelection:()=>t(null)}}(),{products:n}=(0,F.Q)(),{cart:o,updateCartItemQuantity:c,scanAndAddToCart:u,setScannerRef:m,refocusScanner:x,updateCartItemPrice:h,deleteCartItem:g}=i(),{barcodeInput:p,inputRef:j,handleBarcodeChange:v,handleKeyPress:b}=(e=>{let[t,a]=(0,r.useState)(""),s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{s.current&&s.current.focus()},[]),{barcodeInput:t,inputRef:s,handleBarcodeChange:t=>{let s=t.target.value;if(a(s),s.includes("\n")||s.includes("\r")){let t=s.replace(/[\n\r]/g,"").trim();t&&(e(t),a(""))}},handleKeyPress:s=>{"Enter"===s.key&&(s.preventDefault(),t.trim()&&(e(t.trim()),a("")))},refocusScanner:()=>{setTimeout(()=>{s.current&&s.current.focus()},100)}}})(function(e){n.find(t=>t.barcode===e)?(u(e),x()):(P(e),E(!0))}),{setOpen:y,setBarcode:N}=(0,K.c)(),{cart:w,updateCartItemQuantity:C}=i();(0,r.useEffect)(()=>{let e=e=>{if(a){if("+"===e.key){let e=w.find(e=>e.id===a);e&&C(e.id,e.quantity+1)}if("-"===e.key){let e=w.find(e=>e.id===a);e&&e.quantity>1&&C(e.id,e.quantity-1)}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,w,C]);let{searchQuery:S,searchResults:k,showSearchResults:_,handleSearchChange:A,clearSearch:z}=(e=>{let[t,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(!1),n=(0,r.useMemo)(()=>t.trim().length<2?[]:e.filter(e=>{var a;return e.name.toLowerCase().includes(t.toLowerCase())||(null==(a=e.barcode)?void 0:a.includes(t))}),[e,t]);return{searchQuery:t,searchResults:n,showSearchResults:s,handleSearchChange:e=>{a(e),l(e.trim().length>=2)},clearSearch:()=>{a(""),l(!1)}}})(n),[L,E]=(0,r.useState)(!1),[D,P]=(0,r.useState)(null);return(0,r.useEffect)(()=>{m(j)},[m,j]),(0,r.useEffect)(()=>{(2===t||3===t)&&(null==j?void 0:j.current)&&j.current.blur()},[t]),(0,s.jsxs)("div",{className:"relative w-full h-full",children:[(0,s.jsx)(d,{className:"w-full h-full flex flex-col",onClick:()=>x(),children:(0,s.jsxs)(f,{className:"p-6 flex-1 flex flex-col min-h-0",children:[(0,s.jsx)(Y,{inputRef:j,barcodeInput:p,handleBarcodeChange:v,handleKeyPress:b,disabled:2===t||3===t}),(0,s.jsx)(I,{searchQuery:S,searchResults:k,showSearchResults:_,handleSearchChange:A,handleSearchSelect:e=>{u(e.barcode||""),z(),x()},clearSearch:z,refocusScanner:x,disabled:2===t||3===t}),(0,s.jsx)("div",{className:"rounded-md border flex-1 flex flex-col min-h-0 overflow-auto relative",children:(0,s.jsx)(O,{cart:o,selectedRowId:a,selectRow:l,updateCartItemQuantity:c,updateCartItemPrice:h,deleteCartItem:g,disabled:2===t||3===t})})]})}),(0,s.jsx)(Q.default,{}),(0,s.jsx)(W.Lt,{open:L,onOpenChange:E,children:(0,s.jsxs)(W.EO,{children:[(0,s.jsxs)(W.wd,{children:[(0,s.jsx)(W.r7,{children:"Product Not Registered"}),(0,s.jsxs)(W.$v,{children:["The scanned product (",(0,s.jsx)("span",{className:"font-bold",children:D}),") is not registered. Would you like to register it?"]})]}),(0,s.jsxs)(W.ck,{children:[(0,s.jsx)(W.Zr,{onClick:()=>E(!1),children:"Cancel"}),(0,s.jsx)(W.Rx,{onClick:()=>D&&void(E(!1),N(D),y(!0)),children:"Register Product"})]})]})})]})}function H(){let[e,t]=(0,r.useState)(1);return(0,s.jsx)(o,{children:(0,s.jsx)("div",{className:"flex flex-col w-full h-full py-4 px-4",children:(0,s.jsxs)("div",{className:"flex gap-2 h-full",children:[(0,s.jsx)("div",{className:"flex-[70%]",children:(0,s.jsx)(G,{step:e})}),(0,s.jsx)("div",{className:"flex flex-col flex-[30%] gap-2",children:(0,s.jsx)(D,{step:e,setStep:t})})]})})})}function U(){let{openModal:e}=(0,K.c)();return(0,s.jsxs)("div",{className:"flex justify-between items-center h-full",children:[(0,s.jsx)("div",{className:"text-4xl font-bold",children:(0,s.jsx)("h1",{children:"Products"})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(p.$,{className:"flex items-center justify-center gap-2 p-6",onClick:()=>e("addCategory"),children:[(0,s.jsx)(N.A,{className:"text-white w-5 h-5 !w-5 !h-5"}),"Add Category"]}),(0,s.jsxs)(p.$,{className:"flex items-center justify-center gap-2 p-6",onClick:()=>e("addProduct"),children:[(0,s.jsx)(N.A,{className:"text-white w-5 h-5 !w-5 !h-5"}),"Add Product"]})]})]})}var J=a(85400);let V=()=>l.G.getAll();function Z(){let{data:e=[],isLoading:t}=(0,J.Ay)("/api/products",V,{revalidateOnFocus:!1}),a=e.filter(e=>e&&"number"==typeof e.quantity&&"number"==typeof e.price),r=a.length,l=a.filter(e=>e.quantity<5&&e.quantity>0).length,n=a.filter(e=>0===e.quantity).length,o=a.reduce((e,t)=>e+t.price*t.quantity,0),i=[{title:"Total Products",content:t?"...":r},{title:"Low Stock Items",content:t?"...":l},{title:"Out of Stock",content:t?"...":n},{title:"Total Value",content:t?"...":"₱ ".concat(o.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))}];return(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4 w-full h-full",children:i.map((e,t)=>(0,s.jsx)(d,{children:(0,s.jsxs)(f,{className:"flex flex-col justify-center items-start h-full",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold pb-4",children:e.title}),(0,s.jsx)("p",{className:"text-2xl font-bold ",children:e.content})]})},t))})}var X=a(6259),ee=a(12677),et=a(24033),ea=a(5917),es=a(12108);function er(e){let{...t}=e;return(0,s.jsx)(ee.bL,{"data-slot":"select",...t})}function el(e){let{...t}=e;return(0,s.jsx)(ee.WT,{"data-slot":"select-value",...t})}function en(e){let{className:t,size:a="default",children:r,...l}=e;return(0,s.jsxs)(ee.l9,{"data-slot":"select-trigger","data-size":a,className:(0,c.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[r,(0,s.jsx)(ee.In,{asChild:!0,children:(0,s.jsx)(et.A,{className:"size-4 opacity-50"})})]})}function eo(e){let{className:t,children:a,position:r="popper",...l}=e;return(0,s.jsx)(ee.ZL,{children:(0,s.jsxs)(ee.UC,{"data-slot":"select-content",className:(0,c.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[(0,s.jsx)(ec,{}),(0,s.jsx)(ee.LM,{className:(0,c.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(ed,{})]})})}function ei(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(ee.q7,{"data-slot":"select-item",className:(0,c.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(ee.VF,{children:(0,s.jsx)(ea.A,{className:"size-4"})})}),(0,s.jsx)(ee.p4,{children:a})]})}function ec(e){let{className:t,...a}=e;return(0,s.jsx)(ee.PP,{"data-slot":"select-scroll-up-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(es.A,{className:"size-4"})})}function ed(e){let{className:t,...a}=e;return(0,s.jsx)(ee.wn,{"data-slot":"select-scroll-down-button",className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(et.A,{className:"size-4"})})}var eu=a(66955),em=a(89234);function ex(e){let{selectedCategory:t,setSelectedCategory:a,selectedProducts:l,setSelectedProducts:n,search:o,setSearch:i}=e,{categories:c,loading:d,error:u}=(0,em.C)(),[m,x]=(0,r.useState)(""),h=(0,r.useCallback)(()=>{a("all"),n("all"),x(""),i("")},[a,n]),f=(0,r.useMemo)(()=>{let e=c||[],t=m.trim().toLowerCase();return t?e.filter(e=>e.name.toLowerCase().includes(t)):e},[c,m]),g=(0,r.useCallback)(e=>{e!==t&&a(e)},[t,a]),v=(0,r.useCallback)(e=>{e!==l&&n(e)},[l,n]),b=(0,r.useCallback)(e=>{let t=e.target.value;t!==m&&x(t)},[m]);return(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"relative flex items-center w-[700px]",children:[(0,s.jsx)(B.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)(j.p,{className:"pl-9 w-full",placeholder:"Search by product name or barcode...",value:o,onChange:e=>{i(e.target.value)},onClick:e=>e.stopPropagation()})]}),(0,s.jsx)("div",{className:"class"}),(0,s.jsxs)(X.rI,{children:[(0,s.jsx)(X.ty,{asChild:!0,children:(0,s.jsxs)(p.$,{variant:"outline",children:[(0,s.jsx)(eu.A,{}),"Filter"]})}),(0,s.jsxs)(X.SQ,{className:"w-[300px] mr-18",children:[(0,s.jsx)(X.lp,{children:"Filter"}),(0,s.jsx)(X.mB,{}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h1",{className:"text-sm font-medium",children:"Category"}),(0,s.jsxs)(er,{value:t,onValueChange:g,children:[(0,s.jsx)(en,{className:"w-full mt-2",children:(0,s.jsx)(el,{placeholder:"Category"})}),(0,s.jsxs)(eo,{children:[(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(j.p,{placeholder:"Search category...",value:m,onChange:b,className:"mb-2"})}),(0,s.jsx)(ei,{value:"all",children:"All Categories"}),d&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"Loading categories..."}),u&&(0,s.jsx)("div",{className:"p-2 text-red-500",children:u}),!d&&!u&&(f.length>5?(0,s.jsx)("div",{className:"p-2 max-h-40 overflow-auto",children:f.map(e=>(0,s.jsx)(ei,{value:String(e.id),children:e.name},e.id))}):f.map(e=>(0,s.jsx)(ei,{value:String(e.id),children:e.name},e.id))),!d&&!u&&0===f.length&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"No categories found."})]})]})]}),(0,s.jsx)(X.mB,{}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h1",{className:"text-sm font-medium",children:"Status"}),(0,s.jsxs)(er,{value:l,onValueChange:v,children:[(0,s.jsx)(en,{className:"w-full mt-2",children:(0,s.jsx)(el,{placeholder:"Status"})}),(0,s.jsxs)(eo,{children:[(0,s.jsx)(ei,{value:"all",children:"All Stock"}),(0,s.jsx)(ei,{value:"in stock",children:"In Stock"}),(0,s.jsx)(ei,{value:"low stock",children:"Low Stock"}),(0,s.jsx)(ei,{value:"out of stock",children:"Out of Stock"})]})]})]}),(0,s.jsx)(X.mB,{}),(0,s.jsx)("div",{className:"flex justify-between w-full p-2 font-thin ",children:(0,s.jsx)(p.$,{className:"font-normal bg-white text-black border",variant:"ghost",onClick:h,children:"Reset All"})})]})]})]})}var eh=a(31342),ef=a(30563),eg=a(92273);function ep(e){let{columns:t,data:a,page:l,pageSize:n,onFilteredCountChange:o}=e,[i,c]=(0,r.useState)([]),d=(0,ef.N4)({data:a,columns:t,state:{sorting:i},onSortingChange:c,getCoreRowModel:(0,eg.HT)(),getSortedRowModel:(0,eg.h5)()});(0,r.useEffect)(()=>{o&&o(d.getRowModel().rows.length)},[d,o]);let u=d.getRowModel().rows.slice(l*n,(l+1)*n);return(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(P,{children:[(0,s.jsx)(q,{children:d.getHeaderGroups().map(e=>(0,s.jsx)($,{children:e.headers.map(e=>(0,s.jsx)(R,{children:e.isPlaceholder?null:(0,ef.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(T,{children:u.length?u.map(e=>(0,s.jsx)($,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(M,{children:(0,ef.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)($,{children:(0,s.jsx)(M,{colSpan:t.length,className:"h-24 text-center",children:"No results."})})})]})})}var ej=a(93341),ev=a(18514),eb=a(71360),ey=a(32467);let eN=(0,a(83101).F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ew(e){let{className:t,variant:a,asChild:r=!1,...l}=e,n=r?ey.DX:"span";return(0,s.jsx)(n,{"data-slot":"badge",className:(0,c.cn)(eN({variant:a}),t),...l})}let eC=[{accessorKey:"productName",header:e=>{let{column:t}=e;return(0,s.jsxs)("button",{className:"flex items-center gap-2 font-medium focus:outline-none",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Product",(0,s.jsx)(ej.A,{className:"ml-1 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex items-center font-medium",children:t.getValue("productName")})}},{accessorKey:"barcode",header:"Barcode"},{accessorKey:"category",header:"Category"},{accessorKey:"currentStock",header:e=>{let{column:t}=e;return(0,s.jsxs)("button",{className:"flex items-center gap-2 font-medium focus:outline-none",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Current Stock",(0,s.jsx)(ej.A,{className:"ml-1 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex items-center font-medium",children:t.getValue("currentStock")})}},{accessorKey:"productPrice",header:"Price"},{accessorKey:"status",header:"Status",cell:e=>{let{row:t}=e,a=t.original.status,r="default";return"out of stock"===a?r="destructive":"low stock"===a?r="secondary":"in stock"===a&&(r="default"),(0,s.jsx)(ew,{variant:r,className:"in stock"===a?"bg-green-300 text-black":"low stock"===a?"bg-yellow-500 text-black":"out of stock"===a?"bg-red-500 text-white":"",children:a.replace(/^\w/,e=>e.toUpperCase())})}},{id:"actions",header:()=>(0,s.jsx)("div",{className:"text-center font-medium",children:"Actions"}),cell:()=>(0,s.jsxs)("div",{className:"flex gap-5 justify-center",children:[(0,s.jsx)(p.$,{variant:"outline",size:"icon",children:(0,s.jsx)(ev.A,{className:"w-4 h-4"})}),(0,s.jsx)(p.$,{variant:"outline",size:"icon",children:(0,s.jsx)(eb.A,{className:"w-4 h-4"})})]}),enableSorting:!1,enableHiding:!1}];var eS=a(90368),ek=a(27937),e_=a(37772);function eA(e){let{className:t,...a}=e;return(0,s.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,c.cn)("mx-auto flex w-full justify-center",t),...a})}function ez(e){let{className:t,...a}=e;return(0,s.jsx)("ul",{"data-slot":"pagination-content",className:(0,c.cn)("flex flex-row items-center gap-1",t),...a})}function eL(e){let{...t}=e;return(0,s.jsx)("li",{"data-slot":"pagination-item",...t})}function eE(e){let{className:t,isActive:a,size:r="icon",...l}=e;return(0,s.jsx)("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:(0,c.cn)((0,p.r)({variant:a?"outline":"ghost",size:r}),t),...l})}function eD(e){let{className:t,...a}=e;return(0,s.jsxs)(eE,{"aria-label":"Go to previous page",size:"default",className:(0,c.cn)("gap-1 px-2.5 sm:pl-2.5",t),...a,children:[(0,s.jsx)(eS.A,{}),(0,s.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function eF(e){let{className:t,...a}=e;return(0,s.jsxs)(eE,{"aria-label":"Go to next page",size:"default",className:(0,c.cn)("gap-1 px-2.5 sm:pr-2.5",t),...a,children:[(0,s.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,s.jsx)(ek.A,{})]})}function eP(e){let{className:t,...a}=e;return(0,s.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,c.cn)("flex size-9 items-center justify-center",t),...a,children:[(0,s.jsx)(e_.A,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"More pages"})]})}function eq(e){let{page:t,pageCount:a,setPage:r,pageSize:l,onPageSizeChange:n}=e;return(0,s.jsxs)(eA,{className:"mt-2 flex items-center gap-4",children:[(0,s.jsxs)(ez,{children:[(0,s.jsx)(eL,{children:(0,s.jsx)(eD,{href:"#",onClick:e=>{e.preventDefault(),r(Math.max(t-1,0))},"aria-disabled":0===t})}),Array.from({length:a},(e,a)=>(0,s.jsx)(eL,{children:(0,s.jsx)(eE,{href:"#",isActive:a===t,onClick:e=>{e.preventDefault(),r(a)},children:a+1})},a)),a>5&&(0,s.jsx)(eL,{children:(0,s.jsx)(eP,{})}),(0,s.jsx)(eL,{children:(0,s.jsx)(eF,{href:"#",onClick:e=>{e.preventDefault(),r(Math.min(t+1,a-1))},"aria-disabled":t===a-1})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{htmlFor:"page-size",className:"text-sm",children:"Rows per page:"}),(0,s.jsx)("input",{id:"page-size",type:"number",min:1,max:100,value:l,onChange:e=>n(Number(e.target.value)),className:"border rounded px-2 py-1 w-16 text-sm"})]})]})}var eT=a(18720);let e$=()=>l.G.getAll();function eR(e){var t;let{selectedCategory:a,selectedStatus:n,onProductDeleted:o,search:i=""}=e,{data:c=[],isLoading:d,error:u}=(0,J.Ay)("/api/products",e$,{revalidateOnFocus:!1}),[m,x]=(0,r.useState)(0),[h,f]=(0,r.useState)(6),[g,b]=(0,r.useState)(null),[y,N]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),[S,_]=(0,r.useState)(null),[A,z]=(0,r.useState)(!1),{categories:L,loading:E,error:D}=(0,em.C)(),[F,P]=(0,r.useState)(""),[q,T]=(0,r.useState)({name:"",barcode:"",category_id:"",price:0,quantity:0}),$=c.find(e=>String(e.id)===String(g));(0,r.useEffect)(()=>{if(y&&$){var e,t,a,s,r;T({name:null!=(e=$.name)?e:"",barcode:null!=(t=$.barcode)?t:"",category_id:String(null!=(a=$.category_id)?a:""),price:null!=(s=$.price)?s:0,quantity:null!=(r=$.quantity)?r:0})}},[y,g]);let R="all"===a?c:c.filter(e=>String(e.category_id)===a);n&&"all"!==n&&(R=R.filter(e=>(0===e.quantity?"out of stock":e.quantity<5?"low stock":"in stock")===n));let M=(i||"").trim().toLowerCase();M.length>0&&(R=R.filter(e=>{var t,a;let s=String(null!=(t=e.name)?t:"").toLowerCase(),r=String(null!=(a=e.barcode)?a:"").toLowerCase();return s.includes(M)||r.includes(M)})),(0,r.useEffect)(()=>{x(0)},[a,n,i]);let O=(null!=R?R:[]).map(e=>(function(e,t){var a;let s;s=0===e.quantity?"out of stock":e.quantity<5?"low stock":"in stock";let r=t.find(t=>String(t.id)===String(e.category_id));return{id:String(e.id),productName:e.name,barcode:null!=(a=e.barcode)?a:"",category:r?r.name:"Category ".concat(e.category_id),currentStock:e.quantity,productPrice:e.price,status:s}})(e,L)),B=Math.max(1,Math.ceil(O.length/h)),I=async()=>{if(C(!1),!$)return void(0,eT.oR)("Product data not loaded",{description:"Please try again."});try{await l.G.update($.id,{name:q.name,barcode:q.barcode,category_id:Number(q.category_id),price:Number(q.price),quantity:Number(q.quantity)}),(0,eT.oR)("Product updated",{description:"".concat(q.name," has been updated.")}),N(!1),(0,eh.j)("/api/products")}catch(e){(0,eT.oR)("Failed to update product",{description:(null==e?void 0:e.message)||"An error occurred."})}},Y=async()=>{if(S)try{await l.G.delete(S.id),(0,eT.oR)("Product deleted",{description:"".concat(S.name," has been deleted.")}),z(!1),_(null),(0,eh.j)("/api/products"),o&&o(S.id)}catch(e){(0,eT.oR)("Failed to delete product",{description:(null==e?void 0:e.message)||"An error occurred."})}};return(0,s.jsxs)("div",{className:"w-full mt-4 relative",children:[(0,s.jsx)(ep,{columns:eC.map(e=>"actions"===e.id?{...e,cell:e=>{let{row:t}=e;return(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(p.$,{variant:"outline",size:"icon",onClick:()=>{b(t.original.id),N(!0),C(!1)},disabled:d,children:(0,s.jsx)(ev.A,{className:"w-4 h-4"})}),(0,s.jsx)(p.$,{variant:"outline",size:"icon",onClick:()=>{_(t.original),z(!0)},children:(0,s.jsx)(eb.A,{className:"w-4 h-4"})})]})}}:e),data:O,page:m,pageSize:h}),(0,s.jsx)("div",{className:"mt-7",children:(0,s.jsx)(eq,{page:m,pageCount:B,setPage:x,pageSize:h,onPageSizeChange:e=>{f(e),x(0)}})}),(0,s.jsx)(k.lG,{open:y,onOpenChange:N,children:(0,s.jsx)(k.Cf,{children:$?w?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,s.jsx)("h2",{className:"font-bold text-lg mb-2",children:"Are you absolutely sure?"}),(0,s.jsx)("p",{className:"mb-6 text-gray-500",children:"This will update the product details."}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(p.$,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),(0,s.jsx)(p.$,{onClick:I,children:"Continue"})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(k.c7,{children:[(0,s.jsx)(k.L3,{children:"Product"}),(0,s.jsx)(k.rr,{children:"Fill in the details below to update the product."})]}),(0,s.jsxs)("div",{className:"flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"edit-name",children:"Product Name"}),(0,s.jsx)(j.p,{id:"edit-name",name:"name",value:q.name,onChange:e=>T(t=>({...t,name:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 mt-4",children:[(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"edit-barcode",children:"Barcode"}),(0,s.jsx)(j.p,{id:"edit-barcode",name:"barcode",value:q.barcode,onChange:e=>T(t=>({...t,barcode:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"edit-category",children:"Category"}),(0,s.jsxs)(X.rI,{children:[(0,s.jsx)(X.ty,{asChild:!0,children:(0,s.jsx)(j.p,{id:"edit-category",readOnly:!0,value:(null==(t=L.find(e=>String(e.id)===String(q.category_id)))?void 0:t.name)||"",placeholder:"Select category",className:"cursor-pointer"})}),(0,s.jsxs)(X.SQ,{className:"w-64",children:[(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(j.p,{placeholder:"Search category...",value:F,onChange:e=>P(e.target.value),className:"mb-2"})}),E&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"Loading..."}),D&&(0,s.jsx)("div",{className:"p-2 text-red-500",children:D}),!E&&!D&&(0,s.jsxs)(s.Fragment,{children:[L.filter(e=>e.name.toLowerCase().includes(F.toLowerCase())).map(e=>(0,s.jsx)(X._2,{onClick:()=>{T(t=>({...t,category_id:String(e.id)})),P("")},children:e.name},e.id)),0===L.filter(e=>e.name.toLowerCase().includes(F.toLowerCase())).length&&(0,s.jsx)("div",{className:"p-2 text-gray-400",children:"No categories found."})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 my-4",children:[(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"edit-price",children:"Price"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500 pointer-events-none",children:"₱"}),(0,s.jsx)(j.p,{id:"edit-price",name:"price",type:"number",value:0===q.price?"":String(q.price),onChange:e=>T(t=>({...t,price:""===e.target.value?0:Number(e.target.value)})),className:"pl-8"})]})]}),(0,s.jsxs)("div",{className:"flex-[50%] flex flex-col gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"edit-quantity",children:"Quantity"}),(0,s.jsx)(j.p,{id:"edit-quantity",name:"quantity",type:"number",value:0===q.quantity?"":String(q.quantity),onChange:e=>T(t=>({...t,quantity:""===e.target.value?0:Number(e.target.value)}))})]})]}),(0,s.jsxs)(k.Es,{children:[(0,s.jsx)(k.HM,{asChild:!0,children:(0,s.jsx)(p.$,{variant:"outline",onClick:()=>N(!1),children:"Cancel"})}),(0,s.jsx)(p.$,{onClick:()=>C(!0),children:"Update Product"})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.L3,{children:"Loading"}),(0,s.jsx)(k.rr,{children:"Loading product data..."}),(0,s.jsx)("div",{className:"p-4 text-center",children:"Loading..."})]})})}),(0,s.jsx)(k.lG,{open:A,onOpenChange:z,children:(0,s.jsxs)(k.Cf,{children:[(0,s.jsxs)(k.c7,{children:[(0,s.jsx)(k.L3,{children:"Are you absolutely sure?"}),(0,s.jsx)(k.rr,{children:"This action cannot be undone. This will permanently delete the product and remove it from your database."})]}),(0,s.jsxs)(k.Es,{children:[(0,s.jsx)(p.$,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),(0,s.jsx)(p.$,{variant:"destructive",onClick:Y,disabled:!S,children:"Continue"})]})]})})]})}function eM(e){let{products:t,onProductDeleted:a}=e,[l,n]=(0,r.useState)("all"),[o,i]=(0,r.useState)("all"),[c,m]=(0,r.useState)("");return(0,s.jsxs)(d,{className:"h-full w-full",children:[(0,s.jsx)(u,{children:(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Product Catalog"})}),(0,s.jsxs)(f,{children:[(0,s.jsx)(ex,{selectedCategory:l,setSelectedCategory:n,selectedProducts:o,setSelectedProducts:i,search:c,setSearch:m}),(0,s.jsx)(eR,{selectedCategory:l,selectedStatus:o,onProductDeleted:a,search:c})]})]})}var eO=a(95704);function eB(){let{activeModal:e,closeModal:t}=(0,K.c)(),{refetch:a}=(0,em.C)(),{addCategory:l,loading:n,error:o}=(()=>{let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null);return{addCategory:async(e,a)=>{var r,l,n,o,i,c,d,u;t(!0),s(null);let m=null!=(l=null!=(r=eO.env.NEXT_PUBLIC_API_URL)?r:"http://localhost:5000/api")?l:"",x=String(m).trim();console.log("useAddCategory: raw env value:",m),(x=(x=(x=x.replace(/^["']|["']$/g,"")).replace(/\/+$/g,"")).replace(/\/api$/i,""))?/^https?:\/\//i.test(x)||(x=x.startsWith(":")?"http://localhost".concat(x):"http://".concat(x)):x="";let h=x?"".concat(x,"/api/categories"):"/api/categories";console.log("useAddCategory: POST url:",h,"payload:",e);try{let s=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){let e="";try{let t=s.clone();e=await t.text()}catch(t){e="<could not read response body>"}console.error("useAddCategory: non-ok response",{url:h,status:s.status,body:e});let t="Request failed with status ".concat(s.status);try{let e=await s.json();t=null!=(d=null!=(c=null!=(i=null==e?void 0:e.message)?i:null==e?void 0:e.error)?c:null==e||null==(o=e.data)?void 0:o.message)?d:t}catch(e){}throw Error(t)}let r=await s.json();console.log("useAddCategory: success response json:",r);let l=null!=(u=null==r?void 0:r.data)?u:r;return null==a||null==(n=a.onSuccess)||n.call(a,l),t(!1),l}catch(e){throw console.error("useAddCategory: caught error",e),s(e instanceof Error?e.message:"Failed to create category"),t(!1),e}},loading:e,error:a}})(),[i,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(null);async function m(e){if(e.preventDefault(),console.log("AddCategoryModal.handleSubmit called",{name:i}),i.trim())try{await l({name:i.trim()},{onSuccess:e=>{console.log("AddCategoryModal.onSuccess",e),c(""),u("Category added"),eT.oR.success("Category added",{style:{"--normal-bg":"color-mix(in oklab, light-dark(var(--color-green-600), var(--color-green-400)) 10%, var(--background))","--normal-text":"light-dark(var(--color-green-600), var(--color-green-400))","--normal-border":"light-dark(var(--color-green-600), var(--color-green-400))"}}),setTimeout(()=>{t(),u(null)},600),null==a||a()}})}catch(e){console.error("Add category failed (modal)",e)}}return(0,r.useEffect)(()=>{"addCategory"!==e&&(c(""),u(null))},[e]),(0,s.jsx)(k.lG,{open:"addCategory"===e,onOpenChange:e=>{e||t()},children:(0,s.jsx)(k.Cf,{className:"sm:max-w-[420px]",children:(0,s.jsxs)("form",{onSubmit:m,children:[(0,s.jsxs)(k.c7,{children:[(0,s.jsx)(k.L3,{children:"Add Category"}),(0,s.jsx)(k.rr,{children:"Fill in the details below to add a new category."})]}),(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(v.J,{htmlFor:"category-name",children:"Name"}),(0,s.jsx)(j.p,{id:"category-name",value:i,onChange:e=>c(e.target.value),placeholder:"Category name",required:!0,autoFocus:!0})]}),o&&(0,s.jsx)("div",{className:"text-sm text-red-600",children:o})]}),(0,s.jsxs)(k.Es,{className:"mt-5",children:[(0,s.jsx)(p.$,{variant:"outline",type:"button",onClick:()=>t(),children:"Cancel"}),(0,s.jsx)(p.$,{type:"submit",disabled:n,onClick:e=>{e.preventDefault(),m(e)},children:n?"Saving...":"Save"})]})]})})})}function eI(){let{products:e,refetch:t}=(0,F.Q)(),[a,l]=(0,r.useState)(e);return(0,r.useEffect)(()=>{l(e)},[e]),(0,s.jsxs)("div",{className:"flex flex-col gap-4 h-full p-8",children:[(0,s.jsx)("div",{className:"flex-[7%]",children:(0,s.jsx)(U,{})}),(0,s.jsx)("div",{className:"flex-[18%]",children:(0,s.jsx)(Z,{})}),(0,s.jsx)("div",{className:"flex-[75%]",children:(0,s.jsx)(eM,{products:a,onProductDeleted:e=>{l(t=>t.filter(t=>t.id!==e))}})}),(0,s.jsx)(eB,{})]})}var eY=a(91761),eK=a(26617),eW=a(10512),eQ=a(95125);function eG(){let{saleItems:e,loading:t}=(()=>{let[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[l,n]=(0,r.useState)(null),o=async()=>{try{s(!0),n(null);let e=await eQ.A.get("http://localhost:5000/api/sales-items");t(e.data.data)}catch(e){n(e instanceof Error?e.message:"Unknown error")}finally{s(!1)}};return(0,r.useEffect)(()=>{o()},[]),{saleItems:e,loading:a,error:l,refetch:o}})(),{products:a,loading:l}=(0,F.Q)(),{sales:n,loading:o}=(()=>{let[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[l,n]=(0,r.useState)(null),o=async()=>{try{s(!0),n(null);let e=await eQ.A.get("http://localhost:5000/api/sales");t(e.data.data)}catch(e){n(e instanceof Error?e.message:"Unknown error")}finally{s(!1)}};return(0,r.useEffect)(()=>{o()},[]),{sales:e,loading:a,error:l,refetch:o}})(),i=e=>("string"==typeof e?new Date(e):e).toISOString().slice(0,10),c=i(new Date),x=n.filter(e=>i(e.created_at)===c),h=x.reduce((e,t)=>e+t.total_purchase,0),g=x.length;a.length;let p=e.filter(e=>i(e.created_at)===c).reduce((e,t)=>e+t.quantity,0),j=[{title:"Today's Sales",content:o?"...":"₱ ".concat(h.toLocaleString()),icon:(0,s.jsx)(eY.A,{size:20})},{title:"Items Sold Today",content:t?"...":p.toLocaleString(),icon:(0,s.jsx)(eK.A,{size:20})},{title:"Today's Transactions",content:o?"...":g.toLocaleString(),icon:(0,s.jsx)(eW.A,{size:20})}];return(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4 w-full h-full",children:j.map((e,t)=>(0,s.jsxs)(d,{className:"gap-0 flex justify-center",children:[(0,s.jsxs)(u,{className:"mb-4 flex flex-row justify-between items-center",children:[(0,s.jsx)(m,{className:"text-md font-semibold",children:e.title}),(0,s.jsx)("div",{className:"opacity-60",children:e.icon})]}),(0,s.jsx)(f,{children:(0,s.jsx)("div",{className:"text-3xl font-bold mb-6",children:e.content})})]},t))})}var eH=a(80003),eU=a(16485),eJ=a(98128),eV=a(68425),eZ=a(47734),eX=a(30757),e0=a(3648),e1=a(74854),e2=a(63359);function e5(){let e=(0,e0._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return e5=function(){return e},e}function e4(){let e=(0,e0._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return e4=function(){return e},e}function e3(e){let{className:t,classNames:a,showOutsideDays:r=!0,captionLayout:l="label",buttonVariant:n="ghost",formatters:o,components:i,...d}=e,u=(0,e1.a)();return(0,s.jsx)(e2.h,{showOutsideDays:r,className:(0,c.cn)("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw(e5()),String.raw(e4()),t),captionLayout:l,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...o},classNames:{root:(0,c.cn)("w-fit",u.root),months:(0,c.cn)("flex gap-4 flex-col md:flex-row relative",u.months),month:(0,c.cn)("flex flex-col w-full gap-4",u.month),nav:(0,c.cn)("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",u.nav),button_previous:(0,c.cn)((0,p.r)({variant:n}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_previous),button_next:(0,c.cn)((0,p.r)({variant:n}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_next),month_caption:(0,c.cn)("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",u.month_caption),dropdowns:(0,c.cn)("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",u.dropdowns),dropdown_root:(0,c.cn)("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",u.dropdown_root),dropdown:(0,c.cn)("absolute bg-popover inset-0 opacity-0",u.dropdown),caption_label:(0,c.cn)("select-none font-medium","label"===l?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",u.caption_label),table:"w-full border-collapse",weekdays:(0,c.cn)("flex",u.weekdays),weekday:(0,c.cn)("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",u.weekday),week:(0,c.cn)("flex w-full mt-2",u.week),week_number_header:(0,c.cn)("select-none w-(--cell-size)",u.week_number_header),week_number:(0,c.cn)("text-[0.8rem] select-none text-muted-foreground",u.week_number),day:(0,c.cn)("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",u.day),range_start:(0,c.cn)("rounded-l-md bg-accent",u.range_start),range_middle:(0,c.cn)("rounded-none",u.range_middle),range_end:(0,c.cn)("rounded-r-md bg-accent",u.range_end),today:(0,c.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",u.today),outside:(0,c.cn)("text-muted-foreground aria-selected:text-muted-foreground",u.outside),disabled:(0,c.cn)("text-muted-foreground opacity-50",u.disabled),hidden:(0,c.cn)("invisible",u.hidden),...a},components:{Root:e=>{let{className:t,rootRef:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"calendar",ref:a,className:(0,c.cn)(t),...r})},Chevron:e=>{let{className:t,orientation:a,...r}=e;return"left"===a?(0,s.jsx)(eS.A,{className:(0,c.cn)("size-4",t),...r}):"right"===a?(0,s.jsx)(ek.A,{className:(0,c.cn)("size-4",t),...r}):(0,s.jsx)(et.A,{className:(0,c.cn)("size-4",t),...r})},DayButton:e6,WeekNumber:e=>{let{children:t,...a}=e;return(0,s.jsx)("td",{...a,children:(0,s.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:t})})},...i},...d})}function e6(e){let{className:t,day:a,modifiers:l,...n}=e,o=(0,e1.a)(),i=r.useRef(null);return r.useEffect(()=>{var e;l.focused&&(null==(e=i.current)||e.focus())},[l.focused]),(0,s.jsx)(p.$,{ref:i,variant:"ghost",size:"icon","data-day":a.date.toLocaleDateString(),"data-selected-single":l.selected&&!l.range_start&&!l.range_end&&!l.range_middle,"data-range-start":l.range_start,"data-range-end":l.range_end,"data-range-middle":l.range_middle,className:(0,c.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",o.day,t),...n})}var e8=a(26991),e7=a(23508),e9=a(7620);let te={light:"",dark:".dark"},tt=r.createContext(null);function ta(e){let{id:t,className:a,children:l,config:n,...o}=e,i=r.useId(),d="chart-".concat(t||i.replace(/:/g,""));return(0,s.jsx)(tt.Provider,{value:{config:n},children:(0,s.jsxs)("div",{"data-slot":"chart","data-chart":d,className:(0,c.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",a),...o,children:[(0,s.jsx)(ts,{id:d,config:n}),(0,s.jsx)(e8.u,{children:l})]})})}let ts=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(te).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,l=(null==(t=r.theme)?void 0:t[a])||r.color;return l?"  --color-".concat(s,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},tr=e7.m;function tl(e){let{active:t,payload:a,className:l,indicator:n="dot",hideLabel:o=!1,hideIndicator:i=!1,label:d,labelFormatter:u,labelClassName:m,formatter:x,color:h,nameKey:f,labelKey:g}=e,{config:p}=function(){let e=r.useContext(tt);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),j=r.useMemo(()=>{var e;if(o||!(null==a?void 0:a.length))return null;let[t]=a,r="".concat(g||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),l=tn(p,t,r),n=g||"string"!=typeof d?null==l?void 0:l.label:(null==(e=p[d])?void 0:e.label)||d;return u?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",m),children:u(n,a)}):n?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",m),children:n}):null},[d,u,a,o,m,p,g]);if(!t||!(null==a?void 0:a.length))return null;let v=1===a.length&&"dot"!==n;return(0,s.jsxs)("div",{className:(0,c.cn)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",l),children:[v?null:j,(0,s.jsx)("div",{className:"grid gap-1.5",children:a.map((e,t)=>{let a="".concat(f||e.name||e.dataKey||"value"),r=tn(p,e,a),l=h||e.payload.fill||e.color;return(0,s.jsx)("div",{className:(0,c.cn)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===n&&"items-center"),children:x&&(null==e?void 0:e.value)!==void 0&&e.name?x(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!i&&(0,s.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":v&&"dashed"===n}),style:{"--color-bg":l,"--color-border":l}}),(0,s.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[v?j:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function tn(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}e9.s;var to=a(82286);function ti(e){let{...t}=e;return(0,s.jsx)(to.bL,{"data-slot":"popover",...t})}function tc(e){let{...t}=e;return(0,s.jsx)(to.l9,{"data-slot":"popover-trigger",...t})}function td(e){let{className:t,align:a="center",sideOffset:r=4,...l}=e;return(0,s.jsx)(to.ZL,{children:(0,s.jsx)(to.UC,{"data-slot":"popover-content",align:a,sideOffset:r,className:(0,c.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}let tu={quantity:{label:"Quantity Sold",color:"var(--color-primary)"}},tm=async e=>{let t=await fetch(e);return(await t.json()).data};function tx(){let e="http://localhost:5000/api",{data:t=[],error:a,isLoading:l}=(0,J.Ay)("".concat(e,"/sales-items"),tm),{data:n=[],error:o,isLoading:i}=(0,J.Ay)("".concat(e,"/products"),tm),c=new Date,j=new Date(c.getFullYear(),c.getMonth(),1),[v,b]=(0,r.useState)({from:j,to:c}),[y,N]=(0,r.useState)("normal"),w=(0,r.useMemo)(()=>{let e={};return n.forEach(t=>{e[t.id]=t.name}),e},[n]),C=(0,r.useMemo)(()=>{let e={};t.forEach(t=>{let a,s,r=new Date(t.created_at);(!(null==v?void 0:v.from)||(a=v.from,r.setHours(0,0,0,0)>=a.setHours(0,0,0,0)))&&(!(null==v?void 0:v.to)||(s=v.to,r.setHours(0,0,0,0)<=s.setHours(0,0,0,0)))&&(e[t.product_id]=(e[t.product_id]||0)+t.quantity)});let a=Object.entries(e).map(e=>{let[t,a]=e;return{product:w[Number(t)]||"Product ".concat(t),quantity:a}});return"asc"===y?a=a.sort((e,t)=>e.quantity-t.quantity):"desc"===y&&(a=a.sort((e,t)=>t.quantity-e.quantity)),a},[t,v,w,y]),S=(0,r.useMemo)(()=>C.reduce((e,t)=>e+t.quantity,0),[C]);return l||i?(0,s.jsx)("div",{children:"Loading..."}):a||o?(0,s.jsx)("div",{children:"Error loading product stats."}):(0,s.jsxs)(d,{className:"@container/card w-full",children:[(0,s.jsxs)(u,{className:"flex flex-col border-b @md/card:grid",children:[(0,s.jsx)(m,{children:"Product Analytics"}),(0,s.jsx)(x,{children:"Showing most sold products for this month."}),(0,s.jsx)(h,{className:"mt-2 @md/card:mt-0",children:(0,s.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,s.jsx)(p.$,{variant:"desc"===y?"default":"outline",size:"sm",onClick:()=>N("desc"),"aria-label":"Sort Descending",children:(0,s.jsx)(et.A,{size:16})}),(0,s.jsx)(p.$,{variant:"normal"===y?"default":"outline",size:"sm",onClick:()=>N("normal"),"aria-label":"Follow Order",children:(0,s.jsx)(eH.A,{size:16})}),(0,s.jsx)(p.$,{variant:"asc"===y?"default":"outline",size:"sm",onClick:()=>N("asc"),"aria-label":"Sort Ascending",children:(0,s.jsx)(es.A,{size:16})}),(0,s.jsxs)(ti,{children:[(0,s.jsx)(tc,{asChild:!0,children:(0,s.jsxs)(p.$,{variant:"outline",children:[(0,s.jsx)(eU.A,{}),(null==v?void 0:v.from)&&(null==v?void 0:v.to)?"".concat(v.from.toLocaleDateString()," - ").concat(v.to.toLocaleDateString()):"".concat(j.toLocaleDateString()," - ").concat(c.toLocaleDateString())]})}),(0,s.jsx)(td,{className:"w-auto overflow-hidden p-0",align:"end",children:(0,s.jsx)(e3,{className:"w-full",mode:"range",defaultMonth:null==v?void 0:v.from,selected:v,onSelect:b,fixedWeeks:!0,showOutsideDays:!0,disabled:{after:c}})})]})]})})]}),(0,s.jsx)(f,{className:"px-4",children:(0,s.jsx)(ta,{config:tu,className:"aspect-auto h-89 w-full",children:(0,s.jsxs)(eJ.E,{accessibilityLayer:!0,data:C,margin:{left:12,right:12},children:[(0,s.jsx)(eV.d,{vertical:!1}),(0,s.jsx)(eZ.W,{dataKey:"product",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:20}),(0,s.jsx)(tr,{content:(0,s.jsx)(tl,{className:"w-[150px]",nameKey:"quantity",labelFormatter:e=>e})}),(0,s.jsx)(eX.y,{dataKey:"quantity",fill:"var(--color-quantity)",radius:4})]})})}),(0,s.jsx)(g,{className:"border-t",children:(0,s.jsxs)("div",{className:"text-sm",children:["Total sold: ",(0,s.jsx)("span",{className:"font-semibold",children:S.toLocaleString()})]})})]})}var th=a(80019),tf=a(47643);let tg={customer:{label:"Total",color:"var(--color-primary)"}},tp=async e=>{let t=await fetch(e);return(await t.json()).data};function tj(){let{data:e=[],error:t,isLoading:a}=(0,J.Ay)("".concat("http://localhost:5000/api","/sales"),tp),l=new Date,n=new Date(l.getFullYear(),l.getMonth(),1),[o,i]=r.useState({from:n,to:l}),[c,j]=r.useState("normal"),v=r.useMemo(()=>{let t={};return e.forEach(e=>{var a;let s=e.created_at.slice(0,10);t[s]=(t[s]||0)+(null!=(a=e.total_purchase)?a:0)}),Object.entries(t).map(e=>{let[t,a]=e;return{date:t,customer:a}})},[e]),b=r.useMemo(()=>(null==o?void 0:o.from)||(null==o?void 0:o.to)?v.filter(e=>{let t,a,s=new Date(e.date);return(!o.from||(t=o.from,s.setHours(0,0,0,0)>=t.setHours(0,0,0,0)))&&(!o.to||(a=o.to,s.setHours(0,0,0,0)<=a.setHours(0,0,0,0)))}):v,[o,v]),y=r.useMemo(()=>{let e=[...b];return"asc"===c?e.sort((e,t)=>e.customer-t.customer):"desc"===c&&e.sort((e,t)=>t.customer-e.customer),e},[b,c]),N=r.useMemo(()=>y.reduce((e,t)=>e+t.customer,0),[y]);return a?(0,s.jsx)("div",{children:"Loading..."}):t?(0,s.jsx)("div",{children:"Error loading sales data."}):(0,s.jsxs)(d,{className:"@container/card w-full",children:[(0,s.jsxs)(u,{className:"flex flex-col border-b @md/card:grid",children:[(0,s.jsx)(m,{children:"Sales Chart"}),(0,s.jsx)(x,{children:"Filter total sales by date range"}),(0,s.jsx)(h,{className:"mt-2 @md/card:mt-0",children:(0,s.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,s.jsx)(p.$,{variant:"desc"===c?"default":"outline",size:"sm",onClick:()=>j("desc"),"aria-label":"Sort Descending",children:(0,s.jsx)(et.A,{size:16})}),(0,s.jsx)(p.$,{variant:"normal"===c?"default":"outline",size:"sm",onClick:()=>j("normal"),"aria-label":"Follow Order",children:(0,s.jsx)(eH.A,{size:16})}),(0,s.jsx)(p.$,{variant:"asc"===c?"default":"outline",size:"sm",onClick:()=>j("asc"),"aria-label":"Sort Ascending",children:(0,s.jsx)(es.A,{size:16})}),(0,s.jsxs)(ti,{children:[(0,s.jsx)(tc,{asChild:!0,children:(0,s.jsxs)(p.$,{variant:"outline",children:[(0,s.jsx)(eU.A,{}),(null==o?void 0:o.from)&&(null==o?void 0:o.to)?"".concat(o.from.toLocaleDateString()," - ").concat(o.to.toLocaleDateString()):"".concat(n.toLocaleDateString()," - ").concat(l.toLocaleDateString())]})}),(0,s.jsx)(td,{className:"w-auto overflow-hidden p-0",align:"end",children:(0,s.jsx)(e3,{className:"w-full",mode:"range",defaultMonth:null==o?void 0:o.from,selected:o,onSelect:i,fixedWeeks:!0,showOutsideDays:!0,disabled:{after:l}})})]})]})})]}),(0,s.jsx)(f,{className:"px-4",children:(0,s.jsx)(ta,{config:tg,className:"aspect-auto h-89 w-full",children:(0,s.jsxs)(th.b,{accessibilityLayer:!0,data:y,margin:{left:12,right:12},children:[(0,s.jsx)(eV.d,{vertical:!1}),(0,s.jsx)(eZ.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:20,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{day:"numeric"})}),(0,s.jsx)(tr,{content:(0,s.jsx)(tl,{className:"w-[150px]",nameKey:"customer",labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}),(0,s.jsx)(tf.N,{dataKey:"customer",type:"monotone",stroke:"var(--color-customer)",strokeWidth:2,dot:!1})]})})}),(0,s.jsx)(g,{className:"border-t",children:(0,s.jsxs)("div",{className:"text-sm",children:["You had ",(0,s.jsxs)("span",{className:"font-semibold",children:["₱ ",N.toLocaleString()]})," total sales for the selected period."]})})]})}function tv(){return(0,s.jsxs)("div",{className:"flex flex-col p-6 h-full gap-3",children:[(0,s.jsxs)("div",{className:"flex-[7%]",children:[(0,s.jsx)("h1",{className:"font-extrabold text-4xl",children:"Dashboard"}),(0,s.jsx)("p",{children:"Welcome Back! Here's your business overview!"})]}),(0,s.jsx)("div",{className:"flex-[20%]",children:(0,s.jsx)(eG,{})}),(0,s.jsxs)("div",{className:"flex-[78%] flex 2xl:flex-row gap-3 flex-col",children:[(0,s.jsx)("div",{className:"flex-[50%]",children:(0,s.jsx)(tx,{})}),(0,s.jsx)("div",{className:"flex-[50%]",children:(0,s.jsx)(tj,{})})]})]})}function tb(e){let{params:t}=e,{site:a}=(0,r.use)(t);switch(a){case"db":return(0,s.jsx)(tv,{});case"main":return(0,s.jsx)(H,{});case"products":return(0,s.jsx)(eI,{});default:return(0,s.jsx)("div",{children:a})}}},68529:(e,t,a)=>{Promise.resolve().then(a.bind(a,59776))}},e=>{e.O(0,[247,788,746,792,235,720,587,822,441,255,358],()=>e(e.s=68529)),_N_E=e.O()}]);