"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{83410:(e,t,r)=>{r.d(t,{usePrint:()=>p});var n=r(29727),i=r(68267);let a=!1;function c(){return window.qz}async function o(){if(c())return;let e=document.querySelector("script[data-qz]");if(e){if(c())return;await new Promise(t=>{e.addEventListener("load",()=>t(),{once:!0})});return}await new Promise((e,t)=>{let r=document.createElement("script");r.src="/vendor/qz-tray.js",r.async=!0,r.defer=!0,r.dataset.qz="1",r.onload=()=>e(),r.onerror=()=>t(Error("Failed to load /vendor/qz-tray.js")),document.head.appendChild(r)})}async function l(){if(a)return;await o();let e=c();if(!e)throw Error("QZ Tray library not available. Is QZ Tray running?");e.api.setPromiseType(e=>new Promise(e)),e.websocket.isActive()||await e.websocket.connect(),a=!0}async function s(e){let t=c();a||await l();let r=t.configs.create(e,{encoding:"binary",rasterize:!1});return window.__qz_cfg=r,r}async function w(e){let t=c();a||await l();let r=window.__qz_cfg||t.configs.create(null,{encoding:"binary",rasterize:!1}),n=Array.from(e);return t.print(r,[{type:"raw",format:"command",data:n}])}async function d(){let e=c();a||await l();try{return await e.printers.getDefault()}catch(e){return null}}function p(){return{openPrintPreview:async e=>{let t="pr-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8));localStorage.setItem("print:".concat(t),JSON.stringify(e));let r="print-preview-".concat(t),i=window.location.origin,a=i.includes("localhost")&&!i.includes("tauri.localhost")?"".concat(i,"/print/receipt?id=").concat(t):i.startsWith("http")?"".concat(i,"/print/receipt.html?id=").concat(t):"app://-/print/receipt.html?id=".concat(t),c=new n.wp(r,{title:"Print Preview",url:a,width:420,height:800,resizable:!0,center:!0,visible:!0});return c.once("tauri://created",()=>console.log("Print preview window created:",r)),c.once("tauri://error",e=>{console.error("Failed to create print preview window:",e),alert("Failed to open print preview window. Check Tauri capabilities.")}),c.once("tauri://destroyed",()=>(function(e){try{localStorage.removeItem("print:".concat(e))}catch(e){}})(t)),c},printDirect:async(e,t,r)=>{await (0,i.lA)("print_receipt_direct",{receiptData:e,itemCount:t,printerName:null!=r?r:null})},printViaQZ:async(e,t)=>{await l();let r=t||await d()||"";await s(r);let n=new TextEncoder().encode(e);await w(n)}}}}}]);