{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\r\n        ghost:\r\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\r\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\r\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\r\n        icon: \"size-9\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/stores/userStore.ts"],"sourcesContent":["// Token caching to reduce localStorage access\r\nlet tokenCache: string | null = null;\r\nlet userCache: any | null = null;\r\nlet cacheTimestamp = 0;\r\nconst CACHE_TTL = 5000; // 5 seconds\r\n\r\nexport function setAccessToken(token: string | null) {\r\n  try {\r\n    tokenCache = token;\r\n    cacheTimestamp = Date.now();\r\n    if (token) localStorage.setItem('accessToken', token);\r\n    else localStorage.removeItem('accessToken');\r\n  } catch (e) {}\r\n}\r\n\r\nexport function getAccessToken(): string | null {\r\n  try {\r\n    // Use cache if valid\r\n    const now = Date.now();\r\n    if (tokenCache !== null && (now - cacheTimestamp) < CACHE_TTL) {\r\n      return tokenCache;\r\n    }\r\n    \r\n    // Refresh cache\r\n    tokenCache = localStorage.getItem('accessToken');\r\n    cacheTimestamp = now;\r\n    return tokenCache;\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function setUser(obj: any | null) {\r\n  try {\r\n    userCache = obj;\r\n    cacheTimestamp = Date.now();\r\n    if (obj) localStorage.setItem('user', JSON.stringify(obj));\r\n    else localStorage.removeItem('user');\r\n  } catch (e) {}\r\n}\r\n\r\nexport function getUser(): any | null {\r\n  try {\r\n    // Use cache if valid\r\n    const now = Date.now();\r\n    if (userCache !== null && (now - cacheTimestamp) < CACHE_TTL) {\r\n      return userCache;\r\n    }\r\n    \r\n    // Refresh cache\r\n    const v = localStorage.getItem('user');\r\n    userCache = v ? JSON.parse(v) : null;\r\n    cacheTimestamp = now;\r\n    return userCache;\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function clearAuth() {\r\n  try {\r\n    tokenCache = null;\r\n    userCache = null;\r\n    cacheTimestamp = 0;\r\n    localStorage.removeItem('accessToken');\r\n    localStorage.removeItem('user');\r\n  } catch (e) {}\r\n}\r\n\r\n// Force cache refresh\r\nexport function invalidateCache() {\r\n  tokenCache = null;\r\n  userCache = null;\r\n  cacheTimestamp = 0;\r\n}"],"names":[],"mappings":"AAAA,8CAA8C;;;;;;;;;;;;;;;AAC9C,IAAI,aAA4B;AAChC,IAAI,YAAwB;AAC5B,IAAI,iBAAiB;AACrB,MAAM,YAAY,MAAM,YAAY;AAE7B,SAAS,eAAe,KAAoB;IACjD,IAAI;QACF,aAAa;QACb,iBAAiB,KAAK,GAAG;QACzB,IAAI,OAAO,aAAa,OAAO,CAAC,eAAe;aAC1C,aAAa,UAAU,CAAC;IAC/B,EAAE,OAAO,GAAG,CAAC;AACf;AAEO,SAAS;IACd,IAAI;QACF,qBAAqB;QACrB,MAAM,MAAM,KAAK,GAAG;QACpB,IAAI,eAAe,QAAQ,AAAC,MAAM,iBAAkB,WAAW;YAC7D,OAAO;QACT;QAEA,gBAAgB;QAChB,aAAa,aAAa,OAAO,CAAC;QAClC,iBAAiB;QACjB,OAAO;IACT,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS,QAAQ,GAAe;IACrC,IAAI;QACF,YAAY;QACZ,iBAAiB,KAAK,GAAG;QACzB,IAAI,KAAK,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;aAChD,aAAa,UAAU,CAAC;IAC/B,EAAE,OAAO,GAAG,CAAC;AACf;AAEO,SAAS;IACd,IAAI;QACF,qBAAqB;QACrB,MAAM,MAAM,KAAK,GAAG;QACpB,IAAI,cAAc,QAAQ,AAAC,MAAM,iBAAkB,WAAW;YAC5D,OAAO;QACT;QAEA,gBAAgB;QAChB,MAAM,IAAI,aAAa,OAAO,CAAC;QAC/B,YAAY,IAAI,KAAK,KAAK,CAAC,KAAK;QAChC,iBAAiB;QACjB,OAAO;IACT,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,SAAS;IACd,IAAI;QACF,aAAa;QACb,YAAY;QACZ,iBAAiB;QACjB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC1B,EAAE,OAAO,GAAG,CAAC;AACf;AAGO,SAAS;IACd,aAAa;IACb,YAAY;IACZ,iBAAiB;AACnB","debugId":null}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/lib/axios.ts"],"sourcesContent":["import Axios, { AxiosRequestConfig, AxiosResponse, AxiosError, isAxiosError } from 'axios';\r\nimport { setAccessToken, getAccessToken, clearAuth } from '@/stores/userStore';\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://3.107.238.186:5000/api';\r\n\r\nconst axios = Axios.create({\r\n  baseURL: API_BASE,\r\n  withCredentials: true,\r\n  timeout: 15000,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Refresh token management\r\nlet isRefreshing = false;\r\nlet refreshPromise: Promise<string | null> | null = null;\r\n\r\n// Request interceptor - optimized\r\naxios.interceptors.request.use((config) => {\r\n  try {\r\n    const url = (config.url || '').toString();\r\n\r\n    // Skip auth for auth endpoints\r\n    if (url.includes('/auth/login') || url.includes('/auth/register')) {\r\n      return config;\r\n    }\r\n\r\n    const token = getAccessToken();\r\n    if (token && config.headers) {\r\n      config.headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n  } catch (e) {\r\n    console.warn('Token retrieval error:', e);\r\n  }\r\n  return config;\r\n});\r\n\r\n// Improved refresh token logic\r\nconst refreshAccessToken = async (): Promise<string | null> => {\r\n  try {\r\n    const response = await axios.post('/auth/refresh');\r\n    const newToken = response.data?.accessToken;\r\n\r\n    if (newToken) {\r\n      setAccessToken(newToken);\r\n      return newToken;\r\n    }\r\n    throw new Error('No access token received');\r\n  } catch (error) {\r\n    clearAuth();\r\n    // Redirect to login only on client side\r\n    if (typeof window !== 'undefined') {\r\n      window.location.href = '/login';\r\n    }\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Response interceptor with better error handling\r\naxios.interceptors.response.use(\r\n  (response: AxiosResponse) => response,\r\n  async (error: AxiosError & { config?: AxiosRequestConfig }) => {\r\n    const originalConfig = error.config;\r\n    if (!originalConfig) return Promise.reject(error);\r\n\r\n    // Handle 401 errors\r\n    if (isAxiosError(error) && error.response?.status === 401 && !originalConfig.url?.includes('/auth/')) {      // Prevent infinite refresh loops\r\n      // @ts-ignore\r\n      if (originalConfig._retry) {\r\n        clearAuth();\r\n        if (typeof window !== 'undefined') {\r\n          window.location.href = '/login';\r\n        }\r\n        return Promise.reject(error);\r\n      }\r\n\r\n      // @ts-ignore\r\n      originalConfig._retry = true;\r\n\r\n      // Use shared refresh promise to prevent multiple refresh requests\r\n      if (!isRefreshing) {\r\n        isRefreshing = true;\r\n        refreshPromise = refreshAccessToken().finally(() => {\r\n          isRefreshing = false;\r\n          refreshPromise = null;\r\n        });\r\n      }\r\n\r\n      try {\r\n        const newToken = await refreshPromise;\r\n        if (newToken && originalConfig.headers) {\r\n          originalConfig.headers['Authorization'] = `Bearer ${newToken}`;\r\n          return axios(originalConfig);\r\n        }\r\n      } catch (refreshError) {\r\n        return Promise.reject(refreshError);\r\n      }\r\n    }\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport { API_BASE };\r\nexport default axios;"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,WAAW,iEAAmC;AAEpD,MAAM,QAAQ,gJAAK,CAAC,MAAM,CAAC;IACzB,SAAS;IACT,iBAAiB;IACjB,SAAS;IACT,SAAS;QACP,gBAAgB;IAClB;AACF;AAEA,2BAA2B;AAC3B,IAAI,eAAe;AACnB,IAAI,iBAAgD;AAEpD,kCAAkC;AAClC,MAAM,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC9B,IAAI;QACF,MAAM,MAAM,CAAC,OAAO,GAAG,IAAI,EAAE,EAAE,QAAQ;QAEvC,+BAA+B;QAC/B,IAAI,IAAI,QAAQ,CAAC,kBAAkB,IAAI,QAAQ,CAAC,mBAAmB;YACjE,OAAO;QACT;QAEA,MAAM,QAAQ,IAAA,4IAAc;QAC5B,IAAI,SAAS,OAAO,OAAO,EAAE;YAC3B,OAAO,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;QACrD;IACF,EAAE,OAAO,GAAG;QACV,QAAQ,IAAI,CAAC,0BAA0B;IACzC;IACA,OAAO;AACT;AAEA,+BAA+B;AAC/B,MAAM,qBAAqB;IACzB,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,IAAI,CAAC;QAClC,MAAM,WAAW,SAAS,IAAI,EAAE;QAEhC,IAAI,UAAU;YACZ,IAAA,4IAAc,EAAC;YACf,OAAO;QACT;QACA,MAAM,IAAI,MAAM;IAClB,EAAE,OAAO,OAAO;QACd,IAAA,uIAAS;QACT,wCAAwC;QACxC;;QAGA,MAAM;IACR;AACF;AAEA,kDAAkD;AAClD,MAAM,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC7B,CAAC,WAA4B,UAC7B,OAAO;IACL,MAAM,iBAAiB,MAAM,MAAM;IACnC,IAAI,CAAC,gBAAgB,OAAO,QAAQ,MAAM,CAAC;IAE3C,oBAAoB;IACpB,IAAI,IAAA,8JAAY,EAAC,UAAU,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,eAAe,GAAG,EAAE,SAAS,WAAW;QACpG,aAAa;QACb,IAAI,eAAe,MAAM,EAAE;YACzB,IAAA,uIAAS;YACT;;YAGA,OAAO,QAAQ,MAAM,CAAC;QACxB;QAEA,aAAa;QACb,eAAe,MAAM,GAAG;QAExB,kEAAkE;QAClE,IAAI,CAAC,cAAc;YACjB,eAAe;YACf,iBAAiB,qBAAqB,OAAO,CAAC;gBAC5C,eAAe;gBACf,iBAAiB;YACnB;QACF;QAEA,IAAI;YACF,MAAM,WAAW,MAAM;YACvB,IAAI,YAAY,eAAe,OAAO,EAAE;gBACtC,eAAe,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,UAAU;gBAC9D,OAAO,MAAM;YACf;QACF,EAAE,OAAO,cAAc;YACrB,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB;;uCAIa","debugId":null}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/hooks/useAuthGuard.ts"],"sourcesContent":["'use client';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect, useRef } from 'react';\r\nimport axios from '@/lib/axios';\r\nimport { getAccessToken, getUser } from '@/stores/userStore';\r\n\r\nexport function useRedirectIfAuth(redirectTo = '/dashboard/main') {\r\n  const router = useRouter();\r\n  const hasChecked = useRef(false);\r\n\r\n  useEffect(() => {\r\n    // Prevent multiple checks\r\n    if (hasChecked.current) return;\r\n    hasChecked.current = true;\r\n\r\n    const checkAuth = async () => {\r\n      try {\r\n        // Quick validation first\r\n        const token = getAccessToken();\r\n        const user = getUser();\r\n\r\n        if (token && user) {\r\n          // Validate token structure and expiry\r\n          try {\r\n            const payload = JSON.parse(atob(token.split('.')[1]));\r\n            const isExpired = payload.exp * 1000 < Date.now() + 60000; // 1 min buffer\r\n            \r\n            if (!isExpired) {\r\n              router.replace(redirectTo);\r\n              return;\r\n            }\r\n          } catch (e) {\r\n            // Invalid token structure, try refresh\r\n          }\r\n        }\r\n\r\n        // Only attempt refresh if we have refresh cookie\r\n        const hasRefreshCookie = typeof window !== 'undefined' && \r\n          document.cookie.includes('refreshToken=');\r\n        \r\n        if (!hasRefreshCookie) return;\r\n\r\n        // Attempt refresh\r\n        const resp = await axios.post('/auth/refresh');\r\n        if (resp.data?.accessToken) {\r\n          router.replace(redirectTo);\r\n        }\r\n      } catch (err) {\r\n        // Clean up on failure\r\n        if (typeof window !== 'undefined') {\r\n          localStorage.removeItem('user');\r\n          localStorage.removeItem('accessToken');\r\n        }\r\n        console.debug('Auth check failed, cleaned up stale session');\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [redirectTo, router]);\r\n}\r\n\r\n// New hook for protecting routes\r\nexport function useRequireAuth(redirectTo = '/login') {\r\n  const router = useRouter();\r\n  const hasChecked = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (hasChecked.current) return;\r\n    hasChecked.current = true;\r\n\r\n    const checkAuth = async () => {\r\n      try {\r\n        const token = getAccessToken();\r\n        const user = getUser();\r\n\r\n        if (!token || !user) {\r\n          router.replace(redirectTo);\r\n          return;\r\n        }\r\n\r\n        // Validate token\r\n        try {\r\n          const payload = JSON.parse(atob(token.split('.')[1]));\r\n          const isExpired = payload.exp * 1000 < Date.now() + 60000;\r\n          \r\n          if (isExpired) {\r\n            // Try refresh\r\n            await axios.post('/auth/refresh');\r\n          }\r\n        } catch (e) {\r\n          router.replace(redirectTo);\r\n        }\r\n      } catch (err) {\r\n        router.replace(redirectTo);\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [redirectTo, router]);\r\n}"],"names":[],"mappings":";;;;;;AACA;AACA;AACA;AACA;AAJA;;;;;AAMO,SAAS,kBAAkB,aAAa,iBAAiB;IAC9D,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,aAAa,IAAA,+MAAM,EAAC;IAE1B,IAAA,kNAAS,EAAC;QACR,0BAA0B;QAC1B,IAAI,WAAW,OAAO,EAAE;QACxB,WAAW,OAAO,GAAG;QAErB,MAAM,YAAY;YAChB,IAAI;gBACF,yBAAyB;gBACzB,MAAM,QAAQ,IAAA,4IAAc;gBAC5B,MAAM,OAAO,IAAA,qIAAO;gBAEpB,IAAI,SAAS,MAAM;oBACjB,sCAAsC;oBACtC,IAAI;wBACF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;wBACnD,MAAM,YAAY,QAAQ,GAAG,GAAG,OAAO,KAAK,GAAG,KAAK,OAAO,eAAe;wBAE1E,IAAI,CAAC,WAAW;4BACd,OAAO,OAAO,CAAC;4BACf;wBACF;oBACF,EAAE,OAAO,GAAG;oBACV,uCAAuC;oBACzC;gBACF;gBAEA,iDAAiD;gBACjD,MAAM,mBAAmB,gBAAkB,eACzC,SAAS,MAAM,CAAC,QAAQ,CAAC;gBAE3B,wCAAuB;;;gBAEvB,kBAAkB;gBAClB,MAAM;YAIR,EAAE,OAAO,KAAK;gBACZ,sBAAsB;gBACtB;;gBAIA,QAAQ,KAAK,CAAC;YAChB;QACF;QAEA;IACF,GAAG;QAAC;QAAY;KAAO;AACzB;AAGO,SAAS,eAAe,aAAa,QAAQ;IAClD,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,aAAa,IAAA,+MAAM,EAAC;IAE1B,IAAA,kNAAS,EAAC;QACR,IAAI,WAAW,OAAO,EAAE;QACxB,WAAW,OAAO,GAAG;QAErB,MAAM,YAAY;YAChB,IAAI;gBACF,MAAM,QAAQ,IAAA,4IAAc;gBAC5B,MAAM,OAAO,IAAA,qIAAO;gBAEpB,IAAI,CAAC,SAAS,CAAC,MAAM;oBACnB,OAAO,OAAO,CAAC;oBACf;gBACF;gBAEA,iBAAiB;gBACjB,IAAI;oBACF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;oBACnD,MAAM,YAAY,QAAQ,GAAG,GAAG,OAAO,KAAK,GAAG,KAAK;oBAEpD,IAAI,WAAW;wBACb,cAAc;wBACd,MAAM,8HAAK,CAAC,IAAI,CAAC;oBACnB;gBACF,EAAE,OAAO,GAAG;oBACV,OAAO,OAAO,CAAC;gBACjB;YACF,EAAE,OAAO,KAAK;gBACZ,OAAO,OAAO,CAAC;YACjB;QACF;QAEA;IACF,GAAG;QAAC;QAAY;KAAO;AACzB","debugId":null}},
    {"offset": {"line": 454, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\r\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,mcACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Label }\r\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,yKAAmB;QAClB,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 506, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/hooks/users/user.ts"],"sourcesContent":["import axios from '@/lib/axios';\r\n\r\nexport interface LoginCredentials {\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\nexport interface RegisterData {\r\n  fullname: string;\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\nexport interface LoginResponse {\r\n  success: boolean;\r\n  accessToken: string;\r\n  data: {\r\n    id: number;\r\n    name: string;\r\n    username: string;\r\n    position_id?: number;\r\n  };\r\n}\r\n\r\nexport const loginUser = async (credentials: LoginCredentials): Promise<LoginResponse> => {\r\n  try {\r\n    const response = await axios.post('/auth/login', credentials);\r\n    const raw = response.data;\r\n\r\n    // Require backend to provide accessToken and data\r\n    if (!raw || !raw.accessToken || !raw.data) {\r\n      throw new Error(raw?.message || 'Invalid server response: missing accessToken or user data');\r\n    }\r\n\r\n    return {\r\n      success: raw.success ?? true,\r\n      accessToken: raw.accessToken, // require accessToken explicitly\r\n      data: raw.data,\r\n    };\r\n  } catch (error: any) {\r\n    throw new Error(error.response?.data?.message || error.message || 'Login failed');\r\n  }\r\n};\r\n\r\n\r\nexport const registerUser = async (data: RegisterData): Promise<void> => {\r\n  try {\r\n    await axios.post('/auth/register', {\r\n      name: data.fullname, // Map fullname to name for backend\r\n      username: data.username,\r\n      password: data.password\r\n    });\r\n  } catch (error: any) {\r\n    throw error; // Let component handle the error formatting\r\n  }\r\n};\r\n\r\nexport const logoutUser = async (): Promise<void> => {\r\n  try {\r\n    await axios.post('/auth/logout');\r\n  } catch (error) {\r\n    console.warn('Logout request failed, clearing local data anyway');\r\n  }\r\n};"],"names":[],"mappings":";;;;;;;;AAAA;;AAwBO,MAAM,YAAY,OAAO;IAC9B,IAAI;QACF,MAAM,WAAW,MAAM,8HAAK,CAAC,IAAI,CAAC,eAAe;QACjD,MAAM,MAAM,SAAS,IAAI;QAEzB,kDAAkD;QAClD,IAAI,CAAC,OAAO,CAAC,IAAI,WAAW,IAAI,CAAC,IAAI,IAAI,EAAE;YACzC,MAAM,IAAI,MAAM,KAAK,WAAW;QAClC;QAEA,OAAO;YACL,SAAS,IAAI,OAAO,IAAI;YACxB,aAAa,IAAI,WAAW;YAC5B,MAAM,IAAI,IAAI;QAChB;IACF,EAAE,OAAO,OAAY;QACnB,MAAM,IAAI,MAAM,MAAM,QAAQ,EAAE,MAAM,WAAW,MAAM,OAAO,IAAI;IACpE;AACF;AAGO,MAAM,eAAe,OAAO;IACjC,IAAI;QACF,MAAM,8HAAK,CAAC,IAAI,CAAC,kBAAkB;YACjC,MAAM,KAAK,QAAQ;YACnB,UAAU,KAAK,QAAQ;YACvB,UAAU,KAAK,QAAQ;QACzB;IACF,EAAE,OAAO,OAAY;QACnB,MAAM,OAAO,4CAA4C;IAC3D;AACF;AAEO,MAAM,aAAa;IACxB,IAAI;QACF,MAAM,8HAAK,CAAC,IAAI,CAAC;IACnB,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC;IACf;AACF","debugId":null}},
    {"offset": {"line": 555, "column": 0}, "map": {"version":3,"sources":["file:///D:/Code/POS/POS_Project/pos-frontend/src/app/%28authentication%29/login/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from \"next/link\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useId, useState, useCallback } from 'react';\r\nimport { EyeIcon, EyeOffIcon } from 'lucide-react';\r\nimport Image from \"next/image\";\r\nimport { UserIcon, KeyRound } from 'lucide-react';\r\nimport { useRedirectIfAuth } from '@/hooks/useAuthGuard';\r\n\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { useRouter } from 'next/navigation';\r\nimport { loginUser } from '@/hooks/users/user';\r\nimport { setAccessToken, setUser, invalidateCache } from '@/stores/userStore';\r\n\r\nexport default function LoginForm() {\r\n    useRedirectIfAuth();\r\n    const [isVisible, setIsVisible] = useState(false)\r\n    const id = useId()\r\n    const router = useRouter();\r\n\r\n    const [username, setUsername] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const togglePasswordVisibility = useCallback(() => {\r\n        setIsVisible(prev => !prev);\r\n    }, []);\r\n\r\n    const onSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(null);\r\n        \r\n        if (!username.trim() || !password.trim()) {\r\n            setError(\"Please enter both username and password\");\r\n            return;\r\n        }\r\n        \r\n        setLoading(true);\r\n        \r\n        try {\r\n            const res = await loginUser({ username: username.trim(), password });\r\n            \r\n            // Validate response structure\r\n            if (!res?.accessToken || !res?.data) {\r\n                throw new Error(\"Invalid server response\");\r\n            }\r\n\r\n            // Clear cache and set new data atomically\r\n            invalidateCache();\r\n            setAccessToken(res.accessToken);\r\n            setUser(res.data);\r\n\r\n            // Single navigation attempt\r\n            router.replace(\"/dashboard/main\");\r\n            \r\n        } catch (err: any) {\r\n            console.error('[login] Error:', err);\r\n            setError(err.message || \"Login failed. Please try again.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-white\">\r\n            <div className=\"w-full max-w-sm flex flex-col items-center gap-6 pb-[60px] px-2\">\r\n                <div className=\"flex flex-col items-center gap-2\">\r\n                    <Image src=\"/img/logo1.png\" alt=\"App logo\" width={150} height={150} priority />\r\n                    <p className=\"font-bold text-2xl\">Login</p>\r\n                </div>\r\n\r\n                <form className='w-full space-y-4' onSubmit={onSubmit} noValidate>\r\n                    {error && (\r\n                        <div className=\"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md\">\r\n                            {error}\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className='w-full'>\r\n                        <Label htmlFor={`${id}-username`} className='text-sm'>Username</Label>\r\n                        <div className='relative mt-1'>\r\n                            <div className='text-muted-foreground pointer-events-none absolute inset-y-0 left-0 flex items-center ps-3'>\r\n                                <UserIcon className='w-4 h-4' />\r\n                                <span className='sr-only'>User</span>\r\n                            </div>\r\n                            <Input \r\n                                id={`${id}-username`} \r\n                                type='text' \r\n                                placeholder='Username' \r\n                                className='peer ps-9' \r\n                                value={username} \r\n                                onChange={(e) => setUsername(e.target.value)}\r\n                                disabled={loading}\r\n                                autoComplete=\"username\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className='w-full'>\r\n                        <Label htmlFor={`${id}-password`} className='text-sm'>Password</Label>\r\n                        <div className='relative mt-1'>\r\n                            <div className='text-muted-foreground pointer-events-none absolute inset-y-0 left-0 flex items-center ps-3'>\r\n                                <KeyRound className='w-4 h-4' />\r\n                                <span className='sr-only'>Password</span>\r\n                            </div>\r\n                            <Input \r\n                                id={`${id}-password`} \r\n                                type={isVisible ? 'text' : 'password'} \r\n                                placeholder='Password' \r\n                                className='peer ps-9' \r\n                                value={password} \r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                disabled={loading}\r\n                                autoComplete=\"current-password\"\r\n                                required\r\n                            />\r\n                            <Button\r\n                                variant='ghost'\r\n                                size='icon'\r\n                                onClick={togglePasswordVisibility}\r\n                                className='text-muted-foreground absolute inset-y-0 right-0 rounded-s-none hover:bg-transparent'\r\n                                type='button'\r\n                                disabled={loading}\r\n                            >\r\n                                {isVisible ? <EyeIcon className='w-4 h-4' /> : <EyeOffIcon className='w-4 h-4' />}\r\n                                <span className='sr-only'>{isVisible ? 'Hide password' : 'Show password'}</span>\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Button \r\n                        className='w-full bg-black text-white rounded-md' \r\n                        type=\"submit\" \r\n                        disabled={loading}\r\n                    >\r\n                        {loading ? \"Signing in...\" : \"Login\"}\r\n                    </Button>\r\n                </form>\r\n\r\n                <div className=\"text-center text-sm mt-2\">\r\n                    Don&apos;t have an account?{\" \"}\r\n                    <Link href=\"/register\" className=\"underline underline-offset-4\">\r\n                        Sign up\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}