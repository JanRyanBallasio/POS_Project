{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/POS_Project/pos-frontend/src/hooks/printing/usePrint.ts"],"sourcesContent":["import { WebviewWindow } from '@tauri-apps/api/webviewWindow';\r\nimport { invoke } from '@tauri-apps/api/core';\r\n\r\ntype PrintData = {\r\n  store?: { name?: string; address1?: string; address2?: string };\r\n  customer?: { name?: string | null };\r\n  cartTotal: number;\r\n  amount: number;\r\n  change: number;\r\n  points?: number;\r\n  items: Array<{ desc: string; qty: number; price?: number; amount: number }>;\r\n};\r\n\r\nfunction genId() {\r\n  return `pr-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\r\n}\r\n\r\nfunction persistPrintPayload(id: string, data: PrintData) {\r\n  localStorage.setItem(`print:${id}`, JSON.stringify(data));\r\n}\r\n\r\nfunction removePrintPayload(id: string) {\r\n  try { localStorage.removeItem(`print:${id}`); } catch {}\r\n}\r\n\r\nexport function usePrint() {\r\n  const openPrintPreview = async (data: PrintData) => {\r\n    const id = genId();\r\n    persistPrintPayload(id, data);\r\n\r\n    const label = `print-preview-${id}`;\r\n    const win = new WebviewWindow(label, {\r\n      title: 'Print Preview',\r\n      url: `/print/receipt?id=${id}`,\r\n      width: 420,\r\n      height: 800,\r\n      resizable: true,\r\n      center: true,\r\n      visible: true,\r\n    });\r\n\r\n    win.once('tauri://destroyed', () => removePrintPayload(id));\r\n    return win;\r\n  };\r\n\r\n  // IMPORTANT: send snake_case keys to match Rust command parameters\r\n  const printDirect = async (escposData: string, itemCount: number, printerName?: string) => {\r\n    await invoke('print_receipt_direct', {\r\n      receipt_data: escposData,\r\n      item_count: itemCount,\r\n      printer_name: printerName ?? null,\r\n    });\r\n  };\r\n\r\n  return { openPrintPreview, printDirect };\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAYA,SAAS;IACP,OAAO,CAAC,GAAG,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,IAAI;AACrE;AAEA,SAAS,oBAAoB,EAAU,EAAE,IAAe;IACtD,aAAa,OAAO,CAAC,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,SAAS,CAAC;AACrD;AAEA,SAAS,mBAAmB,EAAU;IACpC,IAAI;QAAE,aAAa,UAAU,CAAC,CAAC,MAAM,EAAE,IAAI;IAAG,EAAE,OAAM,CAAC;AACzD;AAEO,SAAS;IACd,MAAM,mBAAmB,OAAO;QAC9B,MAAM,KAAK;QACX,oBAAoB,IAAI;QAExB,MAAM,QAAQ,CAAC,cAAc,EAAE,IAAI;QACnC,MAAM,MAAM,IAAI,wKAAa,CAAC,OAAO;YACnC,OAAO;YACP,KAAK,CAAC,kBAAkB,EAAE,IAAI;YAC9B,OAAO;YACP,QAAQ;YACR,WAAW;YACX,QAAQ;YACR,SAAS;QACX;QAEA,IAAI,IAAI,CAAC,qBAAqB,IAAM,mBAAmB;QACvD,OAAO;IACT;IAEA,mEAAmE;IACnE,MAAM,cAAc,OAAO,YAAoB,WAAmB;QAChE,MAAM,IAAA,wJAAM,EAAC,wBAAwB;YACnC,cAAc;YACd,YAAY;YACZ,cAAc,eAAe;QAC/B;IACF;IAEA,OAAO;QAAE;QAAkB;IAAY;AACzC","debugId":null}}]
}